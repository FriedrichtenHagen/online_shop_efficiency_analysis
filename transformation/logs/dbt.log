[0m14:43:42.803097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d2ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff8500>]}


============================== 14:43:42.806002 | d27f1286-6a42-4a77-b164-a3545159db92 ==============================
[0m14:43:42.806002 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:43:42.806328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt init online_shop_dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:43:42.816207 [debug] [MainThread]: Starter project path: /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/include/starter_project
[0m14:43:42.820014 [info ] [MainThread]: 
Your new dbt project "online_shop_dbt" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m14:43:42.820286 [info ] [MainThread]: Setting up your profile.
[0m14:50:19.478955 [info ] [MainThread]: Profile online_shop_dbt written to /Users/friedrichtenhagen/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m14:50:19.520237 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 396.74704, "process_in_blocks": "0", "process_kernel_time": 0.241003, "process_mem_max_rss": "188743680", "process_out_blocks": "0", "process_user_time": 1.02924}
[0m14:50:19.521255 [debug] [MainThread]: Command `dbt init` succeeded at 14:50:19.521050 after 396.75 seconds
[0m14:50:19.522588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fca6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e28650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b95b20>]}
[0m14:50:19.523283 [debug] [MainThread]: Flushing usage events
[0m14:50:20.023794 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:51:20.552078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189f8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189f8560>]}


============================== 14:51:20.555341 | 3690ad5b-56a3-4734-bc6f-697806faac4c ==============================
[0m14:51:20.555341 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:51:20.555666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:20.565693 [info ] [MainThread]: dbt version: 1.9.1
[0m14:51:20.566198 [info ] [MainThread]: python version: 3.12.7
[0m14:51:20.566459 [info ] [MainThread]: python path: /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/bin/python3.12
[0m14:51:20.566630 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m14:51:21.331665 [info ] [MainThread]: Using profiles dir at /Users/friedrichtenhagen/.dbt
[0m14:51:21.331939 [info ] [MainThread]: Using profiles.yml file at /Users/friedrichtenhagen/.dbt/profiles.yml
[0m14:51:21.332093 [info ] [MainThread]: Using dbt_project.yml file at /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/dbt_project.yml
[0m14:51:21.332235 [info ] [MainThread]: adapter type: bigquery
[0m14:51:21.332364 [info ] [MainThread]: adapter version: 1.9.1
[0m14:51:21.332502 [info ] [MainThread]: Configuration:
[0m14:51:21.332617 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:51:21.332736 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:51:21.332851 [info ] [MainThread]: Required dependencies:
[0m14:51:21.333035 [debug] [MainThread]: Executing "git --help"
[0m14:51:21.352602 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:51:21.353120 [debug] [MainThread]: STDERR: "b''"
[0m14:51:21.353292 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:51:21.353549 [info ] [MainThread]: Connection:
[0m14:51:21.353770 [info ] [MainThread]:   method: service-account
[0m14:51:21.353920 [info ] [MainThread]:   database: opensource-marketing-dwh
[0m14:51:21.354049 [info ] [MainThread]:   execution_project: opensource-marketing-dwh
[0m14:51:21.354168 [info ] [MainThread]:   schema: dbt_transformations
[0m14:51:21.354284 [info ] [MainThread]:   location: EU
[0m14:51:21.354403 [info ] [MainThread]:   priority: interactive
[0m14:51:21.354519 [info ] [MainThread]:   maximum_bytes_billed: None
[0m14:51:21.354634 [info ] [MainThread]:   impersonate_service_account: None
[0m14:51:21.354750 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m14:51:21.354860 [info ] [MainThread]:   job_retries: 1
[0m14:51:21.354972 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m14:51:21.355088 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m14:51:21.355199 [info ] [MainThread]:   timeout_seconds: 300
[0m14:51:21.355310 [info ] [MainThread]:   client_id: None
[0m14:51:21.355421 [info ] [MainThread]:   token_uri: None
[0m14:51:21.355533 [info ] [MainThread]:   dataproc_region: None
[0m14:51:21.355642 [info ] [MainThread]:   dataproc_cluster_name: None
[0m14:51:21.355757 [info ] [MainThread]:   gcs_bucket: None
[0m14:51:21.355868 [info ] [MainThread]:   dataproc_batch: None
[0m14:51:21.356218 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:51:21.439856 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m14:51:21.440235 [debug] [MainThread]: On debug: select 1 as id
[0m14:51:21.440426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:21.440657 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/opensource-marketing-dwh-e19cb8481149.json''
[0m14:51:21.440829 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
select 1 as id
[0m14:51:21.440962 [debug] [MainThread]: BigQuery adapter: Database Error
  [Errno 2] No such file or directory: '/opensource-marketing-dwh-e19cb8481149.json'
[0m14:51:21.441112 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:51:21.441312 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:51:21.441439 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/dbt_project.yml> not found

[0m14:51:21.441570 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >'NoneType' object has no attribute 'close'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:51:21.443308 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.93625313, "process_in_blocks": "0", "process_kernel_time": 0.242485, "process_mem_max_rss": "193904640", "process_out_blocks": "0", "process_user_time": 1.107191}
[0m14:51:21.443524 [debug] [MainThread]: Command `dbt debug` failed at 14:51:21.443472 after 0.94 seconds
[0m14:51:21.443749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189f87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb9ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff50f80>]}
[0m14:51:21.444152 [debug] [MainThread]: Flushing usage events
[0m14:51:21.917831 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:57:45.615022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c37530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f8620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f8380>]}


============================== 14:57:45.617987 | 18e7d8fd-092a-4f7d-bc11-47def5313ec9 ==============================
[0m14:57:45.617987 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:57:45.618339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:57:45.627347 [info ] [MainThread]: dbt version: 1.9.1
[0m14:57:45.627604 [info ] [MainThread]: python version: 3.12.7
[0m14:57:45.627745 [info ] [MainThread]: python path: /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/bin/python3.12
[0m14:57:45.627873 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m14:57:46.187272 [info ] [MainThread]: Using profiles dir at /Users/friedrichtenhagen/.dbt
[0m14:57:46.187531 [info ] [MainThread]: Using profiles.yml file at /Users/friedrichtenhagen/.dbt/profiles.yml
[0m14:57:46.187701 [info ] [MainThread]: Using dbt_project.yml file at /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/dbt_project.yml
[0m14:57:46.187840 [info ] [MainThread]: adapter type: bigquery
[0m14:57:46.187967 [info ] [MainThread]: adapter version: 1.9.1
[0m14:57:46.242824 [info ] [MainThread]: Configuration:
[0m14:57:46.243087 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:57:46.243235 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:57:46.243368 [info ] [MainThread]: Required dependencies:
[0m14:57:46.243554 [debug] [MainThread]: Executing "git --help"
[0m14:57:46.266582 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:57:46.267150 [debug] [MainThread]: STDERR: "b''"
[0m14:57:46.267314 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:57:46.267496 [info ] [MainThread]: Connection:
[0m14:57:46.267675 [info ] [MainThread]:   method: service-account
[0m14:57:46.267809 [info ] [MainThread]:   database: opensource-marketing-dwh
[0m14:57:46.267949 [info ] [MainThread]:   execution_project: opensource-marketing-dwh
[0m14:57:46.268065 [info ] [MainThread]:   schema: dbt_transformations
[0m14:57:46.268179 [info ] [MainThread]:   location: EU
[0m14:57:46.268290 [info ] [MainThread]:   priority: interactive
[0m14:57:46.268405 [info ] [MainThread]:   maximum_bytes_billed: None
[0m14:57:46.268518 [info ] [MainThread]:   impersonate_service_account: None
[0m14:57:46.268631 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m14:57:46.268738 [info ] [MainThread]:   job_retries: 1
[0m14:57:46.268848 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m14:57:46.268961 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m14:57:46.269068 [info ] [MainThread]:   timeout_seconds: 300
[0m14:57:46.269179 [info ] [MainThread]:   client_id: None
[0m14:57:46.269288 [info ] [MainThread]:   token_uri: None
[0m14:57:46.269397 [info ] [MainThread]:   dataproc_region: None
[0m14:57:46.269506 [info ] [MainThread]:   dataproc_cluster_name: None
[0m14:57:46.269614 [info ] [MainThread]:   gcs_bucket: None
[0m14:57:46.269721 [info ] [MainThread]:   dataproc_batch: None
[0m14:57:46.270065 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:57:46.354106 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m14:57:46.354449 [debug] [MainThread]: On debug: select 1 as id
[0m14:57:46.354626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:46.354899 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: '/opensource-marketing-dwh-e19cb8481149.json''
[0m14:57:46.355133 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
select 1 as id
[0m14:57:46.355282 [debug] [MainThread]: BigQuery adapter: Database Error
  [Errno 2] No such file or directory: '/opensource-marketing-dwh-e19cb8481149.json'
[0m14:57:46.355446 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:57:46.355609 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:57:46.355735 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >'NoneType' object has no attribute 'close'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:57:46.357545 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.78443825, "process_in_blocks": "0", "process_kernel_time": 0.200687, "process_mem_max_rss": "197623808", "process_out_blocks": "0", "process_user_time": 1.145329}
[0m14:57:46.357765 [debug] [MainThread]: Command `dbt debug` failed at 14:57:46.357717 after 0.78 seconds
[0m14:57:46.357988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119850d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106489bb0>]}
[0m14:57:46.358188 [debug] [MainThread]: Flushing usage events
[0m14:57:46.839542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:57.709567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035d1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd4560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10432c560>]}


============================== 14:58:57.712507 | f192e121-4b0f-444e-9088-bca8ac22d8c5 ==============================
[0m14:58:57.712507 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:58:57.712842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:58:57.721726 [info ] [MainThread]: dbt version: 1.9.1
[0m14:58:57.721955 [info ] [MainThread]: python version: 3.12.7
[0m14:58:57.722100 [info ] [MainThread]: python path: /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/bin/python3.12
[0m14:58:57.722240 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m14:58:58.286159 [info ] [MainThread]: Using profiles dir at /Users/friedrichtenhagen/.dbt
[0m14:58:58.286433 [info ] [MainThread]: Using profiles.yml file at /Users/friedrichtenhagen/.dbt/profiles.yml
[0m14:58:58.286586 [info ] [MainThread]: Using dbt_project.yml file at /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/dbt_project.yml
[0m14:58:58.286725 [info ] [MainThread]: adapter type: bigquery
[0m14:58:58.286934 [info ] [MainThread]: adapter version: 1.9.1
[0m14:58:58.342710 [info ] [MainThread]: Configuration:
[0m14:58:58.342968 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:58:58.343117 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:58:58.343251 [info ] [MainThread]: Required dependencies:
[0m14:58:58.343445 [debug] [MainThread]: Executing "git --help"
[0m14:58:58.360670 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:58:58.361214 [debug] [MainThread]: STDERR: "b''"
[0m14:58:58.361392 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:58:58.361570 [info ] [MainThread]: Connection:
[0m14:58:58.361757 [info ] [MainThread]:   method: service-account
[0m14:58:58.361937 [info ] [MainThread]:   database: opensource-marketing-dwh
[0m14:58:58.362133 [info ] [MainThread]:   execution_project: opensource-marketing-dwh
[0m14:58:58.362275 [info ] [MainThread]:   schema: dbt_transformations
[0m14:58:58.362408 [info ] [MainThread]:   location: EU
[0m14:58:58.362529 [info ] [MainThread]:   priority: interactive
[0m14:58:58.362658 [info ] [MainThread]:   maximum_bytes_billed: None
[0m14:58:58.362779 [info ] [MainThread]:   impersonate_service_account: None
[0m14:58:58.362899 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m14:58:58.363013 [info ] [MainThread]:   job_retries: 1
[0m14:58:58.363129 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m14:58:58.363248 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m14:58:58.363358 [info ] [MainThread]:   timeout_seconds: 300
[0m14:58:58.363472 [info ] [MainThread]:   client_id: None
[0m14:58:58.363582 [info ] [MainThread]:   token_uri: None
[0m14:58:58.363694 [info ] [MainThread]:   dataproc_region: None
[0m14:58:58.363805 [info ] [MainThread]:   dataproc_cluster_name: None
[0m14:58:58.363916 [info ] [MainThread]:   gcs_bucket: None
[0m14:58:58.364025 [info ] [MainThread]:   dataproc_batch: None
[0m14:58:58.364375 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:58:58.448361 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m14:58:58.448846 [debug] [MainThread]: On debug: select 1 as id
[0m14:58:58.449038 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:59:02.053817 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:EU:2389ac62-8bfa-43f1-9080-7e018a97073a&page=queryresults
[0m14:59:02.477582 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:59:02.478895 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:59:02.484803 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.8149805, "process_in_blocks": "0", "process_kernel_time": 0.228339, "process_mem_max_rss": "203194368", "process_out_blocks": "0", "process_user_time": 1.222451}
[0m14:59:02.485554 [debug] [MainThread]: Command `dbt debug` succeeded at 14:59:02.485411 after 4.82 seconds
[0m14:59:02.485969 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:59:02.486415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c35d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124052f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236fa3f0>]}
[0m14:59:02.486791 [debug] [MainThread]: Flushing usage events
[0m14:59:02.946853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:58.862608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10430ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104820aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104820800>]}


============================== 15:00:58.865598 | 42c35f23-088a-47ec-a52e-831b5fac49f9 ==============================
[0m15:00:58.865598 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:00:58.865919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'version_check': 'True', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:00:59.495748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42c35f23-088a-47ec-a52e-831b5fac49f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109726870>]}
[0m15:00:59.530292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42c35f23-088a-47ec-a52e-831b5fac49f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040cb980>]}
[0m15:00:59.530627 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:00:59.620698 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:00:59.658237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:00:59.658464 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:00:59.658800 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.online_shop_dbt.example
[0m15:00:59.661505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42c35f23-088a-47ec-a52e-831b5fac49f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a982720>]}
[0m15:00:59.683816 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:00:59.685600 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:00:59.696229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42c35f23-088a-47ec-a52e-831b5fac49f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa22c90>]}
[0m15:00:59.696494 [info ] [MainThread]: Found 489 macros
[0m15:00:59.696659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c35f23-088a-47ec-a52e-831b5fac49f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa3a7e0>]}
[0m15:00:59.697425 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:00:59.698344 [debug] [MainThread]: Command end result
[0m15:00:59.752003 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:00:59.752793 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:00:59.754307 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m15:00:59.756296 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9360833, "process_in_blocks": "0", "process_kernel_time": 0.231247, "process_mem_max_rss": "205111296", "process_out_blocks": "0", "process_user_time": 1.286425}
[0m15:00:59.756558 [debug] [MainThread]: Command `dbt run` succeeded at 15:00:59.756506 after 0.94 seconds
[0m15:00:59.756758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acbc3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c62120>]}
[0m15:00:59.756930 [debug] [MainThread]: Flushing usage events
[0m15:01:00.250891 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:02:31.344579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ee3aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cf8aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cf8800>]}


============================== 15:02:31.347582 | df4ead47-54ff-485e-8217-0ff1114a8003 ==============================
[0m15:02:31.347582 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:02:31.347902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:02:32.004095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df4ead47-54ff-485e-8217-0ff1114a8003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12353c9e0>]}
[0m15:02:32.038167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df4ead47-54ff-485e-8217-0ff1114a8003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f57800>]}
[0m15:02:32.038501 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:02:32.125951 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:02:32.183949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:02:32.184174 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:02:32.201540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df4ead47-54ff-485e-8217-0ff1114a8003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c72270>]}
[0m15:02:32.234757 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:02:32.236476 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:02:32.252030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df4ead47-54ff-485e-8217-0ff1114a8003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1278ed460>]}
[0m15:02:32.252322 [info ] [MainThread]: Found 2 models, 4 data tests, 489 macros
[0m15:02:32.252494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df4ead47-54ff-485e-8217-0ff1114a8003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1278f83e0>]}
[0m15:02:32.253466 [info ] [MainThread]: 
[0m15:02:32.253656 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:02:32.253789 [info ] [MainThread]: 
[0m15:02:32.254039 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:02:32.255949 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m15:02:32.256153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:32.619118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now create_opensource-marketing-dwh_dbt_transformations)
[0m15:02:32.621744 [debug] [ThreadPool]: Creating schema "database: "opensource-marketing-dwh"
schema: "dbt_transformations"
"
[0m15:02:32.634467 [debug] [ThreadPool]: On create_opensource-marketing-dwh_dbt_transformations: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "connection_name": "create_opensource-marketing-dwh_dbt_transformations"} */
create schema if not exists `opensource-marketing-dwh`.`dbt_transformations`
  
[0m15:02:32.634989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:33.099005 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:EU:dda93cd0-f467-4115-8b74-6f28637cb09a&page=queryresults
[0m15:02:36.070700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_opensource-marketing-dwh_dbt_transformations, now list_opensource-marketing-dwh_dbt_transformations)
[0m15:02:36.070958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:36.425332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df4ead47-54ff-485e-8217-0ff1114a8003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f44e60>]}
[0m15:02:36.427028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:02:36.431311 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_first_dbt_model
[0m15:02:36.432008 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_transformations.my_first_dbt_model ............ [RUN]
[0m15:02:36.432452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations, now model.online_shop_dbt.my_first_dbt_model)
[0m15:02:36.432789 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_first_dbt_model
[0m15:02:36.440987 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_first_dbt_model"
[0m15:02:36.442247 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_first_dbt_model
[0m15:02:36.475513 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_first_dbt_model"
[0m15:02:36.476612 [debug] [Thread-1 (]: On model.online_shop_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_first_dbt_model"} */

  
    

    create or replace table `opensource-marketing-dwh`.`dbt_transformations`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m15:02:36.476960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:36.994763 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:EU:ec59e181-fd78-484f-804e-3f135e9c0d1e&page=queryresults
[0m15:02:39.442321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df4ead47-54ff-485e-8217-0ff1114a8003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123555f70>]}
[0m15:02:39.443110 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_transformations.my_first_dbt_model ....... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.01s]
[0m15:02:39.443692 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_first_dbt_model
[0m15:02:39.444323 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_second_dbt_model
[0m15:02:39.444912 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt_transformations.my_second_dbt_model ............ [RUN]
[0m15:02:39.445364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_first_dbt_model, now model.online_shop_dbt.my_second_dbt_model)
[0m15:02:39.445697 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_second_dbt_model
[0m15:02:39.448756 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_second_dbt_model"
[0m15:02:39.449608 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_second_dbt_model
[0m15:02:39.469448 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_second_dbt_model"
[0m15:02:39.470215 [debug] [Thread-1 (]: On model.online_shop_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_second_dbt_model"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `opensource-marketing-dwh`.`dbt_transformations`.`my_first_dbt_model`
where id = 1;


[0m15:02:39.470587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:40.064645 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:EU:7c0957e2-5a5c-4e50-9fb8-966672f98f61&page=queryresults
[0m15:02:40.353628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df4ead47-54ff-485e-8217-0ff1114a8003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127ca7b30>]}
[0m15:02:40.354485 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt_transformations.my_second_dbt_model ....... [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m15:02:40.355080 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_second_dbt_model
[0m15:02:40.356119 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:02:40.357845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:40.358161 [debug] [MainThread]: Connection 'model.online_shop_dbt.my_second_dbt_model' was properly closed.
[0m15:02:40.358462 [info ] [MainThread]: 
[0m15:02:40.358750 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 8.10 seconds (8.10s).
[0m15:02:40.359522 [debug] [MainThread]: Command end result
[0m15:02:40.382776 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:02:40.384337 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:02:40.389542 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m15:02:40.389822 [info ] [MainThread]: 
[0m15:02:40.390146 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:40.390379 [info ] [MainThread]: 
[0m15:02:40.390621 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:02:40.393379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.088999, "process_in_blocks": "0", "process_kernel_time": 0.262994, "process_mem_max_rss": "209633280", "process_out_blocks": "0", "process_user_time": 1.80944}
[0m15:02:40.393781 [debug] [MainThread]: Command `dbt run` succeeded at 15:02:40.393699 after 9.09 seconds
[0m15:02:40.394094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cf8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cf8aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116dee6c0>]}
[0m15:02:40.394420 [debug] [MainThread]: Flushing usage events
[0m15:02:40.870471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:51.003672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4f8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4f8440>]}


============================== 15:09:51.006735 | 8f7cf9fc-5e09-451a-a08b-0f8eded2745f ==============================
[0m15:09:51.006735 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:09:51.007065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:09:51.016188 [info ] [MainThread]: dbt version: 1.9.1
[0m15:09:51.016516 [info ] [MainThread]: python version: 3.12.7
[0m15:09:51.016688 [info ] [MainThread]: python path: /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/bin/python3.12
[0m15:09:51.016830 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m15:09:51.572879 [info ] [MainThread]: Using profiles dir at /Users/friedrichtenhagen/.dbt
[0m15:09:51.573147 [info ] [MainThread]: Using profiles.yml file at /Users/friedrichtenhagen/.dbt/profiles.yml
[0m15:09:51.573299 [info ] [MainThread]: Using dbt_project.yml file at /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/dbt_project.yml
[0m15:09:51.573434 [info ] [MainThread]: adapter type: bigquery
[0m15:09:51.573565 [info ] [MainThread]: adapter version: 1.9.1
[0m15:09:51.628751 [info ] [MainThread]: Configuration:
[0m15:09:51.629018 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:09:51.629167 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:09:51.629299 [info ] [MainThread]: Required dependencies:
[0m15:09:51.629487 [debug] [MainThread]: Executing "git --help"
[0m15:09:51.647102 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:09:51.647685 [debug] [MainThread]: STDERR: "b''"
[0m15:09:51.647863 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:09:51.648054 [info ] [MainThread]: Connection:
[0m15:09:51.648241 [info ] [MainThread]:   method: service-account
[0m15:09:51.648370 [info ] [MainThread]:   database: opensource-marketing-dwh
[0m15:09:51.648493 [info ] [MainThread]:   execution_project: opensource-marketing-dwh
[0m15:09:51.648608 [info ] [MainThread]:   schema: dbt_transformations
[0m15:09:51.648726 [info ] [MainThread]:   location: EU
[0m15:09:51.648843 [info ] [MainThread]:   priority: interactive
[0m15:09:51.648961 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:09:51.649072 [info ] [MainThread]:   impersonate_service_account: None
[0m15:09:51.649188 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:09:51.649299 [info ] [MainThread]:   job_retries: 1
[0m15:09:51.649411 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:09:51.649525 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:09:51.649637 [info ] [MainThread]:   timeout_seconds: 300
[0m15:09:51.649750 [info ] [MainThread]:   client_id: None
[0m15:09:51.649858 [info ] [MainThread]:   token_uri: None
[0m15:09:51.649970 [info ] [MainThread]:   dataproc_region: None
[0m15:09:51.650081 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:09:51.650190 [info ] [MainThread]:   gcs_bucket: None
[0m15:09:51.650297 [info ] [MainThread]:   dataproc_batch: None
[0m15:09:51.650637 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:09:51.730607 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:09:51.731202 [debug] [MainThread]: On debug: select 1 as id
[0m15:09:51.731382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:52.233030 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:EU:c0d68a70-c1df-46a1-8475-24bba8f552d8&page=queryresults
[0m15:09:52.644793 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:09:52.646259 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:09:52.651079 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.6895028, "process_in_blocks": "0", "process_kernel_time": 0.235796, "process_mem_max_rss": "202686464", "process_out_blocks": "0", "process_user_time": 1.226294}
[0m15:09:52.651651 [debug] [MainThread]: Command `dbt debug` succeeded at 15:09:52.651538 after 1.69 seconds
[0m15:09:52.652011 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:09:52.652383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1c9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073572f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d351850>]}
[0m15:09:52.652801 [debug] [MainThread]: Flushing usage events
[0m15:09:53.130091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:56.746334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a4770>]}


============================== 15:09:56.748580 | 5ea2ae30-a842-44f4-bdaf-6b5a7c215266 ==============================
[0m15:09:56.748580 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:09:56.748924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:09:57.338274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ea2ae30-a842-44f4-bdaf-6b5a7c215266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9ef1a0>]}
[0m15:09:57.373409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ea2ae30-a842-44f4-bdaf-6b5a7c215266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b88bfb0>]}
[0m15:09:57.373787 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:09:57.459731 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:09:57.518152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:57.518382 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:57.535850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ea2ae30-a842-44f4-bdaf-6b5a7c215266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbbe420>]}
[0m15:09:57.569362 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:09:57.571327 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:09:57.582559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ea2ae30-a842-44f4-bdaf-6b5a7c215266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd24f50>]}
[0m15:09:57.582841 [info ] [MainThread]: Found 2 models, 4 data tests, 489 macros
[0m15:09:57.583012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea2ae30-a842-44f4-bdaf-6b5a7c215266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106803110>]}
[0m15:09:57.583954 [info ] [MainThread]: 
[0m15:09:57.584133 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:09:57.584270 [info ] [MainThread]: 
[0m15:09:57.584522 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:09:57.586383 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m15:09:57.586612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:57.956021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now list_opensource-marketing-dwh_dbt_transformations)
[0m15:09:57.957249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:58.289855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea2ae30-a842-44f4-bdaf-6b5a7c215266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce2a9f0>]}
[0m15:09:58.291110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:58.294585 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_first_dbt_model
[0m15:09:58.295253 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_transformations.my_first_dbt_model ............ [RUN]
[0m15:09:58.295720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations, now model.online_shop_dbt.my_first_dbt_model)
[0m15:09:58.296074 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_first_dbt_model
[0m15:09:58.306833 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_first_dbt_model"
[0m15:09:58.307734 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_first_dbt_model
[0m15:09:58.374135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:58.725583 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_first_dbt_model"
[0m15:09:58.726629 [debug] [Thread-1 (]: On model.online_shop_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_first_dbt_model"} */

  
    

    create or replace table `opensource-marketing-dwh`.`dbt_transformations`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m15:09:59.060262 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:EU:18f518d1-3a03-4a3f-9866-73fb98eb5f9a&page=queryresults
[0m15:10:01.336803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea2ae30-a842-44f4-bdaf-6b5a7c215266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de07a0>]}
[0m15:10:01.337554 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_transformations.my_first_dbt_model ....... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.04s]
[0m15:10:01.338183 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_first_dbt_model
[0m15:10:01.338572 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_second_dbt_model
[0m15:10:01.339099 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt_transformations.my_second_dbt_model ............ [RUN]
[0m15:10:01.339587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_first_dbt_model, now model.online_shop_dbt.my_second_dbt_model)
[0m15:10:01.339954 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_second_dbt_model
[0m15:10:01.342196 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_second_dbt_model"
[0m15:10:01.342838 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_second_dbt_model
[0m15:10:01.362643 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_second_dbt_model"
[0m15:10:01.363406 [debug] [Thread-1 (]: On model.online_shop_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_second_dbt_model"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `opensource-marketing-dwh.facebook_ads_dimensions.ads`;


[0m15:10:01.363729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:01.824636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:EU:703c9b9b-b062-4ae8-a1d8-6343494b00c9&page=queryresults
[0m15:10:01.826195 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:EU:703c9b9b-b062-4ae8-a1d8-6343494b00c9&page=queryresults
[0m15:10:01.837734 [debug] [Thread-1 (]: Database Error in model my_second_dbt_model (online_shop_dbt/models/example/my_second_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:facebook_ads_dimensions was not found in location EU
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_second_dbt_model.sql
[0m15:10:01.838750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea2ae30-a842-44f4-bdaf-6b5a7c215266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d21dc10>]}
[0m15:10:01.839856 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model dbt_transformations.my_second_dbt_model ... [[31mERROR[0m in 0.50s]
[0m15:10:01.840795 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_second_dbt_model
[0m15:10:01.841355 [debug] [Thread-4 (]: Marking all children of 'model.online_shop_dbt.my_second_dbt_model' to be skipped because of status 'error'.  Reason: Database Error in model my_second_dbt_model (online_shop_dbt/models/example/my_second_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:facebook_ads_dimensions was not found in location EU
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_second_dbt_model.sql.
[0m15:10:01.843035 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:01.844817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:01.845128 [debug] [MainThread]: Connection 'model.online_shop_dbt.my_second_dbt_model' was properly closed.
[0m15:10:01.845430 [info ] [MainThread]: 
[0m15:10:01.845733 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m15:10:01.846478 [debug] [MainThread]: Command end result
[0m15:10:01.870047 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:10:01.871555 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:10:01.876494 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m15:10:01.876779 [info ] [MainThread]: 
[0m15:10:01.877061 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:10:01.877288 [info ] [MainThread]: 
[0m15:10:01.877558 [error] [MainThread]:   Database Error in model my_second_dbt_model (online_shop_dbt/models/example/my_second_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:facebook_ads_dimensions was not found in location EU
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_second_dbt_model.sql
[0m15:10:01.877773 [info ] [MainThread]: 
[0m15:10:01.877990 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:10:01.880138 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.170774, "process_in_blocks": "0", "process_kernel_time": 0.24405, "process_mem_max_rss": "211943424", "process_out_blocks": "0", "process_user_time": 1.746517}
[0m15:10:01.880450 [debug] [MainThread]: Command `dbt run` failed at 15:10:01.880384 after 5.17 seconds
[0m15:10:01.880725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d12bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de18e0>]}
[0m15:10:01.880987 [debug] [MainThread]: Flushing usage events
[0m15:10:02.323480 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:31.837498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104967e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c4740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c4470>]}


============================== 15:14:31.840744 | abb08859-aeeb-46a0-b5ff-616e9965008c ==============================
[0m15:14:31.840744 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:14:31.841086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:14:31.852485 [info ] [MainThread]: dbt version: 1.9.1
[0m15:14:31.852797 [info ] [MainThread]: python version: 3.12.7
[0m15:14:31.852982 [info ] [MainThread]: python path: /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/bin/python3.12
[0m15:14:31.853194 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m15:14:32.457557 [info ] [MainThread]: Using profiles dir at /Users/friedrichtenhagen/.dbt
[0m15:14:32.457821 [info ] [MainThread]: Using profiles.yml file at /Users/friedrichtenhagen/.dbt/profiles.yml
[0m15:14:32.457974 [info ] [MainThread]: Using dbt_project.yml file at /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/dbt_project.yml
[0m15:14:32.458127 [info ] [MainThread]: adapter type: bigquery
[0m15:14:32.458252 [info ] [MainThread]: adapter version: 1.9.1
[0m15:14:32.513970 [info ] [MainThread]: Configuration:
[0m15:14:32.514232 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:14:32.514384 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:14:32.514521 [info ] [MainThread]: Required dependencies:
[0m15:14:32.514717 [debug] [MainThread]: Executing "git --help"
[0m15:14:32.530279 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:14:32.530876 [debug] [MainThread]: STDERR: "b''"
[0m15:14:32.531065 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:14:32.531233 [info ] [MainThread]: Connection:
[0m15:14:32.531414 [info ] [MainThread]:   method: service-account
[0m15:14:32.531538 [info ] [MainThread]:   database: opensource-marketing-dwh
[0m15:14:32.531658 [info ] [MainThread]:   execution_project: opensource-marketing-dwh
[0m15:14:32.531776 [info ] [MainThread]:   schema: dbt_transformations
[0m15:14:32.531892 [info ] [MainThread]:   location: europe-west1
[0m15:14:32.532007 [info ] [MainThread]:   priority: interactive
[0m15:14:32.532123 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:14:32.532235 [info ] [MainThread]:   impersonate_service_account: None
[0m15:14:32.532347 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:14:32.532459 [info ] [MainThread]:   job_retries: 1
[0m15:14:32.532569 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:14:32.532683 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:14:32.532795 [info ] [MainThread]:   timeout_seconds: 300
[0m15:14:32.532909 [info ] [MainThread]:   client_id: None
[0m15:14:32.533028 [info ] [MainThread]:   token_uri: None
[0m15:14:32.533135 [info ] [MainThread]:   dataproc_region: None
[0m15:14:32.533247 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:14:32.533367 [info ] [MainThread]:   gcs_bucket: None
[0m15:14:32.533474 [info ] [MainThread]:   dataproc_batch: None
[0m15:14:32.533817 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:14:32.619445 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:14:32.619800 [debug] [MainThread]: On debug: select 1 as id
[0m15:14:32.619979 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:35.398212 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:99bf1260-00b4-410f-9aa2-ad8a9f5f4083&page=queryresults
[0m15:14:35.769901 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:14:35.770995 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:14:35.776103 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.9804854, "process_in_blocks": "0", "process_kernel_time": 0.248344, "process_mem_max_rss": "204767232", "process_out_blocks": "0", "process_user_time": 1.225615}
[0m15:14:35.776657 [debug] [MainThread]: Command `dbt debug` succeeded at 15:14:35.776543 after 3.98 seconds
[0m15:14:35.777024 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:14:35.777443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aada660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104864e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a43c200>]}
[0m15:14:35.778090 [debug] [MainThread]: Flushing usage events
[0m15:14:36.232393 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:40.277539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104254c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483c860>]}


============================== 15:14:40.280342 | ff12daf7-a4ae-45d4-b3e7-f383ce8c6fd5 ==============================
[0m15:14:40.280342 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:14:40.280671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:14:40.916355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff12daf7-a4ae-45d4-b3e7-f383ce8c6fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5d1610>]}
[0m15:14:40.951477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff12daf7-a4ae-45d4-b3e7-f383ce8c6fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a289f10>]}
[0m15:14:40.951843 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:14:41.039905 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:14:41.098704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:14:41.098926 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:14:41.116451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff12daf7-a4ae-45d4-b3e7-f383ce8c6fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa18950>]}
[0m15:14:41.149389 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:14:41.151329 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:14:41.162725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff12daf7-a4ae-45d4-b3e7-f383ce8c6fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adb5580>]}
[0m15:14:41.162995 [info ] [MainThread]: Found 2 models, 4 data tests, 489 macros
[0m15:14:41.163170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff12daf7-a4ae-45d4-b3e7-f383ce8c6fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa5a300>]}
[0m15:14:41.164074 [info ] [MainThread]: 
[0m15:14:41.164250 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:41.164389 [info ] [MainThread]: 
[0m15:14:41.164630 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:14:41.166450 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m15:14:41.166655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:41.512969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now list_opensource-marketing-dwh_dbt_transformations)
[0m15:14:41.514228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:41.857652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff12daf7-a4ae-45d4-b3e7-f383ce8c6fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034c8710>]}
[0m15:14:41.859001 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:41.862705 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_first_dbt_model
[0m15:14:41.863356 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_transformations.my_first_dbt_model ............ [RUN]
[0m15:14:41.863804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations, now model.online_shop_dbt.my_first_dbt_model)
[0m15:14:41.864153 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_first_dbt_model
[0m15:14:41.874946 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_first_dbt_model"
[0m15:14:41.875826 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_first_dbt_model
[0m15:14:41.941785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:42.276308 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_first_dbt_model"
[0m15:14:42.277354 [debug] [Thread-1 (]: On model.online_shop_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_first_dbt_model"} */

  
    

    create or replace table `opensource-marketing-dwh`.`dbt_transformations`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m15:14:42.426533 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:6713b983-3f26-4297-a183-0a771a0b5fe9&page=queryresults
[0m15:14:42.427992 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:6713b983-3f26-4297-a183-0a771a0b5fe9&page=queryresults
[0m15:14:42.438512 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (online_shop_dbt/models/example/my_first_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_first_dbt_model.sql
[0m15:14:42.440505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff12daf7-a4ae-45d4-b3e7-f383ce8c6fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad8cf20>]}
[0m15:14:42.441194 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt_transformations.my_first_dbt_model ... [[31mERROR[0m in 0.58s]
[0m15:14:42.441766 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_first_dbt_model
[0m15:14:42.442284 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_second_dbt_model
[0m15:14:42.442835 [debug] [Thread-4 (]: Marking all children of 'model.online_shop_dbt.my_first_dbt_model' to be skipped because of status 'error'.  Reason: Database Error in model my_first_dbt_model (online_shop_dbt/models/example/my_first_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_first_dbt_model.sql.
[0m15:14:42.443359 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt_transformations.my_second_dbt_model ............ [RUN]
[0m15:14:42.444848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_first_dbt_model, now model.online_shop_dbt.my_second_dbt_model)
[0m15:14:42.445551 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_second_dbt_model
[0m15:14:42.447974 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_second_dbt_model"
[0m15:14:42.448704 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_second_dbt_model
[0m15:14:42.468790 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_second_dbt_model"
[0m15:14:42.469622 [debug] [Thread-1 (]: On model.online_shop_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_second_dbt_model"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `opensource-marketing-dwh.facebook_ads_dimensions.ads`;


[0m15:14:42.469991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:42.793827 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:d001e3a6-3a95-4493-9162-745e83842b30&page=queryresults
[0m15:14:42.795493 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:d001e3a6-3a95-4493-9162-745e83842b30&page=queryresults
[0m15:14:42.801855 [debug] [Thread-1 (]: Database Error in model my_second_dbt_model (online_shop_dbt/models/example/my_second_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_second_dbt_model.sql
[0m15:14:42.802586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff12daf7-a4ae-45d4-b3e7-f383ce8c6fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a88baa0>]}
[0m15:14:42.803340 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model dbt_transformations.my_second_dbt_model ... [[31mERROR[0m in 0.36s]
[0m15:14:42.803923 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_second_dbt_model
[0m15:14:42.804380 [debug] [Thread-4 (]: Marking all children of 'model.online_shop_dbt.my_second_dbt_model' to be skipped because of status 'error'.  Reason: Database Error in model my_second_dbt_model (online_shop_dbt/models/example/my_second_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_second_dbt_model.sql.
[0m15:14:42.805507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:42.807387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:42.807724 [debug] [MainThread]: Connection 'model.online_shop_dbt.my_second_dbt_model' was properly closed.
[0m15:14:42.808053 [info ] [MainThread]: 
[0m15:14:42.808594 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m15:14:42.810160 [debug] [MainThread]: Command end result
[0m15:14:42.834200 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:14:42.835581 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:14:42.841110 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m15:14:42.841531 [info ] [MainThread]: 
[0m15:14:42.841891 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:14:42.842165 [info ] [MainThread]: 
[0m15:14:42.842480 [error] [MainThread]:   Database Error in model my_first_dbt_model (online_shop_dbt/models/example/my_first_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_first_dbt_model.sql
[0m15:14:42.842733 [info ] [MainThread]: 
[0m15:14:42.843017 [error] [MainThread]:   Database Error in model my_second_dbt_model (online_shop_dbt/models/example/my_second_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_second_dbt_model.sql
[0m15:14:42.843252 [info ] [MainThread]: 
[0m15:14:42.843487 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m15:14:42.845751 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.608121, "process_in_blocks": "0", "process_kernel_time": 0.227354, "process_mem_max_rss": "206946304", "process_out_blocks": "0", "process_user_time": 1.70418}
[0m15:14:42.846100 [debug] [MainThread]: Command `dbt run` failed at 15:14:42.846033 after 2.61 seconds
[0m15:14:42.846386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483c980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad6ff80>]}
[0m15:14:42.846658 [debug] [MainThread]: Flushing usage events
[0m15:14:43.291268 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:15:22.769969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c5bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf4c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf4950>]}


============================== 15:15:22.773212 | 7d47e6f6-1c51-4e96-8b8c-3693eee3cfc5 ==============================
[0m15:15:22.773212 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:15:22.773544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:15:23.451164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d47e6f6-1c51-4e96-8b8c-3693eee3cfc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12adca5a0>]}
[0m15:15:23.485473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d47e6f6-1c51-4e96-8b8c-3693eee3cfc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041d72c0>]}
[0m15:15:23.485835 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:15:23.572951 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:15:23.631438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:15:23.631668 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:15:23.649003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d47e6f6-1c51-4e96-8b8c-3693eee3cfc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12af1f7d0>]}
[0m15:15:23.682326 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:15:23.684248 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:15:23.695886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d47e6f6-1c51-4e96-8b8c-3693eee3cfc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ec08ec0>]}
[0m15:15:23.696151 [info ] [MainThread]: Found 2 models, 4 data tests, 489 macros
[0m15:15:23.696322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d47e6f6-1c51-4e96-8b8c-3693eee3cfc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12effddc0>]}
[0m15:15:23.697247 [info ] [MainThread]: 
[0m15:15:23.697444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:15:23.697582 [info ] [MainThread]: 
[0m15:15:23.697834 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:15:23.699661 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m15:15:23.699843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:24.047965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now list_opensource-marketing-dwh_dbt_transformations)
[0m15:15:24.048568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:24.404064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d47e6f6-1c51-4e96-8b8c-3693eee3cfc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12efddeb0>]}
[0m15:15:24.405285 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:15:24.408821 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_first_dbt_model
[0m15:15:24.409482 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_transformations.my_first_dbt_model ............ [RUN]
[0m15:15:24.409920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations, now model.online_shop_dbt.my_first_dbt_model)
[0m15:15:24.410257 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_first_dbt_model
[0m15:15:24.420006 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_first_dbt_model"
[0m15:15:24.421445 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_first_dbt_model
[0m15:15:24.486412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:24.847482 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_first_dbt_model"
[0m15:15:24.848830 [debug] [Thread-1 (]: On model.online_shop_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_first_dbt_model"} */

  
    

    create or replace table `opensource-marketing-dwh`.`dbt_transformations`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m15:15:25.002683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:cb7101bd-0abb-446d-84e4-7378c84668fa&page=queryresults
[0m15:15:25.004091 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:cb7101bd-0abb-446d-84e4-7378c84668fa&page=queryresults
[0m15:15:25.015207 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (online_shop_dbt/models/example/my_first_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_first_dbt_model.sql
[0m15:15:25.017388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d47e6f6-1c51-4e96-8b8c-3693eee3cfc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104534ce0>]}
[0m15:15:25.018120 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt_transformations.my_first_dbt_model ... [[31mERROR[0m in 0.61s]
[0m15:15:25.019225 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_first_dbt_model
[0m15:15:25.019692 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_second_dbt_model
[0m15:15:25.020228 [debug] [Thread-4 (]: Marking all children of 'model.online_shop_dbt.my_first_dbt_model' to be skipped because of status 'error'.  Reason: Database Error in model my_first_dbt_model (online_shop_dbt/models/example/my_first_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_first_dbt_model.sql.
[0m15:15:25.020816 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt_transformations.my_second_dbt_model ............ [RUN]
[0m15:15:25.022276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_first_dbt_model, now model.online_shop_dbt.my_second_dbt_model)
[0m15:15:25.022686 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_second_dbt_model
[0m15:15:25.025017 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_second_dbt_model"
[0m15:15:25.026160 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_second_dbt_model
[0m15:15:25.046224 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_second_dbt_model"
[0m15:15:25.047064 [debug] [Thread-1 (]: On model.online_shop_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_second_dbt_model"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `facebook_ads_dimensions.ads`;


[0m15:15:25.047438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:25.347215 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:3dd17631-f7d3-48f8-ac58-57dc9000f869&page=queryresults
[0m15:15:25.348806 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:3dd17631-f7d3-48f8-ac58-57dc9000f869&page=queryresults
[0m15:15:25.354121 [debug] [Thread-1 (]: Database Error in model my_second_dbt_model (online_shop_dbt/models/example/my_second_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_second_dbt_model.sql
[0m15:15:25.354774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d47e6f6-1c51-4e96-8b8c-3693eee3cfc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ae38b30>]}
[0m15:15:25.355437 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model dbt_transformations.my_second_dbt_model ... [[31mERROR[0m in 0.33s]
[0m15:15:25.356066 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_second_dbt_model
[0m15:15:25.356570 [debug] [Thread-4 (]: Marking all children of 'model.online_shop_dbt.my_second_dbt_model' to be skipped because of status 'error'.  Reason: Database Error in model my_second_dbt_model (online_shop_dbt/models/example/my_second_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_second_dbt_model.sql.
[0m15:15:25.357420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:25.358836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:25.359158 [debug] [MainThread]: Connection 'model.online_shop_dbt.my_second_dbt_model' was properly closed.
[0m15:15:25.359461 [info ] [MainThread]: 
[0m15:15:25.359755 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m15:15:25.360482 [debug] [MainThread]: Command end result
[0m15:15:25.383014 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:15:25.384713 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:15:25.389878 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m15:15:25.390164 [info ] [MainThread]: 
[0m15:15:25.390552 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:15:25.390966 [info ] [MainThread]: 
[0m15:15:25.391418 [error] [MainThread]:   Database Error in model my_first_dbt_model (online_shop_dbt/models/example/my_first_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_first_dbt_model.sql
[0m15:15:25.391748 [info ] [MainThread]: 
[0m15:15:25.392155 [error] [MainThread]:   Database Error in model my_second_dbt_model (online_shop_dbt/models/example/my_second_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_second_dbt_model.sql
[0m15:15:25.392427 [info ] [MainThread]: 
[0m15:15:25.392688 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m15:15:25.395408 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6647112, "process_in_blocks": "0", "process_kernel_time": 0.240253, "process_mem_max_rss": "206536704", "process_out_blocks": "0", "process_user_time": 1.688085}
[0m15:15:25.395747 [debug] [MainThread]: Command `dbt run` failed at 15:15:25.395680 after 2.67 seconds
[0m15:15:25.396017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf4aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf4a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf4b00>]}
[0m15:15:25.396289 [debug] [MainThread]: Flushing usage events
[0m15:15:25.839254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:21.510741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f69760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108edc920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910c8f0>]}


============================== 15:23:21.514568 | a9e2fa1a-4b9d-44d5-b6ed-6abf6f91ae84 ==============================
[0m15:23:21.514568 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:23:21.517577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:23:22.184365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9e2fa1a-4b9d-44d5-b6ed-6abf6f91ae84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edfc800>]}
[0m15:23:22.220123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9e2fa1a-4b9d-44d5-b6ed-6abf6f91ae84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0d19a0>]}
[0m15:23:22.220474 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:23:22.308285 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:23:22.360855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:22.361085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:22.378589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9e2fa1a-4b9d-44d5-b6ed-6abf6f91ae84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2b7800>]}
[0m15:23:22.411602 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:23:22.414599 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:23:22.426786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9e2fa1a-4b9d-44d5-b6ed-6abf6f91ae84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4911f0>]}
[0m15:23:22.427051 [info ] [MainThread]: Found 3 models, 4 data tests, 489 macros
[0m15:23:22.427227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9e2fa1a-4b9d-44d5-b6ed-6abf6f91ae84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4daa20>]}
[0m15:23:22.428186 [info ] [MainThread]: 
[0m15:23:22.428364 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:22.428504 [info ] [MainThread]: 
[0m15:23:22.428757 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:23:22.430640 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m15:23:22.430850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:22.788334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now list_opensource-marketing-dwh_dbt_transformations)
[0m15:23:22.789514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:23.142497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9e2fa1a-4b9d-44d5-b6ed-6abf6f91ae84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b0320>]}
[0m15:23:23.143504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:23.147508 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_first_dbt_model
[0m15:23:23.148243 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_transformations.my_first_dbt_model ............ [RUN]
[0m15:23:23.148705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations, now model.online_shop_dbt.my_first_dbt_model)
[0m15:23:23.149063 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_first_dbt_model
[0m15:23:23.217592 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_first_dbt_model"
[0m15:23:23.219581 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_first_dbt_model
[0m15:23:23.228250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:23.577564 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_first_dbt_model"
[0m15:23:23.579745 [debug] [Thread-1 (]: On model.online_shop_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_first_dbt_model"} */

  
    

    create or replace table `opensource-marketing-dwh`.`dbt_transformations`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m15:23:23.751543 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:a5d4c5f5-c6d6-4328-9a2c-13a067e9c5a5&page=queryresults
[0m15:23:23.753144 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:a5d4c5f5-c6d6-4328-9a2c-13a067e9c5a5&page=queryresults
[0m15:23:23.764092 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (online_shop_dbt/models/example/my_first_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_first_dbt_model.sql
[0m15:23:23.766695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9e2fa1a-4b9d-44d5-b6ed-6abf6f91ae84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f336420>]}
[0m15:23:23.767525 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dbt_transformations.my_first_dbt_model ... [[31mERROR[0m in 0.62s]
[0m15:23:23.768132 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_first_dbt_model
[0m15:23:23.768538 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_second_dbt_model
[0m15:23:23.769035 [debug] [Thread-4 (]: Marking all children of 'model.online_shop_dbt.my_first_dbt_model' to be skipped because of status 'error'.  Reason: Database Error in model my_first_dbt_model (online_shop_dbt/models/example/my_first_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_first_dbt_model.sql.
[0m15:23:23.769550 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_transformations.my_second_dbt_model ............ [RUN]
[0m15:23:23.770630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_first_dbt_model, now model.online_shop_dbt.my_second_dbt_model)
[0m15:23:23.770900 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_second_dbt_model
[0m15:23:23.772644 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_second_dbt_model"
[0m15:23:23.773517 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_second_dbt_model
[0m15:23:23.793649 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_second_dbt_model"
[0m15:23:23.794455 [debug] [Thread-1 (]: On model.online_shop_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_second_dbt_model"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `facebook_ads_dimensions.ads`;


[0m15:23:23.794822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:24.106980 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:534941ab-e3cb-4ee4-93ca-15a139cac906&page=queryresults
[0m15:23:24.108567 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:534941ab-e3cb-4ee4-93ca-15a139cac906&page=queryresults
[0m15:23:24.114586 [debug] [Thread-1 (]: Database Error in model my_second_dbt_model (online_shop_dbt/models/example/my_second_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_second_dbt_model.sql
[0m15:23:24.115369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9e2fa1a-4b9d-44d5-b6ed-6abf6f91ae84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f76d670>]}
[0m15:23:24.116030 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model dbt_transformations.my_second_dbt_model ... [[31mERROR[0m in 0.34s]
[0m15:23:24.116603 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_second_dbt_model
[0m15:23:24.116995 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.testing
[0m15:23:24.117455 [debug] [Thread-4 (]: Marking all children of 'model.online_shop_dbt.my_second_dbt_model' to be skipped because of status 'error'.  Reason: Database Error in model my_second_dbt_model (online_shop_dbt/models/example/my_second_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_second_dbt_model.sql.
[0m15:23:24.117955 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_transformations.testing ........................ [RUN]
[0m15:23:24.118590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_second_dbt_model, now model.online_shop_dbt.testing)
[0m15:23:24.118955 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.testing
[0m15:23:24.121394 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.testing"
[0m15:23:24.122443 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.testing
[0m15:23:24.124710 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.testing"
[0m15:23:24.125290 [debug] [Thread-1 (]: On model.online_shop_dbt.testing: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.testing"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations`.`testing`
  OPTIONS()
  as SELECT 1 AS test_id;


[0m15:23:24.125564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:24.465077 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:f2f47df7-bc9e-4fab-86bf-0e6409576fb9&page=queryresults
[0m15:23:24.466376 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:f2f47df7-bc9e-4fab-86bf-0e6409576fb9&page=queryresults
[0m15:23:24.472659 [debug] [Thread-1 (]: Database Error in model testing (online_shop_dbt/models/example/testing.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/testing.sql
[0m15:23:24.473412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9e2fa1a-4b9d-44d5-b6ed-6abf6f91ae84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f794e00>]}
[0m15:23:24.474142 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model dbt_transformations.testing ............... [[31mERROR[0m in 0.35s]
[0m15:23:24.474739 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.testing
[0m15:23:24.475201 [debug] [Thread-4 (]: Marking all children of 'model.online_shop_dbt.testing' to be skipped because of status 'error'.  Reason: Database Error in model testing (online_shop_dbt/models/example/testing.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/testing.sql.
[0m15:23:24.476403 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:24.478264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:24.478604 [debug] [MainThread]: Connection 'model.online_shop_dbt.testing' was properly closed.
[0m15:23:24.478953 [info ] [MainThread]: 
[0m15:23:24.479258 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m15:23:24.480886 [debug] [MainThread]: Command end result
[0m15:23:24.505106 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:23:24.506592 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:23:24.511636 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m15:23:24.511987 [info ] [MainThread]: 
[0m15:23:24.512685 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:23:24.513016 [info ] [MainThread]: 
[0m15:23:24.513350 [error] [MainThread]:   Database Error in model my_first_dbt_model (online_shop_dbt/models/example/my_first_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_first_dbt_model.sql
[0m15:23:24.513606 [info ] [MainThread]: 
[0m15:23:24.513887 [error] [MainThread]:   Database Error in model my_second_dbt_model (online_shop_dbt/models/example/my_second_dbt_model.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/my_second_dbt_model.sql
[0m15:23:24.514117 [info ] [MainThread]: 
[0m15:23:24.514364 [error] [MainThread]:   Database Error in model testing (online_shop_dbt/models/example/testing.sql)
  Not found: Dataset opensource-marketing-dwh:dbt_transformations was not found in location europe-west1
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/example/testing.sql
[0m15:23:24.514560 [info ] [MainThread]: 
[0m15:23:24.514779 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m15:23:24.517279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0485942, "process_in_blocks": "0", "process_kernel_time": 0.253898, "process_mem_max_rss": "206733312", "process_out_blocks": "0", "process_user_time": 1.77686}
[0m15:23:24.517620 [debug] [MainThread]: Command `dbt run` failed at 15:23:24.517551 after 3.05 seconds
[0m15:23:24.517911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eafd2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10854f5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a508f0>]}
[0m15:23:24.518186 [debug] [MainThread]: Flushing usage events
[0m15:23:24.980712 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:37.841216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122057c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221f8a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221f87d0>]}


============================== 15:24:37.844511 | 015f3cbc-7122-4cfe-8932-8c8b64479012 ==============================
[0m15:24:37.844511 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:24:37.844840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:24:38.523434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '015f3cbc-7122-4cfe-8932-8c8b64479012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13aeb7320>]}
[0m15:24:38.557891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '015f3cbc-7122-4cfe-8932-8c8b64479012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13adc7770>]}
[0m15:24:38.558230 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:24:38.648379 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:24:38.708841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:24:38.709079 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:24:38.726624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '015f3cbc-7122-4cfe-8932-8c8b64479012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b0927e0>]}
[0m15:24:38.760036 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:24:38.762109 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:24:38.773947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '015f3cbc-7122-4cfe-8932-8c8b64479012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b2f4c20>]}
[0m15:24:38.774201 [info ] [MainThread]: Found 3 models, 4 data tests, 489 macros
[0m15:24:38.774374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '015f3cbc-7122-4cfe-8932-8c8b64479012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b0794c0>]}
[0m15:24:38.775290 [info ] [MainThread]: 
[0m15:24:38.775464 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:24:38.775602 [info ] [MainThread]: 
[0m15:24:38.775864 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:24:38.777724 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m15:24:38.777936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:39.127285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now create_opensource-marketing-dwh_dbt_transformations)
[0m15:24:39.128006 [debug] [ThreadPool]: Creating schema "database: "opensource-marketing-dwh"
schema: "dbt_transformations"
"
[0m15:24:39.197099 [debug] [ThreadPool]: On create_opensource-marketing-dwh_dbt_transformations: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "connection_name": "create_opensource-marketing-dwh_dbt_transformations"} */
create schema if not exists `opensource-marketing-dwh`.`dbt_transformations`
  
[0m15:24:39.197404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:39.531356 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:14123939-63e5-4f1b-afde-17cdd1d91e95&page=queryresults
[0m15:24:41.802279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_opensource-marketing-dwh_dbt_transformations, now list_opensource-marketing-dwh_dbt_transformations)
[0m15:24:41.802688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:42.133404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '015f3cbc-7122-4cfe-8932-8c8b64479012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b51a3f0>]}
[0m15:24:42.135090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:24:42.138924 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_first_dbt_model
[0m15:24:42.139589 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_transformations.my_first_dbt_model ............ [RUN]
[0m15:24:42.140048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations, now model.online_shop_dbt.my_first_dbt_model)
[0m15:24:42.140419 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_first_dbt_model
[0m15:24:42.149097 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_first_dbt_model"
[0m15:24:42.150657 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_first_dbt_model
[0m15:24:42.184321 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_first_dbt_model"
[0m15:24:42.185069 [debug] [Thread-1 (]: On model.online_shop_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_first_dbt_model"} */

  
    

    create or replace table `opensource-marketing-dwh`.`dbt_transformations`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m15:24:42.185418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:42.653301 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:97f27cb5-1fed-4ec8-9bfd-63c5cd90edf3&page=queryresults
[0m15:24:44.175405 [error] [Thread-1 (]: [31mUnhandled error while executing target/run/online_shop_dbt/online_shop_dbt/models/example/my_first_dbt_model.sql[0m
404 GET https://bigquery.googleapis.com/bigquery/v2/projects/opensource-marketing-dwh/datasets/dbt_transformations/tables/my_first_dbt_model?prettyPrint=false: Not found: Dataset opensource-marketing-dwh:dbt_transformations
[0m15:24:44.186460 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/task/run.py", line 332, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/task/run.py", line 292, in _execute_model
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 89, in macro
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 399, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/adapters/bigquery/connections.py", line 311, in execute
    query_table = client.get_table(query_job.destination)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 1164, in get_table
    api_response = self._call_api(
                   ^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 837, in _call_api
    return call()
           ^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/google/cloud/_http/__init__.py", line 494, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.NotFound: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/opensource-marketing-dwh/datasets/dbt_transformations/tables/my_first_dbt_model?prettyPrint=false: Not found: Dataset opensource-marketing-dwh:dbt_transformations

[0m15:24:44.189158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '015f3cbc-7122-4cfe-8932-8c8b64479012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b689b50>]}
[0m15:24:44.189912 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dbt_transformations.my_first_dbt_model ... [[31mERROR[0m in 2.05s]
[0m15:24:44.191022 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_first_dbt_model
[0m15:24:44.191566 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_second_dbt_model
[0m15:24:44.192022 [debug] [Thread-4 (]: Marking all children of 'model.online_shop_dbt.my_first_dbt_model' to be skipped because of status 'error'.  Reason: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/opensource-marketing-dwh/datasets/dbt_transformations/tables/my_first_dbt_model?prettyPrint=false: Not found: Dataset opensource-marketing-dwh:dbt_transformations.
[0m15:24:44.192560 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_transformations.my_second_dbt_model ............ [RUN]
[0m15:24:44.193934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_first_dbt_model, now model.online_shop_dbt.my_second_dbt_model)
[0m15:24:44.194847 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_second_dbt_model
[0m15:24:44.197269 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_second_dbt_model"
[0m15:24:44.198025 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_second_dbt_model
[0m15:24:44.219629 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_second_dbt_model"
[0m15:24:44.220441 [debug] [Thread-1 (]: On model.online_shop_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_second_dbt_model"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `facebook_ads_dimensions.ads`;


[0m15:24:44.220790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:44.745132 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:cb14efee-da05-4667-9ee9-6f609004727d&page=queryresults
[0m15:24:45.040988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '015f3cbc-7122-4cfe-8932-8c8b64479012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ad59a60>]}
[0m15:24:45.041550 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_transformations.my_second_dbt_model ....... [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m15:24:45.041987 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_second_dbt_model
[0m15:24:45.042274 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.testing
[0m15:24:45.042681 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_transformations.testing ........................ [RUN]
[0m15:24:45.043061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_second_dbt_model, now model.online_shop_dbt.testing)
[0m15:24:45.043339 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.testing
[0m15:24:45.044956 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.testing"
[0m15:24:45.045516 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.testing
[0m15:24:45.047607 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.testing"
[0m15:24:45.048192 [debug] [Thread-1 (]: On model.online_shop_dbt.testing: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.testing"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations`.`testing`
  OPTIONS()
  as SELECT 1 AS test_id;


[0m15:24:45.048497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:45.564615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:a8f85a20-8cab-4e95-9b20-97a12323c909&page=queryresults
[0m15:24:45.778639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '015f3cbc-7122-4cfe-8932-8c8b64479012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d323410>]}
[0m15:24:45.780036 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_transformations.testing ................... [[32mCREATE VIEW (0 processed)[0m in 0.74s]
[0m15:24:45.780956 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.testing
[0m15:24:45.782125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:24:45.783903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:45.784239 [debug] [MainThread]: Connection 'model.online_shop_dbt.testing' was properly closed.
[0m15:24:45.784745 [info ] [MainThread]: 
[0m15:24:45.785177 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 7.01 seconds (7.01s).
[0m15:24:45.786418 [debug] [MainThread]: Command end result
[0m15:24:45.812009 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:24:45.813643 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:24:45.819295 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m15:24:45.819643 [info ] [MainThread]: 
[0m15:24:45.819948 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:24:45.820198 [info ] [MainThread]: 
[0m15:24:45.820504 [error] [MainThread]:   404 GET https://bigquery.googleapis.com/bigquery/v2/projects/opensource-marketing-dwh/datasets/dbt_transformations/tables/my_first_dbt_model?prettyPrint=false: Not found: Dataset opensource-marketing-dwh:dbt_transformations
[0m15:24:45.820742 [info ] [MainThread]: 
[0m15:24:45.820984 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:24:45.823690 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.024133, "process_in_blocks": "0", "process_kernel_time": 0.282704, "process_mem_max_rss": "211337216", "process_out_blocks": "0", "process_user_time": 1.875559}
[0m15:24:45.824023 [debug] [MainThread]: Command `dbt run` failed at 15:24:45.823956 after 8.02 seconds
[0m15:24:45.824302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216c9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13adc5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13aedbc20>]}
[0m15:24:45.824564 [debug] [MainThread]: Flushing usage events
[0m15:24:46.293416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:22.215009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120570e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f8aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f87d0>]}


============================== 15:26:22.218195 | 397449bf-f608-40d7-8ac4-3590b423fdcc ==============================
[0m15:26:22.218195 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:26:22.218527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:26:22.924447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '397449bf-f608-40d7-8ac4-3590b423fdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144a809e0>]}
[0m15:26:22.958633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '397449bf-f608-40d7-8ac4-3590b423fdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c05f70>]}
[0m15:26:22.958981 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:26:23.049413 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:26:23.104043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:26:23.104269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:26:23.121946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '397449bf-f608-40d7-8ac4-3590b423fdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b22150>]}
[0m15:26:23.155757 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:26:23.157613 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:26:23.169215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '397449bf-f608-40d7-8ac4-3590b423fdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f016d0>]}
[0m15:26:23.169479 [info ] [MainThread]: Found 3 models, 4 data tests, 489 macros
[0m15:26:23.169652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '397449bf-f608-40d7-8ac4-3590b423fdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144efe3c0>]}
[0m15:26:23.170593 [info ] [MainThread]: 
[0m15:26:23.170776 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:26:23.170916 [info ] [MainThread]: 
[0m15:26:23.171164 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:26:23.173005 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m15:26:23.173208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:23.534876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now create_opensource-marketing-dwh_dbt_transformations_new)
[0m15:26:23.536399 [debug] [ThreadPool]: Creating schema "database: "opensource-marketing-dwh"
schema: "dbt_transformations_new"
"
[0m15:26:23.606812 [debug] [ThreadPool]: On create_opensource-marketing-dwh_dbt_transformations_new: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "connection_name": "create_opensource-marketing-dwh_dbt_transformations_new"} */
create schema if not exists `opensource-marketing-dwh`.`dbt_transformations_new`
  
[0m15:26:23.607152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:23.956772 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:8005f992-0f19-4326-b19a-3d589538d329&page=queryresults
[0m15:26:26.162848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_opensource-marketing-dwh_dbt_transformations_new, now list_opensource-marketing-dwh_dbt_transformations_new)
[0m15:26:26.163268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:26.489516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '397449bf-f608-40d7-8ac4-3590b423fdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1448c6330>]}
[0m15:26:26.490546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:26.587830 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_first_dbt_model
[0m15:26:26.588964 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_transformations_new.my_first_dbt_model ........ [RUN]
[0m15:26:26.589590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now model.online_shop_dbt.my_first_dbt_model)
[0m15:26:26.589888 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_first_dbt_model
[0m15:26:26.621618 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_first_dbt_model"
[0m15:26:26.628992 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_first_dbt_model
[0m15:26:26.654992 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_first_dbt_model"
[0m15:26:26.655598 [debug] [Thread-1 (]: On model.online_shop_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_first_dbt_model"} */

  
    

    create or replace table `opensource-marketing-dwh`.`dbt_transformations_new`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m15:26:26.655857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:27.147583 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:fdab731e-24c2-4a5c-974b-d77b32dc22ad&page=queryresults
[0m15:26:28.664057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397449bf-f608-40d7-8ac4-3590b423fdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144855b20>]}
[0m15:26:28.664831 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_transformations_new.my_first_dbt_model ... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.07s]
[0m15:26:28.665289 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_first_dbt_model
[0m15:26:28.665569 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_second_dbt_model
[0m15:26:28.665975 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_transformations_new.my_second_dbt_model ........ [RUN]
[0m15:26:28.666425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_first_dbt_model, now model.online_shop_dbt.my_second_dbt_model)
[0m15:26:28.666775 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_second_dbt_model
[0m15:26:28.670401 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_second_dbt_model"
[0m15:26:28.670953 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_second_dbt_model
[0m15:26:28.694093 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_second_dbt_model"
[0m15:26:28.694835 [debug] [Thread-1 (]: On model.online_shop_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_second_dbt_model"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `facebook_ads_dimensions.ads`;


[0m15:26:28.695187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:29.243621 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:9884a3c0-caae-48ac-9cd0-384fb2681da5&page=queryresults
[0m15:26:29.573656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397449bf-f608-40d7-8ac4-3590b423fdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144e66a20>]}
[0m15:26:29.574701 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_transformations_new.my_second_dbt_model ... [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m15:26:29.575335 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_second_dbt_model
[0m15:26:29.575748 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.testing
[0m15:26:29.576281 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_transformations_new.testing .................... [RUN]
[0m15:26:29.576765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_second_dbt_model, now model.online_shop_dbt.testing)
[0m15:26:29.577114 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.testing
[0m15:26:29.579640 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.testing"
[0m15:26:29.581085 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.testing
[0m15:26:29.583889 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.testing"
[0m15:26:29.584577 [debug] [Thread-1 (]: On model.online_shop_dbt.testing: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.testing"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`testing`
  OPTIONS()
  as SELECT 1 AS test_id;


[0m15:26:29.584959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:29.942597 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:527df28c-f708-47f3-9aed-6c045a7aa76d&page=queryresults
[0m15:26:30.266108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397449bf-f608-40d7-8ac4-3590b423fdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1459cff20>]}
[0m15:26:30.266659 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_transformations_new.testing ............... [[32mCREATE VIEW (0 processed)[0m in 0.69s]
[0m15:26:30.267088 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.testing
[0m15:26:30.267839 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:26:30.269192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:30.269422 [debug] [MainThread]: Connection 'model.online_shop_dbt.testing' was properly closed.
[0m15:26:30.269685 [info ] [MainThread]: 
[0m15:26:30.269914 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 7.10 seconds (7.10s).
[0m15:26:30.270575 [debug] [MainThread]: Command end result
[0m15:26:30.286140 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:26:30.287434 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:26:30.291619 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m15:26:30.291924 [info ] [MainThread]: 
[0m15:26:30.292447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:30.292713 [info ] [MainThread]: 
[0m15:26:30.292987 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:26:30.295340 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.122083, "process_in_blocks": "0", "process_kernel_time": 0.28482, "process_mem_max_rss": "206225408", "process_out_blocks": "0", "process_user_time": 1.8784}
[0m15:26:30.295682 [debug] [MainThread]: Command `dbt run` succeeded at 15:26:30.295625 after 8.12 seconds
[0m15:26:30.295926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f8aa0>]}
[0m15:26:30.296151 [debug] [MainThread]: Flushing usage events
[0m15:26:30.745595 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:43:04.512277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cabe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071bc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071bc410>]}


============================== 15:43:04.515723 | b27b1b41-cf1d-472c-8895-39f83b41c472 ==============================
[0m15:43:04.515723 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:43:04.516056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'debug': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:43:04.526464 [info ] [MainThread]: dbt version: 1.9.1
[0m15:43:04.526857 [info ] [MainThread]: python version: 3.12.7
[0m15:43:04.527210 [info ] [MainThread]: python path: /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/bin/python3.12
[0m15:43:04.527432 [info ] [MainThread]: os info: macOS-14.5-arm64-arm-64bit
[0m15:43:05.124822 [info ] [MainThread]: Using profiles dir at /Users/friedrichtenhagen/.dbt
[0m15:43:05.125088 [info ] [MainThread]: Using profiles.yml file at /Users/friedrichtenhagen/.dbt/profiles.yml
[0m15:43:05.125250 [info ] [MainThread]: Using dbt_project.yml file at /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/dbt_project.yml
[0m15:43:05.125386 [info ] [MainThread]: adapter type: bigquery
[0m15:43:05.125513 [info ] [MainThread]: adapter version: 1.9.1
[0m15:43:05.181053 [info ] [MainThread]: Configuration:
[0m15:43:05.181339 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:43:05.181559 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:43:05.181710 [info ] [MainThread]: Required dependencies:
[0m15:43:05.181920 [debug] [MainThread]: Executing "git --help"
[0m15:43:05.206217 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:43:05.206815 [debug] [MainThread]: STDERR: "b''"
[0m15:43:05.206995 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:43:05.207169 [info ] [MainThread]: Connection:
[0m15:43:05.207361 [info ] [MainThread]:   method: service-account
[0m15:43:05.207514 [info ] [MainThread]:   database: opensource-marketing-dwh
[0m15:43:05.207641 [info ] [MainThread]:   execution_project: opensource-marketing-dwh
[0m15:43:05.207762 [info ] [MainThread]:   schema: dbt_transformations_new
[0m15:43:05.207881 [info ] [MainThread]:   location: europe-west1
[0m15:43:05.208000 [info ] [MainThread]:   priority: interactive
[0m15:43:05.208237 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:43:05.208427 [info ] [MainThread]:   impersonate_service_account: None
[0m15:43:05.208567 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:43:05.208696 [info ] [MainThread]:   job_retries: 1
[0m15:43:05.208825 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:43:05.208959 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:43:05.209082 [info ] [MainThread]:   timeout_seconds: 300
[0m15:43:05.209198 [info ] [MainThread]:   client_id: None
[0m15:43:05.209313 [info ] [MainThread]:   token_uri: None
[0m15:43:05.209424 [info ] [MainThread]:   dataproc_region: None
[0m15:43:05.209537 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:43:05.209651 [info ] [MainThread]:   gcs_bucket: None
[0m15:43:05.209763 [info ] [MainThread]:   dataproc_batch: None
[0m15:43:05.210121 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:43:05.293256 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:43:05.293623 [debug] [MainThread]: On debug: select 1 as id
[0m15:43:05.293803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:43:05.756655 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:dbc82867-0202-426e-a1e1-0430085c16d3&page=queryresults
[0m15:43:06.129127 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:43:06.130442 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:43:06.135591 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.666221, "process_in_blocks": "0", "process_kernel_time": 0.251931, "process_mem_max_rss": "203849728", "process_out_blocks": "0", "process_user_time": 1.226475}
[0m15:43:06.136048 [debug] [MainThread]: Command `dbt debug` succeeded at 15:43:06.135958 after 1.67 seconds
[0m15:43:06.136328 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:43:06.136616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c735c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1164f7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b9af00>]}
[0m15:43:06.136923 [debug] [MainThread]: Flushing usage events
[0m15:43:06.622728 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:43:09.852804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be2f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f4800>]}


============================== 15:43:09.855540 | 638bf3ab-06d7-41ed-966f-fd09bfd6dc48 ==============================
[0m15:43:09.855540 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:43:09.855859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:43:10.358202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '638bf3ab-06d7-41ed-966f-fd09bfd6dc48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f01faa0>]}
[0m15:43:10.393371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '638bf3ab-06d7-41ed-966f-fd09bfd6dc48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e59a1b0>]}
[0m15:43:10.393748 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:43:10.479105 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:43:10.540785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:43:10.541014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:43:10.558580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '638bf3ab-06d7-41ed-966f-fd09bfd6dc48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2ad430>]}
[0m15:43:10.593051 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:43:10.595134 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:43:10.611826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '638bf3ab-06d7-41ed-966f-fd09bfd6dc48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4ce120>]}
[0m15:43:10.612116 [info ] [MainThread]: Found 3 models, 4 data tests, 489 macros
[0m15:43:10.612292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '638bf3ab-06d7-41ed-966f-fd09bfd6dc48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f677f20>]}
[0m15:43:10.616493 [info ] [MainThread]: 
[0m15:43:10.616706 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:43:10.616946 [info ] [MainThread]: 
[0m15:43:10.617299 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:43:10.622275 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m15:43:10.622542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:10.970787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now list_opensource-marketing-dwh_dbt_transformations_new)
[0m15:43:10.971719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:11.329649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '638bf3ab-06d7-41ed-966f-fd09bfd6dc48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108533d10>]}
[0m15:43:11.330854 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:43:11.334795 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_first_dbt_model
[0m15:43:11.335400 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_transformations_new.my_first_dbt_model ........ [RUN]
[0m15:43:11.335852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now model.online_shop_dbt.my_first_dbt_model)
[0m15:43:11.336218 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_first_dbt_model
[0m15:43:11.404086 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_first_dbt_model"
[0m15:43:11.404678 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_first_dbt_model
[0m15:43:11.413392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:11.769993 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_first_dbt_model"
[0m15:43:11.771048 [debug] [Thread-1 (]: On model.online_shop_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_first_dbt_model"} */

  
    

    create or replace table `opensource-marketing-dwh`.`dbt_transformations_new`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m15:43:12.116720 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:e00bf3c0-89e9-4de4-8506-3236716a73ff&page=queryresults
[0m15:43:14.063276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638bf3ab-06d7-41ed-966f-fd09bfd6dc48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0d1eb0>]}
[0m15:43:14.063996 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_transformations_new.my_first_dbt_model ... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.73s]
[0m15:43:14.064441 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_first_dbt_model
[0m15:43:14.064730 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_second_dbt_model
[0m15:43:14.065095 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_transformations_new.my_second_dbt_model ........ [RUN]
[0m15:43:14.065421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_first_dbt_model, now model.online_shop_dbt.my_second_dbt_model)
[0m15:43:14.065667 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_second_dbt_model
[0m15:43:14.067822 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_second_dbt_model"
[0m15:43:14.068901 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_second_dbt_model
[0m15:43:14.089748 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_second_dbt_model"
[0m15:43:14.090990 [debug] [Thread-1 (]: On model.online_shop_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_second_dbt_model"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `facebook_ads_dimensions.ads`;


[0m15:43:14.091355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:14.573614 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:9a7dde61-a9c1-4d80-8d82-69ce8265bc24&page=queryresults
[0m15:43:14.779841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638bf3ab-06d7-41ed-966f-fd09bfd6dc48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f98de80>]}
[0m15:43:14.780824 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_transformations_new.my_second_dbt_model ... [[32mCREATE VIEW (0 processed)[0m in 0.71s]
[0m15:43:14.781446 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_second_dbt_model
[0m15:43:14.781903 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.testing
[0m15:43:14.782447 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_transformations_new.testing .................... [RUN]
[0m15:43:14.782868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_second_dbt_model, now model.online_shop_dbt.testing)
[0m15:43:14.783201 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.testing
[0m15:43:14.785309 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.testing"
[0m15:43:14.787137 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.testing
[0m15:43:14.790251 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.testing"
[0m15:43:14.791065 [debug] [Thread-1 (]: On model.online_shop_dbt.testing: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.testing"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`testing`
  OPTIONS()
  as SELECT * FROM opensource-marketing-dwh.facebook_ads_dimensions.ad_sets;


[0m15:43:14.791476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:15.203799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:c5093190-371a-4152-abd2-a21b7ac1cfdd&page=queryresults
[0m15:43:15.477407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638bf3ab-06d7-41ed-966f-fd09bfd6dc48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f983d40>]}
[0m15:43:15.478730 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_transformations_new.testing ............... [[32mCREATE VIEW (0 processed)[0m in 0.69s]
[0m15:43:15.479599 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.testing
[0m15:43:15.480851 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:43:15.482658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:15.483023 [debug] [MainThread]: Connection 'model.online_shop_dbt.testing' was properly closed.
[0m15:43:15.483398 [info ] [MainThread]: 
[0m15:43:15.483722 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m15:43:15.484754 [debug] [MainThread]: Command end result
[0m15:43:15.511093 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m15:43:15.512831 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m15:43:15.518063 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m15:43:15.518367 [info ] [MainThread]: 
[0m15:43:15.518691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:43:15.518937 [info ] [MainThread]: 
[0m15:43:15.519201 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:43:15.521783 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.708686, "process_in_blocks": "0", "process_kernel_time": 0.241892, "process_mem_max_rss": "210370560", "process_out_blocks": "0", "process_user_time": 1.847109}
[0m15:43:15.522221 [debug] [MainThread]: Command `dbt run` succeeded at 15:43:15.522142 after 5.71 seconds
[0m15:43:15.522537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f4a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f57b8f0>]}
[0m15:43:15.522847 [debug] [MainThread]: Flushing usage events
[0m15:43:15.960038 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:26:50.429653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043289e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104910770>]}


============================== 16:26:50.432666 | 5bf57f30-3fb2-4a28-b9b7-4bb22f4b598c ==============================
[0m16:26:50.432666 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:26:50.432989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m16:26:51.092183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bf57f30-3fb2-4a28-b9b7-4bb22f4b598c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a70e060>]}
[0m16:26:51.126689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bf57f30-3fb2-4a28-b9b7-4bb22f4b598c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a70c500>]}
[0m16:26:51.127021 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m16:26:51.215418 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:26:51.277658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:26:51.277983 [debug] [MainThread]: Partial parsing: added file: online_shop_dbt://online_shop_dbt/seeds/shopify_orders.csv
[0m16:26:51.455610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bf57f30-3fb2-4a28-b9b7-4bb22f4b598c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae4e030>]}
[0m16:26:51.493666 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m16:26:51.495891 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m16:26:51.507512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bf57f30-3fb2-4a28-b9b7-4bb22f4b598c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aca0c20>]}
[0m16:26:51.507781 [info ] [MainThread]: Found 4 models, 4 data tests, 1 seed, 489 macros
[0m16:26:51.507955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bf57f30-3fb2-4a28-b9b7-4bb22f4b598c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035a0200>]}
[0m16:26:51.508794 [info ] [MainThread]: 
[0m16:26:51.508959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:26:51.509093 [info ] [MainThread]: 
[0m16:26:51.509325 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:26:51.509774 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m16:26:51.509955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:51.929436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now list_opensource-marketing-dwh_dbt_transformations_new)
[0m16:26:51.930134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:52.269417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bf57f30-3fb2-4a28-b9b7-4bb22f4b598c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae4d2e0>]}
[0m16:26:52.269941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:52.272414 [debug] [Thread-1 (]: Began running node seed.online_shop_dbt.shopify_orders
[0m16:26:52.273053 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_transformations_new.shopify_orders .................. [RUN]
[0m16:26:52.273633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now seed.online_shop_dbt.shopify_orders)
[0m16:26:52.274091 [debug] [Thread-1 (]: Began compiling node seed.online_shop_dbt.shopify_orders
[0m16:26:52.274550 [debug] [Thread-1 (]: Began executing node seed.online_shop_dbt.shopify_orders
[0m16:26:52.367609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:54.415551 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
400 Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2024-05-03T10:42Z"; line_number: 2 byte_offset_to_start_of_line: 3306 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "2024-05-03T10:42Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 3 byte_offset_to_start_of_line: 5461 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 4 byte_offset_to_start_of_line: 7533 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 5 byte_offset_to_start_of_line: 9554 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 6 byte_offset_to_start_of_line: 11060 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 7 byte_offset_to_start_of_line: 12605 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 8 byte_offset_to_start_of_line: 14146 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 9 byte_offset_to_start_of_line: 16137 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 10 byte_offset_to_start_of_line: 17989 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 11 byte_offset_to_start_of_line: 19896 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 12 byte_offset_to_start_of_line: 21879 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 13 byte_offset_to_start_of_line: 23867 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 14 byte_offset_to_start_of_line: 25748 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 15 byte_offset_to_start_of_line: 27250 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 16 byte_offset_to_start_of_line: 29159 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 17 byte_offset_to_start_of_line: 30667 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 18 byte_offset_to_start_of_line: 32658 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 19 byte_offset_to_start_of_line: 34609 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 20 byte_offset_to_start_of_line: 36219 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 21 byte_offset_to_start_of_line: 37739 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 22 byte_offset_to_start_of_line: 39777 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 23 byte_offset_to_start_of_line: 41699 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 24 byte_offset_to_start_of_line: 44051 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 25 byte_offset_to_start_of_line: 46025 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 26 byte_offset_to_start_of_line: 47797 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 27 byte_offset_to_start_of_line: 49446 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 28 byte_offset_to_start_of_line: 51704 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 29 byte_offset_to_start_of_line: 54163 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 30 byte_offset_to_start_of_line: 56601 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 31 byte_offset_to_start_of_line: 58106 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 32 byte_offset_to_start_of_line: 59968 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 33 byte_offset_to_start_of_line: 62058 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 34 byte_offset_to_start_of_line: 64133 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 35 byte_offset_to_start_of_line: 66175 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 36 byte_offset_to_start_of_line: 68134 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 37 byte_offset_to_start_of_line: 70049 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 38 byte_offset_to_start_of_line: 71995 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 39 byte_offset_to_start_of_line: 73932 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 40 byte_offset_to_start_of_line: 75798 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 41 byte_offset_to_start_of_line: 77278 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 42 byte_offset_to_start_of_line: 79740 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 43 byte_offset_to_start_of_line: 81460 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 44 byte_offset_to_start_of_line: 83515 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 45 byte_offset_to_start_of_line: 85495 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 46 byte_offset_to_start_of_line: 87297 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 47 byte_offset_to_start_of_line: 89276 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 48 byte_offset_to_start_of_line: 91677 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 49 byte_offset_to_start_of_line: 93733 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 50 byte_offset_to_start_of_line: 95679 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 51 byte_offset_to_start_of_line: 97602 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 52 byte_offset_to_start_of_line: 99237 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 53 byte_offset_to_start_of_line: 101218 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 54 byte_offset_to_start_of_line: 103243 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 55 byte_offset_to_start_of_line: 105283 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 56 byte_offset_to_start_of_line: 106899 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 57 byte_offset_to_start_of_line: 108935 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 58 byte_offset_to_start_of_line: 110987 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 59 byte_offset_to_start_of_line: 112574 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 60 byte_offset_to_start_of_line: 114569 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 61 byte_offset_to_start_of_line: 116526 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 62 byte_offset_to_start_of_line: 118604 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 63 byte_offset_to_start_of_line: 120607 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 64 byte_offset_to_start_of_line: 122552 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 65 byte_offset_to_start_of_line: 124336 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 66 byte_offset_to_start_of_line: 125901 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 67 byte_offset_to_start_of_line: 127963 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 68 byte_offset_to_start_of_line: 130013 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 69 byte_offset_to_start_of_line: 131528 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 70 byte_offset_to_start_of_line: 133438 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 71 byte_offset_to_start_of_line: 135380 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 72 byte_offset_to_start_of_line: 136994 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 73 byte_offset_to_start_of_line: 138608 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 74 byte_offset_to_start_of_line: 140562 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 75 byte_offset_to_start_of_line: 142571 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 76 byte_offset_to_start_of_line: 144321 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 77 byte_offset_to_start_of_line: 146558 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 78 byte_offset_to_start_of_line: 148572 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 79 byte_offset_to_start_of_line: 150204 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 80 byte_offset_to_start_of_line: 152208 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 81 byte_offset_to_start_of_line: 154137 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 82 byte_offset_to_start_of_line: 156034 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 83 byte_offset_to_start_of_line: 157915 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 84 byte_offset_to_start_of_line: 159445 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 85 byte_offset_to_start_of_line: 160961 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 86 byte_offset_to_start_of_line: 162985 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 87 byte_offset_to_start_of_line: 164648 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 88 byte_offset_to_start_of_line: 166784 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 89 byte_offset_to_start_of_line: 168630 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 90 byte_offset_to_start_of_line: 170233 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 91 byte_offset_to_start_of_line: 172178 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 92 byte_offset_to_start_of_line: 174444 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 93 byte_offset_to_start_of_line: 176467 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 94 byte_offset_to_start_of_line: 178468 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 95 byte_offset_to_start_of_line: 180762 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 96 byte_offset_to_start_of_line: 182373 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 97 byte_offset_to_start_of_line: 184353 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 98 byte_offset_to_start_of_line: 186315 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 99 byte_offset_to_start_of_line: 187849 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 100 byte_offset_to_start_of_line: 190078 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 101 byte_offset_to_start_of_line: 191860 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:26:54.429265 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/task/base.py", line 308, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/task/base.py", line 408, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/task/run.py", line 332, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/task/run.py", line 292, in _execute_model
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 109, in macro
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 21, in macro
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 323, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 25, in macro
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/adapters/bigquery/impl.py", line 666, in load_dataframe
    self.connections.write_dataframe_to_table(
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/adapters/bigquery/connections.py", line 465, in write_dataframe_to_table
    self._write_file_to_table(client, file_path, table, load_config, fallback_timeout)
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/dbt/adapters/bigquery/connections.py", line 497, in _write_file_to_table
    response = job.result(retry=self._retry.create_retry(fallback=fallback_timeout))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/google/cloud/bigquery/job/base.py", line 969, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/online_shop_venv/lib/python3.12/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2024-05-03T10:42Z"; line_number: 2 byte_offset_to_start_of_line: 3306 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "2024-05-03T10:42Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 3 byte_offset_to_start_of_line: 5461 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 4 byte_offset_to_start_of_line: 7533 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 5 byte_offset_to_start_of_line: 9554 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 6 byte_offset_to_start_of_line: 11060 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 7 byte_offset_to_start_of_line: 12605 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 8 byte_offset_to_start_of_line: 14146 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 9 byte_offset_to_start_of_line: 16137 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 10 byte_offset_to_start_of_line: 17989 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 11 byte_offset_to_start_of_line: 19896 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 12 byte_offset_to_start_of_line: 21879 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 13 byte_offset_to_start_of_line: 23867 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 14 byte_offset_to_start_of_line: 25748 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 15 byte_offset_to_start_of_line: 27250 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 16 byte_offset_to_start_of_line: 29159 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 17 byte_offset_to_start_of_line: 30667 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 18 byte_offset_to_start_of_line: 32658 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 19 byte_offset_to_start_of_line: 34609 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 20 byte_offset_to_start_of_line: 36219 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 21 byte_offset_to_start_of_line: 37739 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 22 byte_offset_to_start_of_line: 39777 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 23 byte_offset_to_start_of_line: 41699 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 24 byte_offset_to_start_of_line: 44051 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 25 byte_offset_to_start_of_line: 46025 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 26 byte_offset_to_start_of_line: 47797 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 27 byte_offset_to_start_of_line: 49446 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 28 byte_offset_to_start_of_line: 51704 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 29 byte_offset_to_start_of_line: 54163 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 30 byte_offset_to_start_of_line: 56601 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 31 byte_offset_to_start_of_line: 58106 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 32 byte_offset_to_start_of_line: 59968 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 33 byte_offset_to_start_of_line: 62058 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 34 byte_offset_to_start_of_line: 64133 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 35 byte_offset_to_start_of_line: 66175 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 36 byte_offset_to_start_of_line: 68134 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 37 byte_offset_to_start_of_line: 70049 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 38 byte_offset_to_start_of_line: 71995 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 39 byte_offset_to_start_of_line: 73932 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 40 byte_offset_to_start_of_line: 75798 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 41 byte_offset_to_start_of_line: 77278 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 42 byte_offset_to_start_of_line: 79740 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 43 byte_offset_to_start_of_line: 81460 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 44 byte_offset_to_start_of_line: 83515 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 45 byte_offset_to_start_of_line: 85495 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 46 byte_offset_to_start_of_line: 87297 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 47 byte_offset_to_start_of_line: 89276 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 48 byte_offset_to_start_of_line: 91677 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 49 byte_offset_to_start_of_line: 93733 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 50 byte_offset_to_start_of_line: 95679 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 51 byte_offset_to_start_of_line: 97602 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 52 byte_offset_to_start_of_line: 99237 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 53 byte_offset_to_start_of_line: 101218 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 54 byte_offset_to_start_of_line: 103243 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 55 byte_offset_to_start_of_line: 105283 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 56 byte_offset_to_start_of_line: 106899 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 57 byte_offset_to_start_of_line: 108935 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 58 byte_offset_to_start_of_line: 110987 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 59 byte_offset_to_start_of_line: 112574 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 60 byte_offset_to_start_of_line: 114569 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 61 byte_offset_to_start_of_line: 116526 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 62 byte_offset_to_start_of_line: 118604 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 63 byte_offset_to_start_of_line: 120607 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 64 byte_offset_to_start_of_line: 122552 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 65 byte_offset_to_start_of_line: 124336 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 66 byte_offset_to_start_of_line: 125901 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 67 byte_offset_to_start_of_line: 127963 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 68 byte_offset_to_start_of_line: 130013 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 69 byte_offset_to_start_of_line: 131528 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 70 byte_offset_to_start_of_line: 133438 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 71 byte_offset_to_start_of_line: 135380 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 72 byte_offset_to_start_of_line: 136994 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 73 byte_offset_to_start_of_line: 138608 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 74 byte_offset_to_start_of_line: 140562 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 75 byte_offset_to_start_of_line: 142571 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 76 byte_offset_to_start_of_line: 144321 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 77 byte_offset_to_start_of_line: 146558 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 78 byte_offset_to_start_of_line: 148572 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 79 byte_offset_to_start_of_line: 150204 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 80 byte_offset_to_start_of_line: 152208 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 81 byte_offset_to_start_of_line: 154137 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 82 byte_offset_to_start_of_line: 156034 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 83 byte_offset_to_start_of_line: 157915 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 84 byte_offset_to_start_of_line: 159445 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 85 byte_offset_to_start_of_line: 160961 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 86 byte_offset_to_start_of_line: 162985 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 87 byte_offset_to_start_of_line: 164648 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 88 byte_offset_to_start_of_line: 166784 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 89 byte_offset_to_start_of_line: 168630 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 90 byte_offset_to_start_of_line: 170233 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 91 byte_offset_to_start_of_line: 172178 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 92 byte_offset_to_start_of_line: 174444 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 93 byte_offset_to_start_of_line: 176467 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 94 byte_offset_to_start_of_line: 178468 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 95 byte_offset_to_start_of_line: 180762 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 96 byte_offset_to_start_of_line: 182373 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 97 byte_offset_to_start_of_line: 184353 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 98 byte_offset_to_start_of_line: 186315 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 99 byte_offset_to_start_of_line: 187849 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 100 byte_offset_to_start_of_line: 190078 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 101 byte_offset_to_start_of_line: 191860 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.

[0m16:26:54.434030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bf57f30-3fb2-4a28-b9b7-4bb22f4b598c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9dc5f0>]}
[0m16:26:54.436854 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file dbt_transformations_new.shopify_orders .......... [[31mERROR[0m in 2.16s]
[0m16:26:54.440250 [debug] [Thread-1 (]: Finished running node seed.online_shop_dbt.shopify_orders
[0m16:26:54.443289 [debug] [Thread-4 (]: Marking all children of 'seed.online_shop_dbt.shopify_orders' to be skipped because of status 'error'.  Reason: 400 Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2024-05-03T10:42Z"; line_number: 2 byte_offset_to_start_of_line: 3306 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "2024-05-03T10:42Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 3 byte_offset_to_start_of_line: 5461 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 4 byte_offset_to_start_of_line: 7533 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 5 byte_offset_to_start_of_line: 9554 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 6 byte_offset_to_start_of_line: 11060 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 7 byte_offset_to_start_of_line: 12605 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 8 byte_offset_to_start_of_line: 14146 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 9 byte_offset_to_start_of_line: 16137 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 10 byte_offset_to_start_of_line: 17989 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 11 byte_offset_to_start_of_line: 19896 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 12 byte_offset_to_start_of_line: 21879 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 13 byte_offset_to_start_of_line: 23867 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 14 byte_offset_to_start_of_line: 25748 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 15 byte_offset_to_start_of_line: 27250 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 16 byte_offset_to_start_of_line: 29159 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 17 byte_offset_to_start_of_line: 30667 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 18 byte_offset_to_start_of_line: 32658 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 19 byte_offset_to_start_of_line: 34609 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 20 byte_offset_to_start_of_line: 36219 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 21 byte_offset_to_start_of_line: 37739 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 22 byte_offset_to_start_of_line: 39777 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 23 byte_offset_to_start_of_line: 41699 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 24 byte_offset_to_start_of_line: 44051 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 25 byte_offset_to_start_of_line: 46025 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 26 byte_offset_to_start_of_line: 47797 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 27 byte_offset_to_start_of_line: 49446 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 28 byte_offset_to_start_of_line: 51704 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 29 byte_offset_to_start_of_line: 54163 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 30 byte_offset_to_start_of_line: 56601 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 31 byte_offset_to_start_of_line: 58106 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 32 byte_offset_to_start_of_line: 59968 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 33 byte_offset_to_start_of_line: 62058 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 34 byte_offset_to_start_of_line: 64133 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 35 byte_offset_to_start_of_line: 66175 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 36 byte_offset_to_start_of_line: 68134 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 37 byte_offset_to_start_of_line: 70049 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 38 byte_offset_to_start_of_line: 71995 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 39 byte_offset_to_start_of_line: 73932 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 40 byte_offset_to_start_of_line: 75798 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 41 byte_offset_to_start_of_line: 77278 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 42 byte_offset_to_start_of_line: 79740 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 43 byte_offset_to_start_of_line: 81460 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 44 byte_offset_to_start_of_line: 83515 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 45 byte_offset_to_start_of_line: 85495 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 46 byte_offset_to_start_of_line: 87297 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 47 byte_offset_to_start_of_line: 89276 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 48 byte_offset_to_start_of_line: 91677 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 49 byte_offset_to_start_of_line: 93733 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 50 byte_offset_to_start_of_line: 95679 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 51 byte_offset_to_start_of_line: 97602 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 52 byte_offset_to_start_of_line: 99237 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 53 byte_offset_to_start_of_line: 101218 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 54 byte_offset_to_start_of_line: 103243 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 55 byte_offset_to_start_of_line: 105283 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 56 byte_offset_to_start_of_line: 106899 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 57 byte_offset_to_start_of_line: 108935 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 58 byte_offset_to_start_of_line: 110987 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 59 byte_offset_to_start_of_line: 112574 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 60 byte_offset_to_start_of_line: 114569 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 61 byte_offset_to_start_of_line: 116526 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 62 byte_offset_to_start_of_line: 118604 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 63 byte_offset_to_start_of_line: 120607 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 64 byte_offset_to_start_of_line: 122552 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 65 byte_offset_to_start_of_line: 124336 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 66 byte_offset_to_start_of_line: 125901 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 67 byte_offset_to_start_of_line: 127963 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 68 byte_offset_to_start_of_line: 130013 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 69 byte_offset_to_start_of_line: 131528 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 70 byte_offset_to_start_of_line: 133438 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 71 byte_offset_to_start_of_line: 135380 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 72 byte_offset_to_start_of_line: 136994 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 73 byte_offset_to_start_of_line: 138608 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 74 byte_offset_to_start_of_line: 140562 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 75 byte_offset_to_start_of_line: 142571 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 76 byte_offset_to_start_of_line: 144321 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 77 byte_offset_to_start_of_line: 146558 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 78 byte_offset_to_start_of_line: 148572 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 79 byte_offset_to_start_of_line: 150204 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 80 byte_offset_to_start_of_line: 152208 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 81 byte_offset_to_start_of_line: 154137 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 82 byte_offset_to_start_of_line: 156034 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 83 byte_offset_to_start_of_line: 157915 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 84 byte_offset_to_start_of_line: 159445 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 85 byte_offset_to_start_of_line: 160961 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 86 byte_offset_to_start_of_line: 162985 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 87 byte_offset_to_start_of_line: 164648 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 88 byte_offset_to_start_of_line: 166784 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 89 byte_offset_to_start_of_line: 168630 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 90 byte_offset_to_start_of_line: 170233 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 91 byte_offset_to_start_of_line: 172178 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 92 byte_offset_to_start_of_line: 174444 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 93 byte_offset_to_start_of_line: 176467 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 94 byte_offset_to_start_of_line: 178468 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 95 byte_offset_to_start_of_line: 180762 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 96 byte_offset_to_start_of_line: 182373 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 97 byte_offset_to_start_of_line: 184353 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 98 byte_offset_to_start_of_line: 186315 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 99 byte_offset_to_start_of_line: 187849 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 100 byte_offset_to_start_of_line: 190078 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 101 byte_offset_to_start_of_line: 191860 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format..
[0m16:26:54.447881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:26:54.449704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:54.449983 [debug] [MainThread]: Connection 'seed.online_shop_dbt.shopify_orders' was properly closed.
[0m16:26:54.450316 [info ] [MainThread]: 
[0m16:26:54.450658 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m16:26:54.452263 [debug] [MainThread]: Command end result
[0m16:26:54.472093 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m16:26:54.473417 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m16:26:54.477957 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m16:26:54.478197 [info ] [MainThread]: 
[0m16:26:54.478436 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:26:54.478627 [info ] [MainThread]: 
[0m16:26:54.479725 [error] [MainThread]:   400 Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.; reason: invalid, message: Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0; reason: invalid, message: Error while reading data, error message: Invalid datetime string "2024-05-03T10:42Z"; line_number: 2 byte_offset_to_start_of_line: 3306 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "2024-05-03T10:42Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 3 byte_offset_to_start_of_line: 5461 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 4 byte_offset_to_start_of_line: 7533 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 5 byte_offset_to_start_of_line: 9554 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 6 byte_offset_to_start_of_line: 11060 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 7 byte_offset_to_start_of_line: 12605 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 8 byte_offset_to_start_of_line: 14146 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 9 byte_offset_to_start_of_line: 16137 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 10 byte_offset_to_start_of_line: 17989 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 11 byte_offset_to_start_of_line: 19896 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 12 byte_offset_to_start_of_line: 21879 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 13 byte_offset_to_start_of_line: 23867 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 14 byte_offset_to_start_of_line: 25748 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 15 byte_offset_to_start_of_line: 27250 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 16 byte_offset_to_start_of_line: 29159 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 17 byte_offset_to_start_of_line: 30667 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 18 byte_offset_to_start_of_line: 32658 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 19 byte_offset_to_start_of_line: 34609 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 20 byte_offset_to_start_of_line: 36219 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 21 byte_offset_to_start_of_line: 37739 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 22 byte_offset_to_start_of_line: 39777 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 23 byte_offset_to_start_of_line: 41699 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 24 byte_offset_to_start_of_line: 44051 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 25 byte_offset_to_start_of_line: 46025 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 26 byte_offset_to_start_of_line: 47797 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 27 byte_offset_to_start_of_line: 49446 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 28 byte_offset_to_start_of_line: 51704 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 29 byte_offset_to_start_of_line: 54163 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 30 byte_offset_to_start_of_line: 56601 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 31 byte_offset_to_start_of_line: 58106 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 32 byte_offset_to_start_of_line: 59968 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 33 byte_offset_to_start_of_line: 62058 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 34 byte_offset_to_start_of_line: 64133 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 35 byte_offset_to_start_of_line: 66175 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 36 byte_offset_to_start_of_line: 68134 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 37 byte_offset_to_start_of_line: 70049 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 38 byte_offset_to_start_of_line: 71995 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 39 byte_offset_to_start_of_line: 73932 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 40 byte_offset_to_start_of_line: 75798 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 41 byte_offset_to_start_of_line: 77278 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 42 byte_offset_to_start_of_line: 79740 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 43 byte_offset_to_start_of_line: 81460 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 44 byte_offset_to_start_of_line: 83515 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 45 byte_offset_to_start_of_line: 85495 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 46 byte_offset_to_start_of_line: 87297 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 47 byte_offset_to_start_of_line: 89276 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 48 byte_offset_to_start_of_line: 91677 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 49 byte_offset_to_start_of_line: 93733 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 50 byte_offset_to_start_of_line: 95679 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 51 byte_offset_to_start_of_line: 97602 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 52 byte_offset_to_start_of_line: 99237 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 53 byte_offset_to_start_of_line: 101218 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 54 byte_offset_to_start_of_line: 103243 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 55 byte_offset_to_start_of_line: 105283 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 56 byte_offset_to_start_of_line: 106899 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 57 byte_offset_to_start_of_line: 108935 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 58 byte_offset_to_start_of_line: 110987 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 59 byte_offset_to_start_of_line: 112574 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 60 byte_offset_to_start_of_line: 114569 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 61 byte_offset_to_start_of_line: 116526 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 62 byte_offset_to_start_of_line: 118604 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 63 byte_offset_to_start_of_line: 120607 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 64 byte_offset_to_start_of_line: 122552 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 65 byte_offset_to_start_of_line: 124336 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 66 byte_offset_to_start_of_line: 125901 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 67 byte_offset_to_start_of_line: 127963 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 68 byte_offset_to_start_of_line: 130013 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 69 byte_offset_to_start_of_line: 131528 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 70 byte_offset_to_start_of_line: 133438 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 71 byte_offset_to_start_of_line: 135380 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 72 byte_offset_to_start_of_line: 136994 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 73 byte_offset_to_start_of_line: 138608 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 74 byte_offset_to_start_of_line: 140562 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 75 byte_offset_to_start_of_line: 142571 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 76 byte_offset_to_start_of_line: 144321 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 77 byte_offset_to_start_of_line: 146558 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 78 byte_offset_to_start_of_line: 148572 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 79 byte_offset_to_start_of_line: 150204 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 80 byte_offset_to_start_of_line: 152208 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 81 byte_offset_to_start_of_line: 154137 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 82 byte_offset_to_start_of_line: 156034 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 83 byte_offset_to_start_of_line: 157915 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 84 byte_offset_to_start_of_line: 159445 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 85 byte_offset_to_start_of_line: 160961 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 86 byte_offset_to_start_of_line: 162985 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 87 byte_offset_to_start_of_line: 164648 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 88 byte_offset_to_start_of_line: 166784 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 89 byte_offset_to_start_of_line: 168630 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 90 byte_offset_to_start_of_line: 170233 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 91 byte_offset_to_start_of_line: 172178 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 92 byte_offset_to_start_of_line: 174444 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 93 byte_offset_to_start_of_line: 176467 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 94 byte_offset_to_start_of_line: 178468 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 95 byte_offset_to_start_of_line: 180762 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 96 byte_offset_to_start_of_line: 182373 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 97 byte_offset_to_start_of_line: 184353 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 98 byte_offset_to_start_of_line: 186315 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 99 byte_offset_to_start_of_line: 187849 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 100 byte_offset_to_start_of_line: 190078 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: Error while reading data, error message: Invalid datetime string "1970-01-01T00:00Z"; line_number: 101 byte_offset_to_start_of_line: 191860 column_index: 2 column_name: "cancelled_at" column_type: DATETIME value: "1970-01-01T00:00Z"; reason: invalid, message: You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m16:26:54.481281 [info ] [MainThread]: 
[0m16:26:54.481476 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:26:54.483566 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 4.094607, "process_in_blocks": "0", "process_kernel_time": 0.261232, "process_mem_max_rss": "217333760", "process_out_blocks": "0", "process_user_time": 1.757377}
[0m16:26:54.483826 [debug] [MainThread]: Command `dbt seed` failed at 16:26:54.483772 after 4.09 seconds
[0m16:26:54.484056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeb51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049109b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104910980>]}
[0m16:26:54.484272 [debug] [MainThread]: Flushing usage events
[0m16:26:54.930255 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:09.319400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f57260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108468860>]}


============================== 16:58:09.321869 | 7495e017-2fac-49fa-8bc4-fad2b4231c48 ==============================
[0m16:58:09.321869 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:58:09.322244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:58:09.914373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7495e017-2fac-49fa-8bc4-fad2b4231c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e513aa0>]}
[0m16:58:09.948382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7495e017-2fac-49fa-8bc4-fad2b4231c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddcf920>]}
[0m16:58:09.948714 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m16:58:10.035262 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:58:10.093572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:58:10.093794 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:58:10.111174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7495e017-2fac-49fa-8bc4-fad2b4231c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6374a0>]}
[0m16:58:10.144168 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m16:58:10.146564 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m16:58:10.159523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7495e017-2fac-49fa-8bc4-fad2b4231c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7ec770>]}
[0m16:58:10.159883 [info ] [MainThread]: Found 4 models, 4 data tests, 489 macros
[0m16:58:10.160048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7495e017-2fac-49fa-8bc4-fad2b4231c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9b3620>]}
[0m16:58:10.161090 [info ] [MainThread]: 
[0m16:58:10.161271 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:58:10.161407 [info ] [MainThread]: 
[0m16:58:10.161681 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:58:10.163697 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m16:58:10.163906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:10.731256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now list_opensource-marketing-dwh_dbt_transformations_new)
[0m16:58:10.732510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:11.067009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7495e017-2fac-49fa-8bc4-fad2b4231c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4b2570>]}
[0m16:58:11.068152 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:58:11.071949 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_first_dbt_model
[0m16:58:11.072753 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_transformations_new.my_first_dbt_model ........ [RUN]
[0m16:58:11.073429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now model.online_shop_dbt.my_first_dbt_model)
[0m16:58:11.073957 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_first_dbt_model
[0m16:58:11.144254 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_first_dbt_model"
[0m16:58:11.146339 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_first_dbt_model
[0m16:58:11.154775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:11.485420 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_first_dbt_model"
[0m16:58:11.487704 [debug] [Thread-1 (]: On model.online_shop_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_first_dbt_model"} */

  
    

    create or replace table `opensource-marketing-dwh`.`dbt_transformations_new`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:58:11.750813 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:a8192834-8110-495b-b2df-53fdb4925b8d&page=queryresults
[0m16:58:13.375100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7495e017-2fac-49fa-8bc4-fad2b4231c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9ffef0>]}
[0m16:58:13.375892 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_transformations_new.my_first_dbt_model ... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.30s]
[0m16:58:13.376505 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_first_dbt_model
[0m16:58:13.376902 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_second_dbt_model
[0m16:58:13.377411 [info ] [Thread-1 (]: 2 of 4 START sql view model dbt_transformations_new.my_second_dbt_model ........ [RUN]
[0m16:58:13.377892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_first_dbt_model, now model.online_shop_dbt.my_second_dbt_model)
[0m16:58:13.378256 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_second_dbt_model
[0m16:58:13.380349 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_second_dbt_model"
[0m16:58:13.380975 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_second_dbt_model
[0m16:58:13.401084 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_second_dbt_model"
[0m16:58:13.401896 [debug] [Thread-1 (]: On model.online_shop_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_second_dbt_model"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `facebook_ads_dimensions.ads`;


[0m16:58:13.402249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:13.901680 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:7bc619fb-42fd-4d42-b202-2169e07cec84&page=queryresults
[0m16:58:14.130280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7495e017-2fac-49fa-8bc4-fad2b4231c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed017f0>]}
[0m16:58:14.131164 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbt_transformations_new.my_second_dbt_model ... [[32mCREATE VIEW (0 processed)[0m in 0.75s]
[0m16:58:14.131974 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_second_dbt_model
[0m16:58:14.132539 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.stg_shopify__orders
[0m16:58:14.133310 [info ] [Thread-1 (]: 3 of 4 START sql view model dbt_transformations_new.stg_shopify__orders ........ [RUN]
[0m16:58:14.134024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_second_dbt_model, now model.online_shop_dbt.stg_shopify__orders)
[0m16:58:14.134400 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.stg_shopify__orders
[0m16:58:14.137412 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.stg_shopify__orders"
[0m16:58:14.138851 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.stg_shopify__orders
[0m16:58:14.142184 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.stg_shopify__orders"
[0m16:58:14.143413 [debug] [Thread-1 (]: On model.online_shop_dbt.stg_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.stg_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  OPTIONS()
  as WITH shopify AS (
    SELECT * FROM opensource-marketing-dwh.shopify.shopify_orders
),

-- removes columns that are not needed at the moment
filter_source AS (
    SELECT
        id AS order_id,
        customer_id,
        -- app_id,
        -- cancel_reason,
        -- totals
        total_discounts,
        total_line_items_price,
        total_price,
        -- total_price_usd,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
        -- total_tip_received,

        -- cart_token,
        -- checkout_id,
        -- checkout_token,
        -- timestamps
        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        -- client details
        -- client_details_accept_language,
        -- client_details_browser_height,
        -- client_details_browser_ip,
        -- client_details_browser_width,
        -- client_details_session_hash,
        -- client_details_user_agent,
        -- confirmed,
        -- currency,
        -- customer_accepts_marketing,
        -- customer_accepts_marketing_updated_at,
        -- customer_created_at,
        -- customer_uid,
        -- customer_locale,
        -- customer_multipass_identifier,
        -- customer_note,
        -- customer_state,
        -- customer_tags,
        -- customer_tax_exempt,
        -- customer_total_spent,
        -- customer_updated_at,
        -- device_id,
        -- discount application
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        -- financial_status,
        -- fulfillment_status,
        -- gateway,
        -- uid,
        landing_site,
        -- landing_site_ref,
        -- fulfillments_location_id,
        -- fulfillments_line_item_id,
        -- line items
        -- line_item_discount_allocations_amount,
        -- line_item_discount_allocations_application_index,
        -- line_item_fulfillable_quantity,
        -- line_item_fulfillment_service,
        -- line_item_fulfillment_status,
        -- line_item_gift_card,
        -- line_item_grams,
        -- line_item_id,
        -- line_item_uid,
        -- line_item_name,
        -- line_item_price,
        -- line_item_product_exists,
        -- line_item_product_id,
        -- line_item_product_uid,
        -- line_item_properties,
        -- line_item_quantity,
        -- line_item_requires_shipping,
        -- line_item_sku,
        -- line_item_tax_lines_price,
        -- line_item_tax_lines_rate,
        -- line_item_tax_lines_title,
        -- line_item_taxable,
        -- line_item_title,
        -- line_item_variant_id,
        -- line_item_variant_uid,
        -- line_item_vendor,
        -- line_item_variant_inventory_management,
        -- line_item_variant_title,
        -- location_id,
        -- name,
        -- note,
        -- number,
        -- order adjustment
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        -- order_number,
        -- order_status_url,
        -- payment_details_avs_result_code,
        -- payment_details_credit_card_company,
        payment_gateway_names,
        presentment_currency,
        -- processing_method,
        -- reference,
        referring_site,
        -- refunds
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        -- shipping address
        -- shipping_address_city,
        -- shipping_address_country,
        -- shipping_address_country_code,
        -- shipping_address_province,
        -- shipping_address_province_code,
        -- shipping_address_zip,
        -- shipping_line_code,
        -- billing_address_city,
        -- billing_address_zip,
        billing_address_country_code, -- billing address is relevant to see where the money goes to
        -- shipping
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,

        -- source_identifier,
        -- source_name,
        -- source_url,
        -- tags,

        -- tax
        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
        -- token,
        -- total_weight,
        -- user_id,
        -- record_timestamp
    FROM shopify
    -- we want to remove test orders
    WHERE test IS false
)

SELECT * FROM filter_source;


[0m16:58:14.144117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:14.618062 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:5bf0bf25-9823-4bc7-8459-88c0decd70b4&page=queryresults
[0m16:58:14.856661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7495e017-2fac-49fa-8bc4-fad2b4231c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed4fa40>]}
[0m16:58:14.858087 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dbt_transformations_new.stg_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 0.72s]
[0m16:58:14.859332 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.stg_shopify__orders
[0m16:58:14.859945 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.testing
[0m16:58:14.860491 [info ] [Thread-1 (]: 4 of 4 START sql view model dbt_transformations_new.testing .................... [RUN]
[0m16:58:14.860978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.stg_shopify__orders, now model.online_shop_dbt.testing)
[0m16:58:14.861321 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.testing
[0m16:58:14.863374 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.testing"
[0m16:58:14.865245 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.testing
[0m16:58:14.868368 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.testing"
[0m16:58:14.869233 [debug] [Thread-1 (]: On model.online_shop_dbt.testing: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.testing"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`testing`
  OPTIONS()
  as SELECT * FROM opensource-marketing-dwh.facebook_ads_dimensions.ad_sets;


[0m16:58:14.869790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:15.271892 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:3bb4cd3b-3d04-4d3b-91f4-a5aa37ce981f&page=queryresults
[0m16:58:15.589882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7495e017-2fac-49fa-8bc4-fad2b4231c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edbaa50>]}
[0m16:58:15.591242 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbt_transformations_new.testing ............... [[32mCREATE VIEW (0 processed)[0m in 0.73s]
[0m16:58:15.592284 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.testing
[0m16:58:15.594261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:58:15.597238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:15.597576 [debug] [MainThread]: Connection 'model.online_shop_dbt.testing' was properly closed.
[0m16:58:15.597963 [info ] [MainThread]: 
[0m16:58:15.598285 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m16:58:15.599696 [debug] [MainThread]: Command end result
[0m16:58:15.626982 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m16:58:15.628645 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m16:58:15.634167 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m16:58:15.634493 [info ] [MainThread]: 
[0m16:58:15.634818 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:58:15.635066 [info ] [MainThread]: 
[0m16:58:15.635325 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:58:15.637965 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.36084, "process_in_blocks": "0", "process_kernel_time": 0.24752, "process_mem_max_rss": "211238912", "process_out_blocks": "0", "process_user_time": 1.948686}
[0m16:58:15.638320 [debug] [MainThread]: Command `dbt run` succeeded at 16:58:15.638244 after 6.36 seconds
[0m16:58:15.638615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108468920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e832ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7ec920>]}
[0m16:58:15.638900 [debug] [MainThread]: Flushing usage events
[0m16:58:16.150272 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:24.318826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc08f0>]}


============================== 16:59:24.322306 | e7f9e50f-62d7-4895-93e5-b9a72d71bc3a ==============================
[0m16:59:24.322306 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:59:24.322639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:59:25.001871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7f9e50f-62d7-4895-93e5-b9a72d71bc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab744d0>]}
[0m16:59:25.036800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7f9e50f-62d7-4895-93e5-b9a72d71bc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10448b860>]}
[0m16:59:25.037150 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m16:59:25.127246 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:59:25.190807 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m16:59:25.192476 [debug] [MainThread]: Partial parsing: added file: online_shop_dbt://online_shop_dbt/models/staging/shopify/stg_shopify__orders.sql
[0m16:59:25.192686 [debug] [MainThread]: Partial parsing: added file: online_shop_dbt://online_shop_dbt/models/intermediate/shopify/int_shopify__orders.sql
[0m16:59:25.194678 [debug] [MainThread]: Partial parsing: deleted file: online_shop_dbt://online_shop_dbt/models/staging/stg_shopify__orders.sql
[0m16:59:25.380967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7f9e50f-62d7-4895-93e5-b9a72d71bc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b61f830>]}
[0m16:59:25.414046 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m16:59:25.416141 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m16:59:25.428503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7f9e50f-62d7-4895-93e5-b9a72d71bc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b04fd70>]}
[0m16:59:25.428767 [info ] [MainThread]: Found 5 models, 4 data tests, 489 macros
[0m16:59:25.428939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f9e50f-62d7-4895-93e5-b9a72d71bc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b399f70>]}
[0m16:59:25.429859 [info ] [MainThread]: 
[0m16:59:25.430025 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:25.430165 [info ] [MainThread]: 
[0m16:59:25.430399 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:59:25.432275 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m16:59:25.432475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:25.808223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now list_opensource-marketing-dwh_dbt_transformations_new)
[0m16:59:25.809178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:26.123946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f9e50f-62d7-4895-93e5-b9a72d71bc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103364410>]}
[0m16:59:26.125131 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:59:26.129543 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_first_dbt_model
[0m16:59:26.130407 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_transformations_new.my_first_dbt_model ........ [RUN]
[0m16:59:26.131023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now model.online_shop_dbt.my_first_dbt_model)
[0m16:59:26.131509 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_first_dbt_model
[0m16:59:26.142275 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_first_dbt_model"
[0m16:59:26.144380 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_first_dbt_model
[0m16:59:26.160501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:26.561032 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_first_dbt_model"
[0m16:59:26.562257 [debug] [Thread-1 (]: On model.online_shop_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_first_dbt_model"} */

  
    

    create or replace table `opensource-marketing-dwh`.`dbt_transformations_new`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:59:26.912705 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:e98e4b0b-025f-4e3d-9db0-dc98daaa0e12&page=queryresults
[0m16:59:28.738283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f9e50f-62d7-4895-93e5-b9a72d71bc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afa17f0>]}
[0m16:59:28.738792 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_transformations_new.my_first_dbt_model ... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.61s]
[0m16:59:28.739201 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_first_dbt_model
[0m16:59:28.739469 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_second_dbt_model
[0m16:59:28.739844 [info ] [Thread-1 (]: 2 of 4 START sql view model dbt_transformations_new.my_second_dbt_model ........ [RUN]
[0m16:59:28.740200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_first_dbt_model, now model.online_shop_dbt.my_second_dbt_model)
[0m16:59:28.740466 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_second_dbt_model
[0m16:59:28.741927 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_second_dbt_model"
[0m16:59:28.742351 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_second_dbt_model
[0m16:59:28.756849 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_second_dbt_model"
[0m16:59:28.757426 [debug] [Thread-1 (]: On model.online_shop_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_second_dbt_model"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `facebook_ads_dimensions.ads`;


[0m16:59:28.757679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:29.142883 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:5b2010b4-d0bb-420f-a29f-b221517a839e&page=queryresults
[0m16:59:29.467843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f9e50f-62d7-4895-93e5-b9a72d71bc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b88ae40>]}
[0m16:59:29.468673 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbt_transformations_new.my_second_dbt_model ... [[32mCREATE VIEW (0 processed)[0m in 0.73s]
[0m16:59:29.469268 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_second_dbt_model
[0m16:59:29.469821 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.stg_shopify__orders
[0m16:59:29.470378 [info ] [Thread-1 (]: 3 of 4 START sql view model dbt_transformations_new.stg_shopify__orders ........ [RUN]
[0m16:59:29.470823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_second_dbt_model, now model.online_shop_dbt.stg_shopify__orders)
[0m16:59:29.471178 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.stg_shopify__orders
[0m16:59:29.473800 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.stg_shopify__orders"
[0m16:59:29.475122 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.stg_shopify__orders
[0m16:59:29.478580 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.stg_shopify__orders"
[0m16:59:29.480346 [debug] [Thread-1 (]: On model.online_shop_dbt.stg_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.stg_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  OPTIONS()
  as WITH shopify AS (
    SELECT * FROM opensource-marketing-dwh.shopify.shopify_orders
),

-- removes columns that are not needed at the moment
filter_source AS (
    SELECT
        id AS order_id,
        customer_id,
        -- app_id,
        -- cancel_reason,
        -- totals
        total_discounts,
        total_line_items_price,
        total_price,
        -- total_price_usd,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
        -- total_tip_received,

        -- cart_token,
        -- checkout_id,
        -- checkout_token,
        -- timestamps
        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        -- client details
        -- client_details_accept_language,
        -- client_details_browser_height,
        -- client_details_browser_ip,
        -- client_details_browser_width,
        -- client_details_session_hash,
        -- client_details_user_agent,
        -- confirmed,
        -- currency,
        -- customer_accepts_marketing,
        -- customer_accepts_marketing_updated_at,
        -- customer_created_at,
        -- customer_uid,
        -- customer_locale,
        -- customer_multipass_identifier,
        -- customer_note,
        -- customer_state,
        -- customer_tags,
        -- customer_tax_exempt,
        -- customer_total_spent,
        -- customer_updated_at,
        -- device_id,
        -- discount application
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        -- financial_status,
        -- fulfillment_status,
        -- gateway,
        -- uid,
        landing_site,
        -- landing_site_ref,
        -- fulfillments_location_id,
        -- fulfillments_line_item_id,
        -- line items
        -- line_item_discount_allocations_amount,
        -- line_item_discount_allocations_application_index,
        -- line_item_fulfillable_quantity,
        -- line_item_fulfillment_service,
        -- line_item_fulfillment_status,
        -- line_item_gift_card,
        -- line_item_grams,
        -- line_item_id,
        -- line_item_uid,
        -- line_item_name,
        -- line_item_price,
        -- line_item_product_exists,
        -- line_item_product_id,
        -- line_item_product_uid,
        -- line_item_properties,
        -- line_item_quantity,
        -- line_item_requires_shipping,
        -- line_item_sku,
        -- line_item_tax_lines_price,
        -- line_item_tax_lines_rate,
        -- line_item_tax_lines_title,
        -- line_item_taxable,
        -- line_item_title,
        -- line_item_variant_id,
        -- line_item_variant_uid,
        -- line_item_vendor,
        -- line_item_variant_inventory_management,
        -- line_item_variant_title,
        -- location_id,
        -- name,
        -- note,
        -- number,
        -- order adjustment
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        -- order_number,
        -- order_status_url,
        -- payment_details_avs_result_code,
        -- payment_details_credit_card_company,
        payment_gateway_names,
        presentment_currency,
        -- processing_method,
        -- reference,
        referring_site,
        -- refunds
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        -- shipping address
        -- shipping_address_city,
        -- shipping_address_country,
        -- shipping_address_country_code,
        -- shipping_address_province,
        -- shipping_address_province_code,
        -- shipping_address_zip,
        -- shipping_line_code,
        -- billing_address_city,
        -- billing_address_zip,
        billing_address_country_code, -- billing address is relevant to see where the money goes to
        -- shipping
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,

        -- source_identifier,
        -- source_name,
        -- source_url,
        -- tags,

        -- tax
        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
        -- token,
        -- total_weight,
        -- user_id,
        -- record_timestamp
    FROM shopify
    -- we want to remove test orders
    WHERE test IS false
)

SELECT * FROM filter_source;


[0m16:59:29.481227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:29.984606 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:90da793a-3385-4a2b-8864-e9c16c8fd22a&page=queryresults
[0m16:59:30.234392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f9e50f-62d7-4895-93e5-b9a72d71bc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ece71d0>]}
[0m16:59:30.235492 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dbt_transformations_new.stg_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m16:59:30.236307 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.stg_shopify__orders
[0m16:59:30.236735 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.testing
[0m16:59:30.237209 [info ] [Thread-1 (]: 4 of 4 START sql view model dbt_transformations_new.testing .................... [RUN]
[0m16:59:30.237633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.stg_shopify__orders, now model.online_shop_dbt.testing)
[0m16:59:30.237986 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.testing
[0m16:59:30.240754 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.testing"
[0m16:59:30.242630 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.testing
[0m16:59:30.246663 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.testing"
[0m16:59:30.247602 [debug] [Thread-1 (]: On model.online_shop_dbt.testing: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.testing"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`testing`
  OPTIONS()
  as SELECT * FROM opensource-marketing-dwh.facebook_ads_dimensions.ad_sets;


[0m16:59:30.248070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:30.701570 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:50744923-f7d7-42bf-a61e-0190125459d5&page=queryresults
[0m16:59:30.913772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f9e50f-62d7-4895-93e5-b9a72d71bc3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b678410>]}
[0m16:59:30.915245 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbt_transformations_new.testing ............... [[32mCREATE VIEW (0 processed)[0m in 0.68s]
[0m16:59:30.916036 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.testing
[0m16:59:30.917369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:59:30.919840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:30.920265 [debug] [MainThread]: Connection 'model.online_shop_dbt.testing' was properly closed.
[0m16:59:30.920753 [info ] [MainThread]: 
[0m16:59:30.921267 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 5.49 seconds (5.49s).
[0m16:59:30.922516 [debug] [MainThread]: Command end result
[0m16:59:30.948218 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m16:59:30.949667 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m16:59:30.954653 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m16:59:30.954944 [info ] [MainThread]: 
[0m16:59:30.955248 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:30.955487 [info ] [MainThread]: 
[0m16:59:30.955835 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:59:30.958802 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.681301, "process_in_blocks": "0", "process_kernel_time": 0.287246, "process_mem_max_rss": "213680128", "process_out_blocks": "0", "process_user_time": 2.05706}
[0m16:59:30.959163 [debug] [MainThread]: Command `dbt run` succeeded at 16:59:30.959094 after 6.68 seconds
[0m16:59:30.959433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed93fb0>]}
[0m16:59:30.959696 [debug] [MainThread]: Flushing usage events
[0m16:59:31.395729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:20.671605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a7b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc4bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc4950>]}


============================== 17:06:20.674630 | 9caf5fc5-3b85-49c4-aec6-5ca691ec32ca ==============================
[0m17:06:20.674630 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:06:20.674974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:06:21.309033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9caf5fc5-3b85-49c4-aec6-5ca691ec32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adc0d10>]}
[0m17:06:21.343335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9caf5fc5-3b85-49c4-aec6-5ca691ec32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac89eb0>]}
[0m17:06:21.343675 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m17:06:21.430929 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:06:21.491481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:06:21.491703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:06:21.509424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9caf5fc5-3b85-49c4-aec6-5ca691ec32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aec5430>]}
[0m17:06:21.544284 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m17:06:21.546400 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m17:06:21.605375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9caf5fc5-3b85-49c4-aec6-5ca691ec32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b205370>]}
[0m17:06:21.605655 [info ] [MainThread]: Found 5 models, 10 data tests, 489 macros
[0m17:06:21.605826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9caf5fc5-3b85-49c4-aec6-5ca691ec32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b103260>]}
[0m17:06:21.606760 [info ] [MainThread]: 
[0m17:06:21.606930 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:06:21.607064 [info ] [MainThread]: 
[0m17:06:21.607295 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:06:21.609167 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m17:06:21.609370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:22.047908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now list_opensource-marketing-dwh_dbt_transformations_new)
[0m17:06:22.049109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:22.354112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9caf5fc5-3b85-49c4-aec6-5ca691ec32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030648c0>]}
[0m17:06:22.355508 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:22.359461 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_first_dbt_model
[0m17:06:22.360333 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_transformations_new.my_first_dbt_model ........ [RUN]
[0m17:06:22.360984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now model.online_shop_dbt.my_first_dbt_model)
[0m17:06:22.361499 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_first_dbt_model
[0m17:06:22.373089 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_first_dbt_model"
[0m17:06:22.374755 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_first_dbt_model
[0m17:06:22.391304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:22.743442 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_first_dbt_model"
[0m17:06:22.745439 [debug] [Thread-1 (]: On model.online_shop_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_first_dbt_model"} */

  
    

    create or replace table `opensource-marketing-dwh`.`dbt_transformations_new`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:06:23.068374 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:9677ba28-1adb-4ec1-8ae2-6b67606ed2e6&page=queryresults
[0m17:06:24.685455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9caf5fc5-3b85-49c4-aec6-5ca691ec32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041007d0>]}
[0m17:06:24.686348 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_transformations_new.my_first_dbt_model ... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.32s]
[0m17:06:24.687005 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_first_dbt_model
[0m17:06:24.687422 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.my_second_dbt_model
[0m17:06:24.687953 [info ] [Thread-1 (]: 2 of 4 START sql view model dbt_transformations_new.my_second_dbt_model ........ [RUN]
[0m17:06:24.688446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_first_dbt_model, now model.online_shop_dbt.my_second_dbt_model)
[0m17:06:24.688811 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.my_second_dbt_model
[0m17:06:24.690962 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.my_second_dbt_model"
[0m17:06:24.691687 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.my_second_dbt_model
[0m17:06:24.711679 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.my_second_dbt_model"
[0m17:06:24.712422 [debug] [Thread-1 (]: On model.online_shop_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.my_second_dbt_model"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `facebook_ads_dimensions.ads`;


[0m17:06:24.712753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:25.172205 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:d5147b67-c400-4c2b-90f9-04fff2cad2a1&page=queryresults
[0m17:06:25.479439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9caf5fc5-3b85-49c4-aec6-5ca691ec32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebdc3b0>]}
[0m17:06:25.481183 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbt_transformations_new.my_second_dbt_model ... [[32mCREATE VIEW (0 processed)[0m in 0.79s]
[0m17:06:25.482116 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.my_second_dbt_model
[0m17:06:25.482723 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.stg_shopify__orders
[0m17:06:25.483434 [info ] [Thread-1 (]: 3 of 4 START sql view model dbt_transformations_new.stg_shopify__orders ........ [RUN]
[0m17:06:25.484153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.my_second_dbt_model, now model.online_shop_dbt.stg_shopify__orders)
[0m17:06:25.484664 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.stg_shopify__orders
[0m17:06:25.487845 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.stg_shopify__orders"
[0m17:06:25.489139 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.stg_shopify__orders
[0m17:06:25.492254 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.stg_shopify__orders"
[0m17:06:25.493747 [debug] [Thread-1 (]: On model.online_shop_dbt.stg_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.stg_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  OPTIONS()
  as WITH shopify AS (
    SELECT * FROM opensource-marketing-dwh.shopify.shopify_orders
),

-- removes columns that are not needed at the moment
filter_source AS (
    SELECT
        id AS order_id,
        customer_id,
        -- app_id,
        -- cancel_reason,
        -- totals
        total_discounts,
        total_line_items_price,
        total_price,
        -- total_price_usd,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
        -- total_tip_received,

        -- cart_token,
        -- checkout_id,
        -- checkout_token,
        -- timestamps
        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        -- client details
        -- client_details_accept_language,
        -- client_details_browser_height,
        -- client_details_browser_ip,
        -- client_details_browser_width,
        -- client_details_session_hash,
        -- client_details_user_agent,
        -- confirmed,
        -- currency,
        -- customer_accepts_marketing,
        -- customer_accepts_marketing_updated_at,
        -- customer_created_at,
        -- customer_uid,
        -- customer_locale,
        -- customer_multipass_identifier,
        -- customer_note,
        -- customer_state,
        -- customer_tags,
        -- customer_tax_exempt,
        -- customer_total_spent,
        -- customer_updated_at,
        -- device_id,
        -- discount application
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        -- financial_status,
        -- fulfillment_status,
        -- gateway,
        -- uid,
        landing_site,
        -- landing_site_ref,
        -- fulfillments_location_id,
        -- fulfillments_line_item_id,
        -- line items
        -- line_item_discount_allocations_amount,
        -- line_item_discount_allocations_application_index,
        -- line_item_fulfillable_quantity,
        -- line_item_fulfillment_service,
        -- line_item_fulfillment_status,
        -- line_item_gift_card,
        -- line_item_grams,
        -- line_item_id,
        -- line_item_uid,
        -- line_item_name,
        -- line_item_price,
        -- line_item_product_exists,
        -- line_item_product_id,
        -- line_item_product_uid,
        -- line_item_properties,
        -- line_item_quantity,
        -- line_item_requires_shipping,
        -- line_item_sku,
        -- line_item_tax_lines_price,
        -- line_item_tax_lines_rate,
        -- line_item_tax_lines_title,
        -- line_item_taxable,
        -- line_item_title,
        -- line_item_variant_id,
        -- line_item_variant_uid,
        -- line_item_vendor,
        -- line_item_variant_inventory_management,
        -- line_item_variant_title,
        -- location_id,
        -- name,
        -- note,
        -- number,
        -- order adjustment
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        -- order_number,
        -- order_status_url,
        -- payment_details_avs_result_code,
        -- payment_details_credit_card_company,
        payment_gateway_names,
        presentment_currency,
        -- processing_method,
        -- reference,
        referring_site,
        -- refunds
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        -- shipping address
        -- shipping_address_city,
        -- shipping_address_country,
        -- shipping_address_country_code,
        -- shipping_address_province,
        -- shipping_address_province_code,
        -- shipping_address_zip,
        -- shipping_line_code,
        -- billing_address_city,
        -- billing_address_zip,
        billing_address_country_code, -- billing address is relevant to see where the money goes to
        -- shipping
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,

        -- source_identifier,
        -- source_name,
        -- source_url,
        -- tags,

        -- tax
        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
        -- token,
        -- total_weight,
        -- user_id,
        -- record_timestamp
    FROM shopify
    -- we want to remove test orders
    WHERE test IS false
)

SELECT * FROM filter_source;


[0m17:06:25.494699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:25.933252 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:70c09822-5250-460b-9b2e-da382a97631f&page=queryresults
[0m17:06:26.143487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9caf5fc5-3b85-49c4-aec6-5ca691ec32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebd3320>]}
[0m17:06:26.144355 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dbt_transformations_new.stg_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 0.66s]
[0m17:06:26.144969 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.stg_shopify__orders
[0m17:06:26.145358 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.testing
[0m17:06:26.145867 [info ] [Thread-1 (]: 4 of 4 START sql view model dbt_transformations_new.testing .................... [RUN]
[0m17:06:26.146375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.stg_shopify__orders, now model.online_shop_dbt.testing)
[0m17:06:26.146853 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.testing
[0m17:06:26.149448 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.testing"
[0m17:06:26.150378 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.testing
[0m17:06:26.154460 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.testing"
[0m17:06:26.155280 [debug] [Thread-1 (]: On model.online_shop_dbt.testing: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.testing"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`testing`
  OPTIONS()
  as SELECT * FROM opensource-marketing-dwh.facebook_ads_dimensions.ad_sets;


[0m17:06:26.155665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:26.733421 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:49e32635-9f45-47b8-a6dd-8f809fd84b85&page=queryresults
[0m17:06:27.021219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9caf5fc5-3b85-49c4-aec6-5ca691ec32ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec83170>]}
[0m17:06:27.022573 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbt_transformations_new.testing ............... [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m17:06:27.023280 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.testing
[0m17:06:27.024402 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:06:27.026525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:27.026855 [debug] [MainThread]: Connection 'model.online_shop_dbt.testing' was properly closed.
[0m17:06:27.027222 [info ] [MainThread]: 
[0m17:06:27.027532 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 5.42 seconds (5.42s).
[0m17:06:27.028817 [debug] [MainThread]: Command end result
[0m17:06:27.058559 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m17:06:27.060077 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m17:06:27.065196 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m17:06:27.065494 [info ] [MainThread]: 
[0m17:06:27.065809 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:27.066028 [info ] [MainThread]: 
[0m17:06:27.066268 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:06:27.068774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4396286, "process_in_blocks": "0", "process_kernel_time": 0.263318, "process_mem_max_rss": "210731008", "process_out_blocks": "0", "process_user_time": 1.957072}
[0m17:06:27.069082 [debug] [MainThread]: Command `dbt run` succeeded at 17:06:27.069018 after 6.44 seconds
[0m17:06:27.069345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b22a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec7f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec7ecf0>]}
[0m17:06:27.069600 [debug] [MainThread]: Flushing usage events
[0m17:06:27.559762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:58.263421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e76f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e58da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e58b00>]}


============================== 17:06:58.266759 | 2b1f08c1-a963-49f4-8c1c-dad6317a321f ==============================
[0m17:06:58.266759 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:06:58.267097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:58.947931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b1f08c1-a963-49f4-8c1c-dad6317a321f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c26faa0>]}
[0m17:06:58.982440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b1f08c1-a963-49f4-8c1c-dad6317a321f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104268620>]}
[0m17:06:58.982787 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m17:06:59.074043 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:06:59.137390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:06:59.137625 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:06:59.155275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b1f08c1-a963-49f4-8c1c-dad6317a321f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c59d280>]}
[0m17:06:59.191890 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m17:06:59.193752 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m17:06:59.257069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b1f08c1-a963-49f4-8c1c-dad6317a321f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3fb800>]}
[0m17:06:59.257358 [info ] [MainThread]: Found 5 models, 10 data tests, 489 macros
[0m17:06:59.257531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b1f08c1-a963-49f4-8c1c-dad6317a321f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c59da00>]}
[0m17:06:59.258536 [info ] [MainThread]: 
[0m17:06:59.258699 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:06:59.258830 [info ] [MainThread]: 
[0m17:06:59.259064 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:06:59.261057 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh_dbt_transformations_new'
[0m17:06:59.261242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:59.568424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b1f08c1-a963-49f4-8c1c-dad6317a321f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c422540>]}
[0m17:06:59.569276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:59.573702 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:06:59.574192 [info ] [Thread-1 (]: 1 of 10 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m17:06:59.574645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now test.online_shop_dbt.not_null_my_first_dbt_model_id.5fb22c2710)
[0m17:06:59.575003 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:06:59.596003 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:06:59.596945 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:06:59.616109 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:06:59.616947 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `opensource-marketing-dwh`.`dbt_transformations_new`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m17:06:59.617291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:00.237073 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:de8653a5-6116-4b45-b0da-c03a2fcf4867&page=queryresults
[0m17:07:00.714125 [error] [Thread-1 (]: 1 of 10 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 1.14s]
[0m17:07:00.714747 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:07:00.715056 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m17:07:00.715391 [info ] [Thread-1 (]: 2 of 10 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m17:07:00.715791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.online_shop_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m17:07:00.716058 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m17:07:00.719250 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m17:07:00.719807 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m17:07:00.721652 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m17:07:00.722257 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `opensource-marketing-dwh`.`dbt_transformations_new`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m17:07:00.722553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:01.567372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:e681010a-db4a-4aba-afe6-04cfce80df89&page=queryresults
[0m17:07:02.004210 [info ] [Thread-1 (]: 2 of 10 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 1.29s]
[0m17:07:02.005855 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m17:07:02.006600 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4
[0m17:07:02.007700 [info ] [Thread-1 (]: 3 of 10 START test not_null_stg_shopify__orders_customer_id_ ................... [RUN]
[0m17:07:02.008703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4)
[0m17:07:02.009242 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4
[0m17:07:02.014709 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4"
[0m17:07:02.015841 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4
[0m17:07:02.019088 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4"
[0m17:07:02.020044 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id,
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where customer_id, is null



      
    ) dbt_internal_test
[0m17:07:02.020454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:02.320911 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:75eaa5ac-1d95-4135-bc95-895d5fdc8566&page=queryresults
[0m17:07:02.321680 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:75eaa5ac-1d95-4135-bc95-895d5fdc8566&page=queryresults
[0m17:07:02.331399 [debug] [Thread-1 (]: Database Error in test not_null_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:18]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_customer_id_.sql
[0m17:07:02.332075 [error] [Thread-1 (]: 3 of 10 ERROR not_null_stg_shopify__orders_customer_id_ ........................ [[31mERROR[0m in 0.32s]
[0m17:07:02.332654 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4
[0m17:07:02.333026 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca
[0m17:07:02.333530 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:18]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_customer_id_.sql.
[0m17:07:02.333945 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_shopify__orders_id ............................. [RUN]
[0m17:07:02.336407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4, now test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca)
[0m17:07:02.337191 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca
[0m17:07:02.342267 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca"
[0m17:07:02.343082 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca
[0m17:07:02.347606 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca"
[0m17:07:02.348461 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where id is null



      
    ) dbt_internal_test
[0m17:07:02.348874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:03.103110 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:ab671ed2-cb47-4722-b779-69a5112c545f&page=queryresults
[0m17:07:03.104340 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:ab671ed2-cb47-4722-b779-69a5112c545f&page=queryresults
[0m17:07:03.108743 [debug] [Thread-1 (]: Database Error in test not_null_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:7]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_id.sql
[0m17:07:03.109534 [error] [Thread-1 (]: 4 of 10 ERROR not_null_stg_shopify__orders_id .................................. [[31mERROR[0m in 0.77s]
[0m17:07:03.110444 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca
[0m17:07:03.111106 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7
[0m17:07:03.111727 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:7]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_id.sql.
[0m17:07:03.112258 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_shopify__orders_order_id_ ...................... [RUN]
[0m17:07:03.113150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca, now test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7)
[0m17:07:03.113664 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7
[0m17:07:03.118591 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7"
[0m17:07:03.119569 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7
[0m17:07:03.122400 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7"
[0m17:07:03.123261 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id,
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where order_id, is null



      
    ) dbt_internal_test
[0m17:07:03.123718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:03.616001 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:2ba4c844-127c-4e99-b883-4a3e0679125a&page=queryresults
[0m17:07:03.617299 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:2ba4c844-127c-4e99-b883-4a3e0679125a&page=queryresults
[0m17:07:03.623511 [debug] [Thread-1 (]: Database Error in test not_null_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:15]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_order_id_.sql
[0m17:07:03.624700 [error] [Thread-1 (]: 5 of 10 ERROR not_null_stg_shopify__orders_order_id_ ........................... [[31mERROR[0m in 0.51s]
[0m17:07:03.625701 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7
[0m17:07:03.626114 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.unique_my_first_dbt_model_id.16e066b321
[0m17:07:03.626604 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:15]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_order_id_.sql.
[0m17:07:03.627037 [info ] [Thread-1 (]: 6 of 10 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m17:07:03.627865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7, now test.online_shop_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m17:07:03.628473 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.unique_my_first_dbt_model_id.16e066b321
[0m17:07:03.637124 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m17:07:03.637781 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.unique_my_first_dbt_model_id.16e066b321
[0m17:07:03.639940 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m17:07:03.640731 [debug] [Thread-1 (]: On test.online_shop_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `opensource-marketing-dwh`.`dbt_transformations_new`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:07:03.641145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:04.265437 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:02d37547-fdb0-444d-8a95-640a645b3590&page=queryresults
[0m17:07:04.636734 [info ] [Thread-1 (]: 6 of 10 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.01s]
[0m17:07:04.638646 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.unique_my_first_dbt_model_id.16e066b321
[0m17:07:04.639474 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m17:07:04.640163 [info ] [Thread-1 (]: 7 of 10 START test unique_my_second_dbt_model_id ............................... [RUN]
[0m17:07:04.640965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.unique_my_first_dbt_model_id.16e066b321, now test.online_shop_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m17:07:04.641503 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m17:07:04.647690 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:07:04.648579 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m17:07:04.652324 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:07:04.653140 [debug] [Thread-1 (]: On test.online_shop_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `opensource-marketing-dwh`.`dbt_transformations_new`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:07:04.653423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:05.562757 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:14cfdbe9-9793-44b9-bd52-3956045a4c34&page=queryresults
[0m17:07:05.991868 [info ] [Thread-1 (]: 7 of 10 PASS unique_my_second_dbt_model_id ..................................... [[32mPASS[0m in 1.35s]
[0m17:07:05.992656 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m17:07:05.993082 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7
[0m17:07:05.993599 [info ] [Thread-1 (]: 8 of 10 START test unique_stg_shopify__orders_customer_id_ ..................... [RUN]
[0m17:07:05.994155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.unique_my_second_dbt_model_id.57a0f8c493, now test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7)
[0m17:07:05.994547 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7
[0m17:07:05.999738 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7"
[0m17:07:06.000555 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7
[0m17:07:06.003702 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7"
[0m17:07:06.004702 [debug] [Thread-1 (]: On test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id, as unique_field
  from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  where customer_id, is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:07:06.005346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:06.302887 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:bb5d62ee-4e6c-4b8e-b2c2-d3c8208feae6&page=queryresults
[0m17:07:06.304569 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:bb5d62ee-4e6c-4b8e-b2c2-d3c8208feae6&page=queryresults
[0m17:07:06.309788 [debug] [Thread-1 (]: Database Error in test unique_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:23]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_customer_id_.sql
[0m17:07:06.310505 [error] [Thread-1 (]: 8 of 10 ERROR unique_stg_shopify__orders_customer_id_ .......................... [[31mERROR[0m in 0.32s]
[0m17:07:06.311139 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7
[0m17:07:06.311539 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f
[0m17:07:06.312060 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:23]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_customer_id_.sql.
[0m17:07:06.312460 [info ] [Thread-1 (]: 9 of 10 START test unique_stg_shopify__orders_id ............................... [RUN]
[0m17:07:06.313094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7, now test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f)
[0m17:07:06.313509 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f
[0m17:07:06.319250 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f"
[0m17:07:06.320074 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f
[0m17:07:06.324817 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f"
[0m17:07:06.325682 [debug] [Thread-1 (]: On test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:07:06.326134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:07.099759 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:5e64ed4f-0d59-4e0f-bc54-7b1e1baabf93&page=queryresults
[0m17:07:07.101135 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:5e64ed4f-0d59-4e0f-bc54-7b1e1baabf93&page=queryresults
[0m17:07:07.107638 [debug] [Thread-1 (]: Database Error in test unique_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:9]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_id.sql
[0m17:07:07.108760 [error] [Thread-1 (]: 9 of 10 ERROR unique_stg_shopify__orders_id .................................... [[31mERROR[0m in 0.80s]
[0m17:07:07.109727 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f
[0m17:07:07.110316 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6
[0m17:07:07.110939 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:9]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_id.sql.
[0m17:07:07.111464 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_shopify__orders_order_id_ ....................... [RUN]
[0m17:07:07.112272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f, now test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6)
[0m17:07:07.112879 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6
[0m17:07:07.119164 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6"
[0m17:07:07.120084 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6
[0m17:07:07.122515 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6"
[0m17:07:07.123175 [debug] [Thread-1 (]: On test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id, as unique_field
  from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  where order_id, is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:07:07.123737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:07.439039 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:33e9b7d8-4fe9-4689-b2c7-b12670cc2726&page=queryresults
[0m17:07:07.439634 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:33e9b7d8-4fe9-4689-b2c7-b12670cc2726&page=queryresults
[0m17:07:07.443041 [debug] [Thread-1 (]: Database Error in test unique_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:20]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_order_id_.sql
[0m17:07:07.443503 [error] [Thread-1 (]: 10 of 10 ERROR unique_stg_shopify__orders_order_id_ ............................ [[31mERROR[0m in 0.33s]
[0m17:07:07.443954 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6
[0m17:07:07.444335 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:20]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_order_id_.sql.
[0m17:07:07.445332 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:07:07.446921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:07.447215 [debug] [MainThread]: Connection 'test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6' was properly closed.
[0m17:07:07.447486 [info ] [MainThread]: 
[0m17:07:07.447745 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 8.19 seconds (8.19s).
[0m17:07:07.449233 [debug] [MainThread]: Command end result
[0m17:07:07.470194 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m17:07:07.471828 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m17:07:07.477036 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m17:07:07.477290 [info ] [MainThread]: 
[0m17:07:07.477510 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m17:07:07.477694 [info ] [MainThread]: 
[0m17:07:07.477917 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (online_shop_dbt/models/example/schema.yml)[0m
[0m17:07:07.478122 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:07:07.478272 [info ] [MainThread]: 
[0m17:07:07.478458 [info ] [MainThread]:   compiled code at target/compiled/online_shop_dbt/online_shop_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m17:07:07.478618 [info ] [MainThread]: 
[0m17:07:07.478800 [error] [MainThread]:   Database Error in test not_null_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:18]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_customer_id_.sql
[0m17:07:07.478946 [info ] [MainThread]: 
[0m17:07:07.479114 [error] [MainThread]:   Database Error in test not_null_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:7]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_id.sql
[0m17:07:07.479256 [info ] [MainThread]: 
[0m17:07:07.479425 [error] [MainThread]:   Database Error in test not_null_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:15]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_order_id_.sql
[0m17:07:07.479651 [info ] [MainThread]: 
[0m17:07:07.479880 [error] [MainThread]:   Database Error in test unique_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:23]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_customer_id_.sql
[0m17:07:07.480052 [info ] [MainThread]: 
[0m17:07:07.480238 [error] [MainThread]:   Database Error in test unique_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:9]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_id.sql
[0m17:07:07.480393 [info ] [MainThread]: 
[0m17:07:07.480575 [error] [MainThread]:   Database Error in test unique_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:20]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_order_id_.sql
[0m17:07:07.480729 [info ] [MainThread]: 
[0m17:07:07.480889 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=7 SKIP=0 TOTAL=10
[0m17:07:07.482605 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 9.263897, "process_in_blocks": "0", "process_kernel_time": 0.267343, "process_mem_max_rss": "214908928", "process_out_blocks": "0", "process_user_time": 2.325906}
[0m17:07:07.482887 [debug] [MainThread]: Command `dbt test` failed at 17:07:07.482795 after 9.26 seconds
[0m17:07:07.483174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c57e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e58c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e58b00>]}
[0m17:07:07.483397 [debug] [MainThread]: Flushing usage events
[0m17:07:07.916148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:31.927071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d37c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108244c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082449b0>]}


============================== 17:08:31.930555 | 92c50d6c-d6f3-4d12-bc46-8a01dd858826 ==============================
[0m17:08:31.930555 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:08:31.930892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:08:32.639726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92c50d6c-d6f3-4d12-bc46-8a01dd858826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b3350>]}
[0m17:08:32.689214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92c50d6c-d6f3-4d12-bc46-8a01dd858826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0ada60>]}
[0m17:08:32.689724 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m17:08:32.844658 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:08:32.931604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:08:32.931873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:08:32.934671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.online_shop_dbt.example
[0m17:08:32.951678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92c50d6c-d6f3-4d12-bc46-8a01dd858826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e386f30>]}
[0m17:08:32.986585 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m17:08:32.988784 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m17:08:33.052871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92c50d6c-d6f3-4d12-bc46-8a01dd858826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2f9ee0>]}
[0m17:08:33.053165 [info ] [MainThread]: Found 2 models, 6 data tests, 489 macros
[0m17:08:33.053393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92c50d6c-d6f3-4d12-bc46-8a01dd858826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e384bf0>]}
[0m17:08:33.054336 [info ] [MainThread]: 
[0m17:08:33.054515 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:08:33.054654 [info ] [MainThread]: 
[0m17:08:33.054898 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:08:33.056775 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh_dbt_transformations_new'
[0m17:08:33.056968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:33.379336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92c50d6c-d6f3-4d12-bc46-8a01dd858826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e469e50>]}
[0m17:08:33.379676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:33.381152 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4
[0m17:08:33.381396 [info ] [Thread-1 (]: 1 of 6 START test not_null_stg_shopify__orders_customer_id_ .................... [RUN]
[0m17:08:33.381650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4)
[0m17:08:33.381838 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4
[0m17:08:33.391924 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4"
[0m17:08:33.392462 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4
[0m17:08:33.402620 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4"
[0m17:08:33.403258 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id,
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where customer_id, is null



      
    ) dbt_internal_test
[0m17:08:33.403510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:33.718300 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:183ee696-f5ad-4a31-8719-65fdfda54864&page=queryresults
[0m17:08:33.719821 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:183ee696-f5ad-4a31-8719-65fdfda54864&page=queryresults
[0m17:08:33.730960 [debug] [Thread-1 (]: Database Error in test not_null_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:18]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_customer_id_.sql
[0m17:08:33.731692 [error] [Thread-1 (]: 1 of 6 ERROR not_null_stg_shopify__orders_customer_id_ ......................... [[31mERROR[0m in 0.35s]
[0m17:08:33.732273 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4
[0m17:08:33.732671 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca
[0m17:08:33.733189 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:18]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_customer_id_.sql.
[0m17:08:33.733655 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_shopify__orders_id .............................. [RUN]
[0m17:08:33.734864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4, now test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca)
[0m17:08:33.735234 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca
[0m17:08:33.740089 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca"
[0m17:08:33.740765 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca
[0m17:08:33.745536 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca"
[0m17:08:33.746230 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where id is null



      
    ) dbt_internal_test
[0m17:08:33.746539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:34.352568 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:f4bcf3e6-2c55-4f31-8fb6-44db9c964867&page=queryresults
[0m17:08:34.353046 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:f4bcf3e6-2c55-4f31-8fb6-44db9c964867&page=queryresults
[0m17:08:34.355959 [debug] [Thread-1 (]: Database Error in test not_null_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:7]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_id.sql
[0m17:08:34.356428 [error] [Thread-1 (]: 2 of 6 ERROR not_null_stg_shopify__orders_id ................................... [[31mERROR[0m in 0.62s]
[0m17:08:34.356848 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca
[0m17:08:34.357137 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7
[0m17:08:34.357525 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:7]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_id.sql.
[0m17:08:34.357852 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_shopify__orders_order_id_ ....................... [RUN]
[0m17:08:34.358277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca, now test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7)
[0m17:08:34.358548 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7
[0m17:08:34.362119 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7"
[0m17:08:34.362714 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7
[0m17:08:34.364342 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7"
[0m17:08:34.364791 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id,
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where order_id, is null



      
    ) dbt_internal_test
[0m17:08:34.365072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:34.635254 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:bd6c8fd5-07c2-4314-b742-430a95b1f2a9&page=queryresults
[0m17:08:34.635884 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:bd6c8fd5-07c2-4314-b742-430a95b1f2a9&page=queryresults
[0m17:08:34.639459 [debug] [Thread-1 (]: Database Error in test not_null_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:15]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_order_id_.sql
[0m17:08:34.640098 [error] [Thread-1 (]: 3 of 6 ERROR not_null_stg_shopify__orders_order_id_ ............................ [[31mERROR[0m in 0.28s]
[0m17:08:34.640680 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7
[0m17:08:34.641065 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7
[0m17:08:34.641501 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:15]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_order_id_.sql.
[0m17:08:34.641978 [info ] [Thread-1 (]: 4 of 6 START test unique_stg_shopify__orders_customer_id_ ...................... [RUN]
[0m17:08:34.642695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7, now test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7)
[0m17:08:34.643123 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7
[0m17:08:34.650957 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7"
[0m17:08:34.651711 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7
[0m17:08:34.654005 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7"
[0m17:08:34.654616 [debug] [Thread-1 (]: On test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id, as unique_field
  from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  where customer_id, is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:08:34.654972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:34.946249 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:ee4d127f-620f-4b1b-b788-a6bff38b82da&page=queryresults
[0m17:08:34.947843 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:ee4d127f-620f-4b1b-b788-a6bff38b82da&page=queryresults
[0m17:08:34.953745 [debug] [Thread-1 (]: Database Error in test unique_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:23]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_customer_id_.sql
[0m17:08:34.954693 [error] [Thread-1 (]: 4 of 6 ERROR unique_stg_shopify__orders_customer_id_ ........................... [[31mERROR[0m in 0.31s]
[0m17:08:34.955664 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7
[0m17:08:34.956282 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f
[0m17:08:34.956903 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:23]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_customer_id_.sql.
[0m17:08:34.957392 [info ] [Thread-1 (]: 5 of 6 START test unique_stg_shopify__orders_id ................................ [RUN]
[0m17:08:34.958205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.unique_stg_shopify__orders_customer_id_.3495f8aaf7, now test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f)
[0m17:08:34.958795 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f
[0m17:08:34.964153 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f"
[0m17:08:34.965063 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f
[0m17:08:34.967546 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f"
[0m17:08:34.968177 [debug] [Thread-1 (]: On test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:08:34.968580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:35.674114 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:55039d72-124e-4d22-b80e-48d66dc2af12&page=queryresults
[0m17:08:35.677172 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:55039d72-124e-4d22-b80e-48d66dc2af12&page=queryresults
[0m17:08:35.681493 [debug] [Thread-1 (]: Database Error in test unique_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:9]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_id.sql
[0m17:08:35.682095 [error] [Thread-1 (]: 5 of 6 ERROR unique_stg_shopify__orders_id ..................................... [[31mERROR[0m in 0.72s]
[0m17:08:35.682751 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f
[0m17:08:35.683175 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6
[0m17:08:35.683712 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:9]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_id.sql.
[0m17:08:35.684289 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_shopify__orders_order_id_ ......................... [RUN]
[0m17:08:35.684909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f, now test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6)
[0m17:08:35.685264 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6
[0m17:08:35.691528 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6"
[0m17:08:35.692515 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6
[0m17:08:35.695433 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6"
[0m17:08:35.696230 [debug] [Thread-1 (]: On test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id, as unique_field
  from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  where order_id, is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:08:35.696657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:35.982975 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:e69eb0eb-b4a8-4fae-a0cc-4c00b097eb44&page=queryresults
[0m17:08:35.984100 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:e69eb0eb-b4a8-4fae-a0cc-4c00b097eb44&page=queryresults
[0m17:08:35.990926 [debug] [Thread-1 (]: Database Error in test unique_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:20]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_order_id_.sql
[0m17:08:35.992220 [error] [Thread-1 (]: 6 of 6 ERROR unique_stg_shopify__orders_order_id_ .............................. [[31mERROR[0m in 0.31s]
[0m17:08:35.992809 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6
[0m17:08:35.993262 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:20]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_order_id_.sql.
[0m17:08:35.994613 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:08:35.997213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:35.997686 [debug] [MainThread]: Connection 'test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6' was properly closed.
[0m17:08:35.998650 [info ] [MainThread]: 
[0m17:08:35.999199 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m17:08:36.000589 [debug] [MainThread]: Command end result
[0m17:08:36.027373 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m17:08:36.028967 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m17:08:36.035283 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m17:08:36.035558 [info ] [MainThread]: 
[0m17:08:36.035857 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m17:08:36.036084 [info ] [MainThread]: 
[0m17:08:36.036366 [error] [MainThread]:   Database Error in test not_null_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:18]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_customer_id_.sql
[0m17:08:36.036670 [info ] [MainThread]: 
[0m17:08:36.037067 [error] [MainThread]:   Database Error in test not_null_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:7]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_id.sql
[0m17:08:36.037520 [info ] [MainThread]: 
[0m17:08:36.037941 [error] [MainThread]:   Database Error in test not_null_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:15]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_order_id_.sql
[0m17:08:36.038181 [info ] [MainThread]: 
[0m17:08:36.038447 [error] [MainThread]:   Database Error in test unique_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:23]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_customer_id_.sql
[0m17:08:36.038755 [info ] [MainThread]: 
[0m17:08:36.038994 [error] [MainThread]:   Database Error in test unique_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:9]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_id.sql
[0m17:08:36.039187 [info ] [MainThread]: 
[0m17:08:36.039413 [error] [MainThread]:   Database Error in test unique_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:20]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_order_id_.sql
[0m17:08:36.039598 [info ] [MainThread]: 
[0m17:08:36.039797 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m17:08:36.042973 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.162539, "process_in_blocks": "0", "process_kernel_time": 0.283827, "process_mem_max_rss": "208814080", "process_out_blocks": "0", "process_user_time": 1.951711}
[0m17:08:36.043332 [debug] [MainThread]: Command `dbt test` failed at 17:08:36.043266 after 4.16 seconds
[0m17:08:36.043619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108244c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082449b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108244c50>]}
[0m17:08:36.043895 [debug] [MainThread]: Flushing usage events
[0m17:08:36.518068 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:49.752100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045bc2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e8cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e8a10>]}


============================== 17:09:49.755341 | cbc41114-97cd-4dc5-b95a-f8f17f62668f ==============================
[0m17:09:49.755341 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:09:49.755664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m17:09:50.472507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbc41114-97cd-4dc5-b95a-f8f17f62668f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d7380>]}
[0m17:09:50.509324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbc41114-97cd-4dc5-b95a-f8f17f62668f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c510500>]}
[0m17:09:50.509784 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m17:09:50.602458 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:09:50.660988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:50.661235 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:50.663932 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.online_shop_dbt.example
[0m17:09:50.680336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbc41114-97cd-4dc5-b95a-f8f17f62668f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6c0950>]}
[0m17:09:50.717330 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m17:09:50.719680 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m17:09:50.784441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbc41114-97cd-4dc5-b95a-f8f17f62668f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c59ef60>]}
[0m17:09:50.784749 [info ] [MainThread]: Found 2 models, 5 data tests, 489 macros
[0m17:09:50.784978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbc41114-97cd-4dc5-b95a-f8f17f62668f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6f2930>]}
[0m17:09:50.786184 [info ] [MainThread]: 
[0m17:09:50.786435 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:50.786584 [info ] [MainThread]: 
[0m17:09:50.786837 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:09:50.788766 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh_dbt_transformations_new'
[0m17:09:50.788971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:51.098448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbc41114-97cd-4dc5-b95a-f8f17f62668f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c605610>]}
[0m17:09:51.098957 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:51.101380 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4
[0m17:09:51.101842 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_shopify__orders_customer_id_ .................... [RUN]
[0m17:09:51.102252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4)
[0m17:09:51.102603 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4
[0m17:09:51.117797 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4"
[0m17:09:51.119494 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4
[0m17:09:51.132739 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4"
[0m17:09:51.133333 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id,
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where customer_id, is null



      
    ) dbt_internal_test
[0m17:09:51.133590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:51.432505 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:de4d6042-603c-44ce-9d10-dfe84e00a3a4&page=queryresults
[0m17:09:51.433072 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:de4d6042-603c-44ce-9d10-dfe84e00a3a4&page=queryresults
[0m17:09:51.441644 [debug] [Thread-1 (]: Database Error in test not_null_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:18]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_customer_id_.sql
[0m17:09:51.442166 [error] [Thread-1 (]: 1 of 5 ERROR not_null_stg_shopify__orders_customer_id_ ......................... [[31mERROR[0m in 0.34s]
[0m17:09:51.442617 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4
[0m17:09:51.442919 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca
[0m17:09:51.443285 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:18]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_customer_id_.sql.
[0m17:09:51.443593 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_shopify__orders_id .............................. [RUN]
[0m17:09:51.444537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4, now test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca)
[0m17:09:51.444882 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca
[0m17:09:51.449105 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca"
[0m17:09:51.449816 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca
[0m17:09:51.452715 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca"
[0m17:09:51.453221 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where id is null



      
    ) dbt_internal_test
[0m17:09:51.453511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:52.165089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:0d9821a7-7567-43d5-b364-d23364d162ff&page=queryresults
[0m17:09:52.166397 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:0d9821a7-7567-43d5-b364-d23364d162ff&page=queryresults
[0m17:09:52.171743 [debug] [Thread-1 (]: Database Error in test not_null_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:7]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_id.sql
[0m17:09:52.172807 [error] [Thread-1 (]: 2 of 5 ERROR not_null_stg_shopify__orders_id ................................... [[31mERROR[0m in 0.73s]
[0m17:09:52.173661 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca
[0m17:09:52.174223 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7
[0m17:09:52.174913 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:7]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_id.sql.
[0m17:09:52.175408 [info ] [Thread-1 (]: 3 of 5 START test not_null_stg_shopify__orders_order_id_ ....................... [RUN]
[0m17:09:52.175950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_id.83766850ca, now test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7)
[0m17:09:52.176287 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7
[0m17:09:52.182473 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7"
[0m17:09:52.183383 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7
[0m17:09:52.186284 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7"
[0m17:09:52.187192 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id,
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where order_id, is null



      
    ) dbt_internal_test
[0m17:09:52.187677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:52.488615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:2e72b2b9-a05a-436a-aa08-d904a6fe3a39&page=queryresults
[0m17:09:52.490290 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:2e72b2b9-a05a-436a-aa08-d904a6fe3a39&page=queryresults
[0m17:09:52.495946 [debug] [Thread-1 (]: Database Error in test not_null_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:15]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_order_id_.sql
[0m17:09:52.497098 [error] [Thread-1 (]: 3 of 5 ERROR not_null_stg_shopify__orders_order_id_ ............................ [[31mERROR[0m in 0.32s]
[0m17:09:52.497982 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7
[0m17:09:52.498709 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f
[0m17:09:52.499422 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:15]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_order_id_.sql.
[0m17:09:52.499993 [info ] [Thread-1 (]: 4 of 5 START test unique_stg_shopify__orders_id ................................ [RUN]
[0m17:09:52.500713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7, now test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f)
[0m17:09:52.501066 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f
[0m17:09:52.510497 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f"
[0m17:09:52.511386 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f
[0m17:09:52.513993 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f"
[0m17:09:52.514667 [debug] [Thread-1 (]: On test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:09:52.515062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:53.168052 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:b992657e-9acc-456a-bb77-0332e2884d4b&page=queryresults
[0m17:09:53.169571 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:b992657e-9acc-456a-bb77-0332e2884d4b&page=queryresults
[0m17:09:53.175536 [debug] [Thread-1 (]: Database Error in test unique_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:9]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_id.sql
[0m17:09:53.176353 [error] [Thread-1 (]: 4 of 5 ERROR unique_stg_shopify__orders_id ..................................... [[31mERROR[0m in 0.68s]
[0m17:09:53.177128 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f
[0m17:09:53.177830 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6
[0m17:09:53.178549 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:9]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_id.sql.
[0m17:09:53.179126 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_shopify__orders_order_id_ ......................... [RUN]
[0m17:09:53.179855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.unique_stg_shopify__orders_id.6a6dd6809f, now test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6)
[0m17:09:53.180225 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6
[0m17:09:53.187151 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6"
[0m17:09:53.188001 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6
[0m17:09:53.190543 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6"
[0m17:09:53.191198 [debug] [Thread-1 (]: On test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id, as unique_field
  from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  where order_id, is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:09:53.191621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:53.486559 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:079b94df-5baf-4db6-a5f8-90fe07aa0ea4&page=queryresults
[0m17:09:53.488587 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:079b94df-5baf-4db6-a5f8-90fe07aa0ea4&page=queryresults
[0m17:09:53.494562 [debug] [Thread-1 (]: Database Error in test unique_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:20]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_order_id_.sql
[0m17:09:53.495305 [error] [Thread-1 (]: 5 of 5 ERROR unique_stg_shopify__orders_order_id_ .............................. [[31mERROR[0m in 0.32s]
[0m17:09:53.496018 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6
[0m17:09:53.496835 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:20]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_order_id_.sql.
[0m17:09:53.498354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:09:53.500405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:53.500949 [debug] [MainThread]: Connection 'test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6' was properly closed.
[0m17:09:53.501414 [info ] [MainThread]: 
[0m17:09:53.501853 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m17:09:53.503413 [debug] [MainThread]: Command end result
[0m17:09:53.531067 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m17:09:53.532561 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m17:09:53.538995 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m17:09:53.539317 [info ] [MainThread]: 
[0m17:09:53.539618 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m17:09:53.539853 [info ] [MainThread]: 
[0m17:09:53.540132 [error] [MainThread]:   Database Error in test not_null_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:18]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_customer_id_.sql
[0m17:09:53.540347 [info ] [MainThread]: 
[0m17:09:53.540600 [error] [MainThread]:   Database Error in test not_null_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:7]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_id.sql
[0m17:09:53.540804 [info ] [MainThread]: 
[0m17:09:53.541039 [error] [MainThread]:   Database Error in test not_null_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:15]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_order_id_.sql
[0m17:09:53.541255 [info ] [MainThread]: 
[0m17:09:53.541483 [error] [MainThread]:   Database Error in test unique_stg_shopify__orders_id (online_shop_dbt/models/staging/shopify/schema.yml)
  Unrecognized name: id at [15:9]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_id.sql
[0m17:09:53.541684 [info ] [MainThread]: 
[0m17:09:53.541922 [error] [MainThread]:   Database Error in test unique_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:20]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_order_id_.sql
[0m17:09:53.542115 [info ] [MainThread]: 
[0m17:09:53.542331 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 TOTAL=5
[0m17:09:53.544749 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.8333216, "process_in_blocks": "0", "process_kernel_time": 0.252603, "process_mem_max_rss": "209928192", "process_out_blocks": "0", "process_user_time": 1.855512}
[0m17:09:53.545112 [debug] [MainThread]: Command `dbt test` failed at 17:09:53.545020 after 3.83 seconds
[0m17:09:53.545432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca59910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca53920>]}
[0m17:09:53.545713 [debug] [MainThread]: Flushing usage events
[0m17:09:54.003302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:29.112963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105873080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106358bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063588f0>]}


============================== 17:10:29.116390 | 23f9ad0d-d396-4b8f-9f41-406bc6036407 ==============================
[0m17:10:29.116390 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:10:29.116719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:10:29.780032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23f9ad0d-d396-4b8f-9f41-406bc6036407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465b380>]}
[0m17:10:29.815866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23f9ad0d-d396-4b8f-9f41-406bc6036407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105799d00>]}
[0m17:10:29.816314 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m17:10:29.906849 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:10:29.961503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:10:29.961740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:10:29.964351 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.online_shop_dbt.example
[0m17:10:29.980080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23f9ad0d-d396-4b8f-9f41-406bc6036407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c464950>]}
[0m17:10:30.016645 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m17:10:30.018456 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m17:10:30.081589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23f9ad0d-d396-4b8f-9f41-406bc6036407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c413530>]}
[0m17:10:30.081885 [info ] [MainThread]: Found 2 models, 3 data tests, 489 macros
[0m17:10:30.082059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23f9ad0d-d396-4b8f-9f41-406bc6036407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c58d5e0>]}
[0m17:10:30.082937 [info ] [MainThread]: 
[0m17:10:30.083128 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:30.083278 [info ] [MainThread]: 
[0m17:10:30.083541 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:10:30.085594 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh_dbt_transformations_new'
[0m17:10:30.085852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:30.415390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23f9ad0d-d396-4b8f-9f41-406bc6036407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c49c320>]}
[0m17:10:30.415896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:30.418092 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4
[0m17:10:30.418439 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_shopify__orders_customer_id_ .................... [RUN]
[0m17:10:30.418784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4)
[0m17:10:30.419052 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4
[0m17:10:30.433012 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4"
[0m17:10:30.433692 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4
[0m17:10:30.446475 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4"
[0m17:10:30.447065 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id,
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where customer_id, is null



      
    ) dbt_internal_test
[0m17:10:30.447322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:30.751006 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:964f9d2d-8212-488e-bb85-16bff30be80a&page=queryresults
[0m17:10:30.752608 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:964f9d2d-8212-488e-bb85-16bff30be80a&page=queryresults
[0m17:10:30.764209 [debug] [Thread-1 (]: Database Error in test not_null_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:18]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_customer_id_.sql
[0m17:10:30.764894 [error] [Thread-1 (]: 1 of 3 ERROR not_null_stg_shopify__orders_customer_id_ ......................... [[31mERROR[0m in 0.35s]
[0m17:10:30.765468 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4
[0m17:10:30.765858 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7
[0m17:10:30.766376 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:18]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_customer_id_.sql.
[0m17:10:30.767075 [info ] [Thread-1 (]: 2 of 3 START test not_null_stg_shopify__orders_order_id_ ....................... [RUN]
[0m17:10:30.768431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_customer_id_.231e1645e4, now test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7)
[0m17:10:30.768855 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7
[0m17:10:30.773337 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7"
[0m17:10:30.773975 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7
[0m17:10:30.778154 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7"
[0m17:10:30.778650 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id,
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where order_id, is null



      
    ) dbt_internal_test
[0m17:10:30.778935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:31.122025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:b277a013-373b-41d8-b566-6d53f8400fd7&page=queryresults
[0m17:10:31.122716 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:b277a013-373b-41d8-b566-6d53f8400fd7&page=queryresults
[0m17:10:31.127134 [debug] [Thread-1 (]: Database Error in test not_null_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:15]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_order_id_.sql
[0m17:10:31.127681 [error] [Thread-1 (]: 2 of 3 ERROR not_null_stg_shopify__orders_order_id_ ............................ [[31mERROR[0m in 0.36s]
[0m17:10:31.128333 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7
[0m17:10:31.128823 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6
[0m17:10:31.129284 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:15]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_order_id_.sql.
[0m17:10:31.129661 [info ] [Thread-1 (]: 3 of 3 START test unique_stg_shopify__orders_order_id_ ......................... [RUN]
[0m17:10:31.130204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_order_id_.81f9c1b5c7, now test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6)
[0m17:10:31.130738 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6
[0m17:10:31.138483 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6"
[0m17:10:31.139387 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6
[0m17:10:31.142427 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6"
[0m17:10:31.143598 [debug] [Thread-1 (]: On test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id, as unique_field
  from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  where order_id, is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:10:31.144125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:31.443361 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:c11b20e4-a313-4022-9349-3234e07a4dcf&page=queryresults
[0m17:10:31.445107 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:c11b20e4-a313-4022-9349-3234e07a4dcf&page=queryresults
[0m17:10:31.451358 [debug] [Thread-1 (]: Database Error in test unique_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:20]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_order_id_.sql
[0m17:10:31.452050 [error] [Thread-1 (]: 3 of 3 ERROR unique_stg_shopify__orders_order_id_ .............................. [[31mERROR[0m in 0.32s]
[0m17:10:31.452649 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6
[0m17:10:31.453245 [debug] [Thread-4 (]: Marking all children of 'test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:20]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_order_id_.sql.
[0m17:10:31.454363 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:31.456222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:31.456601 [debug] [MainThread]: Connection 'test.online_shop_dbt.unique_stg_shopify__orders_order_id_.96396cbae6' was properly closed.
[0m17:10:31.456927 [info ] [MainThread]: 
[0m17:10:31.457223 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m17:10:31.458635 [debug] [MainThread]: Command end result
[0m17:10:31.481253 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m17:10:31.482820 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m17:10:31.488984 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m17:10:31.489323 [info ] [MainThread]: 
[0m17:10:31.489657 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m17:10:31.489916 [info ] [MainThread]: 
[0m17:10:31.490236 [error] [MainThread]:   Database Error in test not_null_stg_shopify__orders_customer_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:18]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_customer_id_.sql
[0m17:10:31.490487 [info ] [MainThread]: 
[0m17:10:31.490768 [error] [MainThread]:   Database Error in test not_null_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got "," at [15:15]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/not_null_stg_shopify__orders_order_id_.sql
[0m17:10:31.490998 [info ] [MainThread]: 
[0m17:10:31.491266 [error] [MainThread]:   Database Error in test unique_stg_shopify__orders_order_id_ (online_shop_dbt/models/staging/shopify/schema.yml)
  Syntax error: Expected ")" but got keyword AS at [13:20]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/staging/shopify/schema.yml/unique_stg_shopify__orders_order_id_.sql
[0m17:10:31.491493 [info ] [MainThread]: 
[0m17:10:31.491744 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m17:10:31.495852 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.4241562, "process_in_blocks": "0", "process_kernel_time": 0.24968, "process_mem_max_rss": "209420288", "process_out_blocks": "0", "process_user_time": 1.680114}
[0m17:10:31.496227 [debug] [MainThread]: Command `dbt test` failed at 17:10:31.496154 after 2.42 seconds
[0m17:10:31.496543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105602480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106358bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c503e00>]}
[0m17:10:31.496825 [debug] [MainThread]: Flushing usage events
[0m17:10:31.937677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:32.310322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f7bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c04c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c049b0>]}


============================== 17:12:32.314066 | 8da16662-65d0-496e-8a32-eaad48e57cb5 ==============================
[0m17:12:32.314066 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:12:32.314463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:12:33.037207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8da16662-65d0-496e-8a32-eaad48e57cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad127e0>]}
[0m17:12:33.072425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8da16662-65d0-496e-8a32-eaad48e57cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ba3c0>]}
[0m17:12:33.072817 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m17:12:33.161222 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:12:33.217470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:12:33.217696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:12:33.220598 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.online_shop_dbt.example
[0m17:12:33.236566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8da16662-65d0-496e-8a32-eaad48e57cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae001a0>]}
[0m17:12:33.273315 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m17:12:33.275403 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m17:12:33.338948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8da16662-65d0-496e-8a32-eaad48e57cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb2030>]}
[0m17:12:33.339243 [info ] [MainThread]: Found 2 models, 3 data tests, 489 macros
[0m17:12:33.339420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8da16662-65d0-496e-8a32-eaad48e57cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae2ac90>]}
[0m17:12:33.340325 [info ] [MainThread]: 
[0m17:12:33.340504 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:12:33.340642 [info ] [MainThread]: 
[0m17:12:33.340878 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:12:33.342831 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh_dbt_transformations_new'
[0m17:12:33.343048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:33.659760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8da16662-65d0-496e-8a32-eaad48e57cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae28ec0>]}
[0m17:12:33.660967 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:33.664271 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837
[0m17:12:33.665023 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_shopify__orders_customer_id ..................... [RUN]
[0m17:12:33.665663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837)
[0m17:12:33.666177 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837
[0m17:12:33.688078 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837"
[0m17:12:33.689066 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837
[0m17:12:33.707702 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837"
[0m17:12:33.708474 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where customer_id is null



      
    ) dbt_internal_test
[0m17:12:33.708811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:34.675383 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:e4d5b90e-016c-4f38-996b-792982365b74&page=queryresults
[0m17:12:35.116435 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_shopify__orders_customer_id ........................... [[32mPASS[0m in 1.45s]
[0m17:12:35.116849 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837
[0m17:12:35.117065 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab
[0m17:12:35.117355 [info ] [Thread-1 (]: 2 of 3 START test not_null_stg_shopify__orders_order_id ........................ [RUN]
[0m17:12:35.117806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837, now test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab)
[0m17:12:35.118056 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab
[0m17:12:35.120726 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab"
[0m17:12:35.121267 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab
[0m17:12:35.122884 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab"
[0m17:12:35.123796 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where order_id is null



      
    ) dbt_internal_test
[0m17:12:35.124087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:35.903665 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:0ef4094f-2976-4247-8c84-ed92b7a76000&page=queryresults
[0m17:12:36.278474 [info ] [Thread-1 (]: 2 of 3 PASS not_null_stg_shopify__orders_order_id .............................. [[32mPASS[0m in 1.16s]
[0m17:12:36.279811 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab
[0m17:12:36.280601 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4
[0m17:12:36.281303 [info ] [Thread-1 (]: 3 of 3 START test unique_stg_shopify__orders_order_id .......................... [RUN]
[0m17:12:36.281871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab, now test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4)
[0m17:12:36.282272 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4
[0m17:12:36.290393 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4"
[0m17:12:36.291336 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4
[0m17:12:36.294046 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4"
[0m17:12:36.294840 [debug] [Thread-1 (]: On test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:12:36.295357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:37.138106 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:3ced7076-bb6c-4f32-91dd-9ae7be39ec67&page=queryresults
[0m17:12:37.517857 [info ] [Thread-1 (]: 3 of 3 PASS unique_stg_shopify__orders_order_id ................................ [[32mPASS[0m in 1.24s]
[0m17:12:37.519409 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4
[0m17:12:37.521533 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:37.523871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:37.524491 [debug] [MainThread]: Connection 'test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4' was properly closed.
[0m17:12:37.525053 [info ] [MainThread]: 
[0m17:12:37.525640 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.18 seconds (4.18s).
[0m17:12:37.526901 [debug] [MainThread]: Command end result
[0m17:12:37.553447 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m17:12:37.555245 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m17:12:37.561231 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m17:12:37.561541 [info ] [MainThread]: 
[0m17:12:37.561885 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:12:37.562142 [info ] [MainThread]: 
[0m17:12:37.562409 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:12:37.565045 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.3006396, "process_in_blocks": "0", "process_kernel_time": 0.276911, "process_mem_max_rss": "211533824", "process_out_blocks": "0", "process_user_time": 1.763217}
[0m17:12:37.565453 [debug] [MainThread]: Command `dbt test` succeeded at 17:12:37.565372 after 5.30 seconds
[0m17:12:37.565783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c049b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c04b30>]}
[0m17:12:37.566101 [debug] [MainThread]: Flushing usage events
[0m17:12:38.034799 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:12.158172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d37fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba4c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba49e0>]}


============================== 17:13:12.161867 | a4bc30f8-adb9-4873-9861-3d67364eddbf ==============================
[0m17:13:12.161867 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:13:12.162260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:13:12.792201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4bc30f8-adb9-4873-9861-3d67364eddbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d5dbfb0>]}
[0m17:13:12.826405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4bc30f8-adb9-4873-9861-3d67364eddbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1f710>]}
[0m17:13:12.826762 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m17:13:12.916415 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:13:12.968798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:13:12.969029 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:13:12.986315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4bc30f8-adb9-4873-9861-3d67364eddbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d593cb0>]}
[0m17:13:13.021291 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m17:13:13.023096 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m17:13:13.035645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4bc30f8-adb9-4873-9861-3d67364eddbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d796e10>]}
[0m17:13:13.035912 [info ] [MainThread]: Found 2 models, 3 data tests, 489 macros
[0m17:13:13.036077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4bc30f8-adb9-4873-9861-3d67364eddbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe2660>]}
[0m17:13:13.036922 [info ] [MainThread]: 
[0m17:13:13.037100 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:13:13.037235 [info ] [MainThread]: 
[0m17:13:13.037476 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:13:13.039252 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m17:13:13.039450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:13.458672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now list_opensource-marketing-dwh_dbt_transformations_new)
[0m17:13:13.459755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:13.793864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4bc30f8-adb9-4873-9861-3d67364eddbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057e4f80>]}
[0m17:13:13.795165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:13:13.799306 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.stg_shopify__orders
[0m17:13:13.800116 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_transformations_new.stg_shopify__orders ........ [RUN]
[0m17:13:13.800756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now model.online_shop_dbt.stg_shopify__orders)
[0m17:13:13.801272 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.stg_shopify__orders
[0m17:13:13.810506 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.stg_shopify__orders"
[0m17:13:13.812664 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.stg_shopify__orders
[0m17:13:13.842858 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.stg_shopify__orders"
[0m17:13:13.843898 [debug] [Thread-1 (]: On model.online_shop_dbt.stg_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.stg_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  OPTIONS()
  as WITH shopify AS (
    SELECT * FROM opensource-marketing-dwh.shopify.shopify_orders
),

-- removes columns that are not needed at the moment
filter_source AS (
    SELECT
        id AS order_id,
        customer_id,
        -- app_id,
        -- cancel_reason,
        -- totals
        total_discounts,
        total_line_items_price,
        total_price,
        -- total_price_usd,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
        -- total_tip_received,

        -- cart_token,
        -- checkout_id,
        -- checkout_token,
        -- timestamps
        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        -- client details
        -- client_details_accept_language,
        -- client_details_browser_height,
        -- client_details_browser_ip,
        -- client_details_browser_width,
        -- client_details_session_hash,
        -- client_details_user_agent,
        -- confirmed,
        -- currency,
        -- customer_accepts_marketing,
        -- customer_accepts_marketing_updated_at,
        -- customer_created_at,
        -- customer_uid,
        -- customer_locale,
        -- customer_multipass_identifier,
        -- customer_note,
        -- customer_state,
        -- customer_tags,
        -- customer_tax_exempt,
        -- customer_total_spent,
        -- customer_updated_at,
        -- device_id,
        -- discount application
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        -- financial_status,
        -- fulfillment_status,
        -- gateway,
        -- uid,
        landing_site,
        -- landing_site_ref,
        -- fulfillments_location_id,
        -- fulfillments_line_item_id,
        -- line items
        -- line_item_discount_allocations_amount,
        -- line_item_discount_allocations_application_index,
        -- line_item_fulfillable_quantity,
        -- line_item_fulfillment_service,
        -- line_item_fulfillment_status,
        -- line_item_gift_card,
        -- line_item_grams,
        -- line_item_id,
        -- line_item_uid,
        -- line_item_name,
        -- line_item_price,
        -- line_item_product_exists,
        -- line_item_product_id,
        -- line_item_product_uid,
        -- line_item_properties,
        -- line_item_quantity,
        -- line_item_requires_shipping,
        -- line_item_sku,
        -- line_item_tax_lines_price,
        -- line_item_tax_lines_rate,
        -- line_item_tax_lines_title,
        -- line_item_taxable,
        -- line_item_title,
        -- line_item_variant_id,
        -- line_item_variant_uid,
        -- line_item_vendor,
        -- line_item_variant_inventory_management,
        -- line_item_variant_title,
        -- location_id,
        -- name,
        -- note,
        -- number,
        -- order adjustment
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        -- order_number,
        -- order_status_url,
        -- payment_details_avs_result_code,
        -- payment_details_credit_card_company,
        payment_gateway_names,
        presentment_currency,
        -- processing_method,
        -- reference,
        referring_site,
        -- refunds
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        -- shipping address
        -- shipping_address_city,
        -- shipping_address_country,
        -- shipping_address_country_code,
        -- shipping_address_province,
        -- shipping_address_province_code,
        -- shipping_address_zip,
        -- shipping_line_code,
        -- billing_address_city,
        -- billing_address_zip,
        billing_address_country_code, -- billing address is relevant to see where the money goes to
        -- shipping
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,

        -- source_identifier,
        -- source_name,
        -- source_url,
        -- tags,

        -- tax
        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
        -- token,
        -- total_weight,
        -- user_id,
        -- record_timestamp
    FROM shopify
    -- we want to remove test orders
    WHERE test IS false
)

SELECT * FROM filter_source;


[0m17:13:13.844471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:14.288689 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:d1c090a4-9931-4c68-a435-4b9d7e031ff3&page=queryresults
[0m17:13:14.663845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4bc30f8-adb9-4873-9861-3d67364eddbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d455d90>]}
[0m17:13:14.664323 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_transformations_new.stg_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m17:13:14.664704 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.stg_shopify__orders
[0m17:13:14.665166 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.int_shopify__orders
[0m17:13:14.665463 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt_transformations_new.int_shopify__orders ........ [RUN]
[0m17:13:14.665705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.stg_shopify__orders, now model.online_shop_dbt.int_shopify__orders)
[0m17:13:14.665894 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.int_shopify__orders
[0m17:13:14.668555 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.int_shopify__orders"
[0m17:13:14.669117 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.int_shopify__orders
[0m17:13:14.670523 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.int_shopify__orders"
[0m17:13:14.670982 [debug] [Thread-1 (]: On model.online_shop_dbt.int_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.int_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__orders`
  OPTIONS()
  as WITH staging AS (
    SELECT * FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
)

SELECT * FROM staging
WHERE customer_id IS NULL;


[0m17:13:14.671227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:15.428713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:65189182-e226-47e9-8e3d-f22475e204b2&page=queryresults
[0m17:13:15.617748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4bc30f8-adb9-4873-9861-3d67364eddbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dc22e70>]}
[0m17:13:15.618507 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt_transformations_new.int_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m17:13:15.619160 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.int_shopify__orders
[0m17:13:15.620181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:13:15.621871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:15.622182 [debug] [MainThread]: Connection 'model.online_shop_dbt.int_shopify__orders' was properly closed.
[0m17:13:15.622527 [info ] [MainThread]: 
[0m17:13:15.622833 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m17:13:15.623505 [debug] [MainThread]: Command end result
[0m17:13:15.643488 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m17:13:15.645370 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m17:13:15.649363 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m17:13:15.649593 [info ] [MainThread]: 
[0m17:13:15.649825 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:13:15.650006 [info ] [MainThread]: 
[0m17:13:15.650198 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:13:15.652331 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.5384443, "process_in_blocks": "0", "process_kernel_time": 0.260962, "process_mem_max_rss": "209453056", "process_out_blocks": "0", "process_user_time": 1.664487}
[0m17:13:15.652630 [debug] [MainThread]: Command `dbt run` succeeded at 17:13:15.652570 after 3.54 seconds
[0m17:13:15.652861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f256f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f257fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f256c90>]}
[0m17:13:15.653088 [debug] [MainThread]: Flushing usage events
[0m17:13:16.086241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:20.259235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10455c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa88c0>]}


============================== 17:24:20.262992 | 2481e5ba-a6dc-4773-95dc-802b3d763bb2 ==============================
[0m17:24:20.262992 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:24:20.263375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:24:20.929721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2481e5ba-a6dc-4773-95dc-802b3d763bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a654aa0>]}
[0m17:24:20.964055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2481e5ba-a6dc-4773-95dc-802b3d763bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa6c980>]}
[0m17:24:20.964391 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m17:24:21.053753 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:24:21.116171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:24:21.116398 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:24:21.133952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2481e5ba-a6dc-4773-95dc-802b3d763bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acc94f0>]}
[0m17:24:21.169054 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m17:24:21.171308 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m17:24:21.230670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2481e5ba-a6dc-4773-95dc-802b3d763bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910f620>]}
[0m17:24:21.230970 [info ] [MainThread]: Found 2 models, 3 data tests, 489 macros
[0m17:24:21.231146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2481e5ba-a6dc-4773-95dc-802b3d763bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b05c9b0>]}
[0m17:24:21.232063 [info ] [MainThread]: 
[0m17:24:21.232236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:21.232372 [info ] [MainThread]: 
[0m17:24:21.232611 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:24:21.234431 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m17:24:21.234634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:21.622478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now list_opensource-marketing-dwh_dbt_transformations_new)
[0m17:24:21.623584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:21.958823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2481e5ba-a6dc-4773-95dc-802b3d763bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b05f890>]}
[0m17:24:21.959774 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:21.962891 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.stg_shopify__orders
[0m17:24:21.963733 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_transformations_new.stg_shopify__orders ........ [RUN]
[0m17:24:21.964385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now model.online_shop_dbt.stg_shopify__orders)
[0m17:24:21.964897 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.stg_shopify__orders
[0m17:24:21.973956 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.stg_shopify__orders"
[0m17:24:21.975152 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.stg_shopify__orders
[0m17:24:22.005225 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.stg_shopify__orders"
[0m17:24:22.006223 [debug] [Thread-1 (]: On model.online_shop_dbt.stg_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.stg_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  OPTIONS()
  as WITH shopify AS (
    SELECT * FROM opensource-marketing-dwh.shopify.shopify_orders
),

-- removes columns that are not needed at the moment
filter_source AS (
    SELECT
        id AS order_id,
        customer_id,
        -- app_id,
        -- cancel_reason,
        -- totals
        total_discounts,
        total_line_items_price,
        total_price,
        -- total_price_usd,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
        -- total_tip_received,

        -- cart_token,
        -- checkout_id,
        -- checkout_token,
        -- timestamps
        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        -- client details
        -- client_details_accept_language,
        -- client_details_browser_height,
        -- client_details_browser_ip,
        -- client_details_browser_width,
        -- client_details_session_hash,
        -- client_details_user_agent,
        -- confirmed,
        -- currency,
        -- customer_accepts_marketing,
        -- customer_accepts_marketing_updated_at,
        -- customer_created_at,
        -- customer_uid,
        -- customer_locale,
        -- customer_multipass_identifier,
        -- customer_note,
        -- customer_state,
        -- customer_tags,
        -- customer_tax_exempt,
        -- customer_total_spent,
        -- customer_updated_at,
        -- device_id,
        -- discount application
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        -- financial_status,
        -- fulfillment_status,
        -- gateway,
        -- uid,
        landing_site,
        -- landing_site_ref,
        -- fulfillments_location_id,
        -- fulfillments_line_item_id,
        -- line items
        -- line_item_discount_allocations_amount,
        -- line_item_discount_allocations_application_index,
        -- line_item_fulfillable_quantity,
        -- line_item_fulfillment_service,
        -- line_item_fulfillment_status,
        -- line_item_gift_card,
        -- line_item_grams,
        -- line_item_id,
        -- line_item_uid,
        -- line_item_name,
        -- line_item_price,
        -- line_item_product_exists,
        -- line_item_product_id,
        -- line_item_product_uid,
        -- line_item_properties,
        -- line_item_quantity,
        -- line_item_requires_shipping,
        -- line_item_sku,
        -- line_item_tax_lines_price,
        -- line_item_tax_lines_rate,
        -- line_item_tax_lines_title,
        -- line_item_taxable,
        -- line_item_title,
        -- line_item_variant_id,
        -- line_item_variant_uid,
        -- line_item_vendor,
        -- line_item_variant_inventory_management,
        -- line_item_variant_title,
        -- location_id,
        -- name,
        -- note,
        -- number,
        -- order adjustment
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        -- order_number,
        -- order_status_url,
        -- payment_details_avs_result_code,
        -- payment_details_credit_card_company,
        payment_gateway_names,
        presentment_currency,
        -- processing_method,
        -- reference,
        referring_site,
        -- refunds
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        -- shipping address
        -- shipping_address_city,
        -- shipping_address_country,
        -- shipping_address_country_code,
        -- shipping_address_province,
        -- shipping_address_province_code,
        -- shipping_address_zip,
        -- shipping_line_code,
        -- billing_address_city,
        -- billing_address_zip,
        billing_address_country_code, -- billing address is relevant to see where the money goes to
        -- shipping
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,

        -- source_identifier,
        -- source_name,
        -- source_url,
        -- tags,

        -- tax
        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
        -- token,
        -- total_weight,
        -- user_id,
        -- record_timestamp
    FROM shopify
    -- we want to remove test orders
    WHERE test IS false
)

SELECT * FROM filter_source;


[0m17:24:22.006781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:22.462250 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:9a3bb3da-2668-4e4a-b3d8-2ff65458ec18&page=queryresults
[0m17:24:22.838221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2481e5ba-a6dc-4773-95dc-802b3d763bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeedbe0>]}
[0m17:24:22.838763 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_transformations_new.stg_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m17:24:22.839169 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.stg_shopify__orders
[0m17:24:22.839668 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.int_shopify__orders
[0m17:24:22.840030 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt_transformations_new.int_shopify__orders ........ [RUN]
[0m17:24:22.840324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.stg_shopify__orders, now model.online_shop_dbt.int_shopify__orders)
[0m17:24:22.840550 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.int_shopify__orders
[0m17:24:22.843078 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.int_shopify__orders"
[0m17:24:22.844006 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.int_shopify__orders
[0m17:24:22.846017 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.int_shopify__orders"
[0m17:24:22.846946 [debug] [Thread-1 (]: On model.online_shop_dbt.int_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.int_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__orders`
  OPTIONS()
  as WITH staging AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,

        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        landing_site,
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        payment_gateway_names,
        presentment_currency,
        referring_site,
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,


        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
),

extract_columns AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,

        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        landing_site,
        -- Extract the base URL (before the ?)
        REGEXP_EXTRACT(landing_site, r'^([^?]+)') AS base_url,
        -- Extract the utm_source
        REGEXP_EXTRACT(landing_site, r'utm_source=([^&]+)') AS utm_source,
        -- Extract the utm_medium
        REGEXP_EXTRACT(landing_site, r'utm_medium=([^&]+)') AS utm_medium,

        -- Extract the utm_campaign
        REGEXP_EXTRACT(landing_site, r'utm_campaign=([^&]+)') AS utm_campaign,

        -- Extract the utm_content
        REGEXP_EXTRACT(landing_site, r'utm_content=([^&]+)') AS utm_content,

        -- Extract the utm_term
        REGEXP_EXTRACT(landing_site, r'utm_term=([^&]+)') AS utm_term,

        -- Extract the fbclid
        REGEXP_EXTRACT(landing_site, r'fbclid=([^&]+)') AS fbclid,

        -- Extract the campaign_id
        REGEXP_EXTRACT(landing_site, r'campaign_id=([^&]+)') AS campaign_id,
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        payment_gateway_names,
        presentment_currency,
        referring_site,
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,


        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
    FROM staging
)



SELECT * FROM extract_columns;


[0m17:24:22.847458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:23.562054 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:83000e9c-7062-4dfa-8522-0418e667c350&page=queryresults
[0m17:24:23.872848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2481e5ba-a6dc-4773-95dc-802b3d763bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114243620>]}
[0m17:24:23.873740 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt_transformations_new.int_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m17:24:23.874354 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.int_shopify__orders
[0m17:24:23.875418 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:24:23.877602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:23.878037 [debug] [MainThread]: Connection 'model.online_shop_dbt.int_shopify__orders' was properly closed.
[0m17:24:23.878527 [info ] [MainThread]: 
[0m17:24:23.878947 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m17:24:23.880399 [debug] [MainThread]: Command end result
[0m17:24:23.908135 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m17:24:23.909592 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m17:24:23.914743 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m17:24:23.915049 [info ] [MainThread]: 
[0m17:24:23.915363 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:24:23.915607 [info ] [MainThread]: 
[0m17:24:23.915847 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:24:23.918279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7036326, "process_in_blocks": "0", "process_kernel_time": 0.281151, "process_mem_max_rss": "209551360", "process_out_blocks": "0", "process_user_time": 1.707211}
[0m17:24:23.918654 [debug] [MainThread]: Command `dbt run` succeeded at 17:24:23.918577 after 3.70 seconds
[0m17:24:23.918943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6dbcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11422ee70>]}
[0m17:24:23.919233 [debug] [MainThread]: Flushing usage events
[0m17:24:24.426966 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:33:52.960604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b6a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc8b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc8860>]}


============================== 12:33:52.963693 | 27e11a91-9134-4313-ad90-e26a1afb2854 ==============================
[0m12:33:52.963693 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:33:52.964030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:33:53.628401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27e11a91-9134-4313-ad90-e26a1afb2854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b97110>]}
[0m12:33:53.662797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27e11a91-9134-4313-ad90-e26a1afb2854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6c410>]}
[0m12:33:53.663116 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:33:53.754449 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:33:53.819826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:33:53.820052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:33:53.837637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27e11a91-9134-4313-ad90-e26a1afb2854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b603770>]}
[0m12:33:53.872728 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m12:33:53.875252 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m12:33:53.930350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27e11a91-9134-4313-ad90-e26a1afb2854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b47b30>]}
[0m12:33:53.930632 [info ] [MainThread]: Found 5 models, 3 data tests, 489 macros
[0m12:33:53.930800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27e11a91-9134-4313-ad90-e26a1afb2854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b60cc50>]}
[0m12:33:53.931709 [info ] [MainThread]: 
[0m12:33:53.931885 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:53.932022 [info ] [MainThread]: 
[0m12:33:53.932257 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:33:53.934155 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m12:33:53.934355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:54.310929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now list_opensource-marketing-dwh_dbt_transformations_new)
[0m12:33:54.312101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:54.678050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27e11a91-9134-4313-ad90-e26a1afb2854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c2ce480>]}
[0m12:33:54.679298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:33:54.682689 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.stg_shopify__orders
[0m12:33:54.683314 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_transformations_new.stg_shopify__orders ........ [RUN]
[0m12:33:54.683768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now model.online_shop_dbt.stg_shopify__orders)
[0m12:33:54.684133 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.stg_shopify__orders
[0m12:33:54.695071 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.stg_shopify__orders"
[0m12:33:54.698080 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.stg_shopify__orders
[0m12:33:54.728667 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.stg_shopify__orders"
[0m12:33:54.729741 [debug] [Thread-1 (]: On model.online_shop_dbt.stg_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.stg_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  OPTIONS()
  as WITH shopify AS (
    SELECT * FROM opensource-marketing-dwh.shopify.shopify_orders
),

-- removes columns that are not needed at the moment
filter_source AS (
    SELECT
        id AS order_id,
        customer_id,
        -- app_id,
        -- cancel_reason,
        -- totals
        total_discounts,
        total_line_items_price,
        total_price,
        -- total_price_usd,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
        -- total_tip_received,

        -- cart_token,
        -- checkout_id,
        -- checkout_token,
        -- timestamps
        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        -- client details
        -- client_details_accept_language,
        -- client_details_browser_height,
        -- client_details_browser_ip,
        -- client_details_browser_width,
        -- client_details_session_hash,
        -- client_details_user_agent,
        -- confirmed,
        -- currency,
        -- customer_accepts_marketing,
        -- customer_accepts_marketing_updated_at,
        -- customer_created_at,
        -- customer_uid,
        -- customer_locale,
        -- customer_multipass_identifier,
        -- customer_note,
        -- customer_state,
        -- customer_tags,
        -- customer_tax_exempt,
        -- customer_total_spent,
        -- customer_updated_at,
        -- device_id,
        -- discount application
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        -- financial_status,
        -- fulfillment_status,
        -- gateway,
        -- uid,
        landing_site,
        -- landing_site_ref,
        -- fulfillments_location_id,
        -- fulfillments_line_item_id,
        -- line items
        -- line_item_discount_allocations_amount,
        -- line_item_discount_allocations_application_index,
        -- line_item_fulfillable_quantity,
        -- line_item_fulfillment_service,
        -- line_item_fulfillment_status,
        -- line_item_gift_card,
        -- line_item_grams,
        -- line_item_id,
        -- line_item_uid,
        -- line_item_name,
        -- line_item_price,
        -- line_item_product_exists,
        -- line_item_product_id,
        -- line_item_product_uid,
        -- line_item_properties,
        -- line_item_quantity,
        -- line_item_requires_shipping,
        -- line_item_sku,
        -- line_item_tax_lines_price,
        -- line_item_tax_lines_rate,
        -- line_item_tax_lines_title,
        -- line_item_taxable,
        -- line_item_title,
        -- line_item_variant_id,
        -- line_item_variant_uid,
        -- line_item_vendor,
        -- line_item_variant_inventory_management,
        -- line_item_variant_title,
        -- location_id,
        -- name,
        -- note,
        -- number,
        -- order adjustment
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        -- order_number,
        -- order_status_url,
        -- payment_details_avs_result_code,
        -- payment_details_credit_card_company,
        payment_gateway_names,
        presentment_currency,
        -- processing_method,
        -- reference,
        referring_site,
        -- refunds
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        -- shipping address
        -- shipping_address_city,
        -- shipping_address_country,
        -- shipping_address_country_code,
        -- shipping_address_province,
        -- shipping_address_province_code,
        -- shipping_address_zip,
        -- shipping_line_code,
        -- billing_address_city,
        -- billing_address_zip,
        billing_address_country_code, -- billing address is relevant to see where the money goes to
        -- shipping
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,

        -- source_identifier,
        -- source_name,
        -- source_url,
        -- tags,

        -- tax
        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
        -- token,
        -- total_weight,
        -- user_id,
        -- record_timestamp
    FROM shopify
    -- we want to remove test orders
    WHERE test IS false
)

SELECT * FROM filter_source;


[0m12:33:54.730330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:55.272989 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:af4f9a13-4be9-4225-92a1-4d410aaec35b&page=queryresults
[0m12:33:55.660043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e11a91-9134-4313-ad90-e26a1afb2854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080085c0>]}
[0m12:33:55.660551 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_transformations_new.stg_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m12:33:55.660950 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.stg_shopify__orders
[0m12:33:55.661496 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.int_shopify__order_discount
[0m12:33:55.661863 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_transformations_new.int_shopify__order_discount  [RUN]
[0m12:33:55.662146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.stg_shopify__orders, now model.online_shop_dbt.int_shopify__order_discount)
[0m12:33:55.662357 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.int_shopify__order_discount
[0m12:33:55.664418 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.int_shopify__order_discount"
[0m12:33:55.665094 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.int_shopify__order_discount
[0m12:33:55.666845 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.int_shopify__order_discount"
[0m12:33:55.667548 [debug] [Thread-1 (]: On model.online_shop_dbt.int_shopify__order_discount: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.int_shopify__order_discount"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_discount`
  OPTIONS()
  as WITH
stg_shopify__orders AS (
    SELECT
        order_id,
        customer_id,
        -- the following metrics are just for checks. They do not really belong here
        total_line_items_price,
        total_discounts,
        total_subtotal_price,
        total_shipping_price,
        total_tax,
        total_price,
        
        -- discounts -- 
        -- This method only works because there are no columns with more than one element in the list (one discount per order).
        -- To handle multiple list elements the array would have to be unnested.
        -- Since this is just a test, i will take the easy route and use regex.
        REGEXP_EXTRACT(discount_application_target_type, r'\[\'([^\']+)\'\]') AS discount_application_target_type,
        REGEXP_EXTRACT(discount_application_allocation_method, r'\[\'([^\']+)\'\]') AS discount_application_allocation_method,
        REGEXP_EXTRACT(discount_application_code, r'\[\'([^\']+)\'\]') AS discount_application_code,
        REGEXP_EXTRACT(discount_application_target_selection, r'\[\'([^\']+)\'\]') AS discount_application_target_selection,
        REGEXP_EXTRACT(discount_application_type, r'\[\'([^\']+)\'\]') AS discount_application_type,
        CAST(REPLACE(REPLACE(discount_application_value, '[', ''), ']', '') AS FLOAT64) AS discount_application_value,

        REGEXP_EXTRACT(discount_application_value_type, r'\[\'([^\']+)\'\]') AS discount_application_value_type,
        REGEXP_EXTRACT(discount_application_title, r'\[\'([^\']+)\'\]') AS discount_application_title,
        REGEXP_EXTRACT(discount_application_description, r'\[\'([^\']+)\'\]') AS discount_application_description,
        REGEXP_EXTRACT(discount_code_code, r'\[\'([^\']+)\'\]') AS discount_code_code,
        REGEXP_EXTRACT(discount_code_type, r'\[\'([^\']+)\'\]') AS discount_code_type,
        CAST(REPLACE(REPLACE(discount_code_amount, '[', ''), ']', '') AS FLOAT64) AS discount_code_amount,
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
    -- only handle discounts in this model
    WHERE total_discounts > 0
),

-- there are different types of discounts
-- if discount_application_target_type = shipping_line, then the discount is only subtracted from the shipping!

SELECT * FROM stg_shopify__orders;


[0m12:33:55.667899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:55.972390 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:e93e0e2d-ad34-42cd-a5b2-eb845f64b5d6&page=queryresults
[0m12:33:55.974106 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:e93e0e2d-ad34-42cd-a5b2-eb845f64b5d6&page=queryresults
[0m12:33:55.987244 [debug] [Thread-1 (]: Database Error in model int_shopify__order_discount (online_shop_dbt/models/intermediate/shopify/int_shopify__order_discount.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [44:1]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/intermediate/shopify/int_shopify__order_discount.sql
[0m12:33:55.987725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e11a91-9134-4313-ad90-e26a1afb2854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da6e930>]}
[0m12:33:55.988300 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model dbt_transformations_new.int_shopify__order_discount  [[31mERROR[0m in 0.33s]
[0m12:33:55.989065 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.int_shopify__order_discount
[0m12:33:55.989594 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.int_shopify__order_refund
[0m12:33:55.990303 [debug] [Thread-4 (]: Marking all children of 'model.online_shop_dbt.int_shopify__order_discount' to be skipped because of status 'error'.  Reason: Database Error in model int_shopify__order_discount (online_shop_dbt/models/intermediate/shopify/int_shopify__order_discount.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [44:1]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/intermediate/shopify/int_shopify__order_discount.sql.
[0m12:33:55.991032 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_transformations_new.int_shopify__order_refund .. [RUN]
[0m12:33:55.992358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.int_shopify__order_discount, now model.online_shop_dbt.int_shopify__order_refund)
[0m12:33:55.992669 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.int_shopify__order_refund
[0m12:33:55.995637 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.int_shopify__order_refund"
[0m12:33:55.996450 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.int_shopify__order_refund
[0m12:33:55.999472 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.int_shopify__order_refund"
[0m12:33:56.000345 [debug] [Thread-1 (]: On model.online_shop_dbt.int_shopify__order_refund: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.int_shopify__order_refund"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_refund`
  OPTIONS()
  as WITH
stg_shopify__orders AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
    
        -- order_adjustment_amount,
        -- order_adjustment_id,
        -- order_adjustment_uid,
        -- order_adjustment_kind,
        -- order_adjustment_reason,
        -- order_adjustment_refund_id,
        -- order_adjustment_refund_uid,
        -- order_adjustment_tax_amount,

        -- line item level is ignored for now       
        -- refund_line_item_created_at,
        -- refund_line_item_order_line_item_id,
        -- refund_line_item_processed_at,
        -- refund_line_item_quantity,
        -- refund_line_item_refund_id,
        -- refund_line_item_refund_line_item_id,
        -- refund_line_item_restock,
        -- refund_line_item_restock_type,

        -- refunds
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
),

extract_refunds AS (
    SELECT
        order_id,
        customer_id,
        -- just for debugging
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
        -- refunds
        CAST(REPLACE(REPLACE(refund_transactions_id, '[', ''), ']', '') AS STRING) AS refund_transactions_id,
        CAST(REPLACE(REPLACE(refund_transactions_amount, '[', ''), ']', '') AS STRING) AS refund_transactions_amount,
        CAST(REPLACE(REPLACE(REPLACE(refund_transactions_created_at, '[', ''), ']', ''),  "'", '') AS STRING) AS refund_transactions_created_at,
        CAST(REPLACE(REPLACE(REPLACE(refund_transactions_kind, '[', ''), ']', ''), "'", '') AS STRING) AS refund_transactions_kind,
        CAST(REPLACE(REPLACE(REPLACE(refund_transactions_status, '[', ''), ']', ''), "'", '') AS STRING) AS refund_transactions_status
    FROM stg_shopify__orders
)

SELECT * FROM extract_refunds
-- exclude non refunds
WHERE refund_transactions_id != '';


[0m12:33:56.000938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:56.765110 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:172eadab-5a5f-4e84-a66a-dbfa330562dc&page=queryresults
[0m12:33:57.079959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e11a91-9134-4313-ad90-e26a1afb2854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13db43e60>]}
[0m12:33:57.081400 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_transformations_new.int_shopify__order_refund  [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m12:33:57.082280 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.int_shopify__order_refund
[0m12:33:57.082862 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.int_shopify__orders
[0m12:33:57.083528 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_transformations_new.int_shopify__orders ........ [RUN]
[0m12:33:57.084260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.int_shopify__order_refund, now model.online_shop_dbt.int_shopify__orders)
[0m12:33:57.084799 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.int_shopify__orders
[0m12:33:57.090289 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.int_shopify__orders"
[0m12:33:57.092186 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.int_shopify__orders
[0m12:33:57.096623 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.int_shopify__orders"
[0m12:33:57.097796 [debug] [Thread-1 (]: On model.online_shop_dbt.int_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.int_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__orders`
  OPTIONS()
  as WITH staging AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,

        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        landing_site,
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        payment_gateway_names,
        presentment_currency,
        referring_site,
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,


        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
),

extract_columns AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,

        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        landing_site,
        -- Extract the base URL (before the ?)
        REGEXP_EXTRACT(landing_site, r'^([^?]+)') AS base_url,
        -- Extract the utm_source
        REGEXP_EXTRACT(landing_site, r'utm_source=([^&]+)') AS utm_source,
        -- Extract the utm_medium
        REGEXP_EXTRACT(landing_site, r'utm_medium=([^&]+)') AS utm_medium,

        -- Extract the utm_campaign
        REGEXP_EXTRACT(landing_site, r'utm_campaign=([^&]+)') AS utm_campaign,

        -- Extract the utm_content
        REGEXP_EXTRACT(landing_site, r'utm_content=([^&]+)') AS utm_content,

        -- Extract the utm_term
        REGEXP_EXTRACT(landing_site, r'utm_term=([^&]+)') AS utm_term,

        -- Extract the fbclid
        REGEXP_EXTRACT(landing_site, r'fbclid=([^&]+)') AS fbclid,

        -- Extract the campaign_id
        REGEXP_EXTRACT(landing_site, r'campaign_id=([^&]+)') AS campaign_id,
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        payment_gateway_names,
        presentment_currency,
        referring_site,
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,


        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
    FROM staging
)



SELECT * FROM extract_columns;


[0m12:33:57.098478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:57.903353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:1196382f-8b3f-415e-99ea-7adf6c26c58b&page=queryresults
[0m12:33:58.112841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e11a91-9134-4313-ad90-e26a1afb2854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13db79be0>]}
[0m12:33:58.113567 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_transformations_new.int_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m12:33:58.114137 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.int_shopify__orders
[0m12:33:58.114851 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.mrt_shopify__orders
[0m12:33:58.115630 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt_transformations_new.mrt_shopify__orders ............... [[33mSKIP[0m]
[0m12:33:58.116288 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.mrt_shopify__orders
[0m12:33:58.117214 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:33:58.118537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:58.118949 [debug] [MainThread]: Connection 'model.online_shop_dbt.int_shopify__orders' was properly closed.
[0m12:33:58.119472 [info ] [MainThread]: 
[0m12:33:58.119917 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.19 seconds (4.19s).
[0m12:33:58.121588 [debug] [MainThread]: Command end result
[0m12:33:58.150886 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m12:33:58.152363 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m12:33:58.158237 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m12:33:58.158539 [info ] [MainThread]: 
[0m12:33:58.158820 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:33:58.159052 [info ] [MainThread]: 
[0m12:33:58.159334 [error] [MainThread]:   Database Error in model int_shopify__order_discount (online_shop_dbt/models/intermediate/shopify/int_shopify__order_discount.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [44:1]
  compiled code at target/run/online_shop_dbt/online_shop_dbt/models/intermediate/shopify/int_shopify__order_discount.sql
[0m12:33:58.159553 [info ] [MainThread]: 
[0m12:33:58.159767 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m12:33:58.162393 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.2429447, "process_in_blocks": "0", "process_kernel_time": 0.285481, "process_mem_max_rss": "211419136", "process_out_blocks": "0", "process_user_time": 1.899964}
[0m12:33:58.162692 [debug] [MainThread]: Command `dbt run` failed at 12:33:58.162629 after 5.24 seconds
[0m12:33:58.162963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc88c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fafcdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13db43c80>]}
[0m12:33:58.163221 [debug] [MainThread]: Flushing usage events
[0m12:33:58.619714 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:34:12.759103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0705c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f8a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f8740>]}


============================== 12:34:12.762190 | 577f7a66-291b-420f-b7a7-0b70166aad62 ==============================
[0m12:34:12.762190 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:34:12.762546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:34:13.389303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '577f7a66-291b-420f-b7a7-0b70166aad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f3fe870>]}
[0m12:34:13.423201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '577f7a66-291b-420f-b7a7-0b70166aad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e4a32c0>]}
[0m12:34:13.423514 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:34:13.513482 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:34:13.565789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:34:13.566019 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:34:13.583667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '577f7a66-291b-420f-b7a7-0b70166aad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f622840>]}
[0m12:34:13.619510 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m12:34:13.621832 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m12:34:13.680041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '577f7a66-291b-420f-b7a7-0b70166aad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134c3bbf0>]}
[0m12:34:13.680334 [info ] [MainThread]: Found 5 models, 3 data tests, 489 macros
[0m12:34:13.680506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '577f7a66-291b-420f-b7a7-0b70166aad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0710d0>]}
[0m12:34:13.681383 [info ] [MainThread]: 
[0m12:34:13.681547 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:34:13.681679 [info ] [MainThread]: 
[0m12:34:13.681912 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:34:13.683807 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m12:34:13.684004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:14.050662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now list_opensource-marketing-dwh_dbt_transformations_new)
[0m12:34:14.051672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:34:14.360153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '577f7a66-291b-420f-b7a7-0b70166aad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f3c6270>]}
[0m12:34:14.361368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:34:14.365864 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.stg_shopify__orders
[0m12:34:14.366770 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_transformations_new.stg_shopify__orders ........ [RUN]
[0m12:34:14.367419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now model.online_shop_dbt.stg_shopify__orders)
[0m12:34:14.367928 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.stg_shopify__orders
[0m12:34:14.377871 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.stg_shopify__orders"
[0m12:34:14.378852 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.stg_shopify__orders
[0m12:34:14.409237 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.stg_shopify__orders"
[0m12:34:14.410198 [debug] [Thread-1 (]: On model.online_shop_dbt.stg_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.stg_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  OPTIONS()
  as WITH shopify AS (
    SELECT * FROM opensource-marketing-dwh.shopify.shopify_orders
),

-- removes columns that are not needed at the moment
filter_source AS (
    SELECT
        id AS order_id,
        customer_id,
        -- app_id,
        -- cancel_reason,
        -- totals
        total_discounts,
        total_line_items_price,
        total_price,
        -- total_price_usd,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
        -- total_tip_received,

        -- cart_token,
        -- checkout_id,
        -- checkout_token,
        -- timestamps
        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        -- client details
        -- client_details_accept_language,
        -- client_details_browser_height,
        -- client_details_browser_ip,
        -- client_details_browser_width,
        -- client_details_session_hash,
        -- client_details_user_agent,
        -- confirmed,
        -- currency,
        -- customer_accepts_marketing,
        -- customer_accepts_marketing_updated_at,
        -- customer_created_at,
        -- customer_uid,
        -- customer_locale,
        -- customer_multipass_identifier,
        -- customer_note,
        -- customer_state,
        -- customer_tags,
        -- customer_tax_exempt,
        -- customer_total_spent,
        -- customer_updated_at,
        -- device_id,
        -- discount application
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        -- financial_status,
        -- fulfillment_status,
        -- gateway,
        -- uid,
        landing_site,
        -- landing_site_ref,
        -- fulfillments_location_id,
        -- fulfillments_line_item_id,
        -- line items
        -- line_item_discount_allocations_amount,
        -- line_item_discount_allocations_application_index,
        -- line_item_fulfillable_quantity,
        -- line_item_fulfillment_service,
        -- line_item_fulfillment_status,
        -- line_item_gift_card,
        -- line_item_grams,
        -- line_item_id,
        -- line_item_uid,
        -- line_item_name,
        -- line_item_price,
        -- line_item_product_exists,
        -- line_item_product_id,
        -- line_item_product_uid,
        -- line_item_properties,
        -- line_item_quantity,
        -- line_item_requires_shipping,
        -- line_item_sku,
        -- line_item_tax_lines_price,
        -- line_item_tax_lines_rate,
        -- line_item_tax_lines_title,
        -- line_item_taxable,
        -- line_item_title,
        -- line_item_variant_id,
        -- line_item_variant_uid,
        -- line_item_vendor,
        -- line_item_variant_inventory_management,
        -- line_item_variant_title,
        -- location_id,
        -- name,
        -- note,
        -- number,
        -- order adjustment
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        -- order_number,
        -- order_status_url,
        -- payment_details_avs_result_code,
        -- payment_details_credit_card_company,
        payment_gateway_names,
        presentment_currency,
        -- processing_method,
        -- reference,
        referring_site,
        -- refunds
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        -- shipping address
        -- shipping_address_city,
        -- shipping_address_country,
        -- shipping_address_country_code,
        -- shipping_address_province,
        -- shipping_address_province_code,
        -- shipping_address_zip,
        -- shipping_line_code,
        -- billing_address_city,
        -- billing_address_zip,
        billing_address_country_code, -- billing address is relevant to see where the money goes to
        -- shipping
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,

        -- source_identifier,
        -- source_name,
        -- source_url,
        -- tags,

        -- tax
        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
        -- token,
        -- total_weight,
        -- user_id,
        -- record_timestamp
    FROM shopify
    -- we want to remove test orders
    WHERE test IS false
)

SELECT * FROM filter_source;


[0m12:34:14.410759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:14.857464 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:09eb8dd6-fd08-44c7-be74-7c22e5a9bd3f&page=queryresults
[0m12:34:15.270002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '577f7a66-291b-420f-b7a7-0b70166aad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108934980>]}
[0m12:34:15.270498 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_transformations_new.stg_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m12:34:15.270912 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.stg_shopify__orders
[0m12:34:15.271404 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.int_shopify__order_discount
[0m12:34:15.271754 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_transformations_new.int_shopify__order_discount  [RUN]
[0m12:34:15.272086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.stg_shopify__orders, now model.online_shop_dbt.int_shopify__order_discount)
[0m12:34:15.272301 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.int_shopify__order_discount
[0m12:34:15.274314 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.int_shopify__order_discount"
[0m12:34:15.274754 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.int_shopify__order_discount
[0m12:34:15.276470 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.int_shopify__order_discount"
[0m12:34:15.276955 [debug] [Thread-1 (]: On model.online_shop_dbt.int_shopify__order_discount: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.int_shopify__order_discount"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_discount`
  OPTIONS()
  as WITH
stg_shopify__orders AS (
    SELECT
        order_id,
        customer_id,
        -- the following metrics are just for checks. They do not really belong here
        total_line_items_price,
        total_discounts,
        total_subtotal_price,
        total_shipping_price,
        total_tax,
        total_price,

        -- discounts -- 
        -- This method only works because there are no columns with more than one element in the list (one discount per order).
        -- To handle multiple list elements the array would have to be unnested.
        -- Since this is just a test, i will take the easy route and use regex.
        REGEXP_EXTRACT(discount_application_target_type, r'\[\'([^\']+)\'\]') AS discount_application_target_type,
        REGEXP_EXTRACT(discount_application_allocation_method, r'\[\'([^\']+)\'\]') AS discount_application_allocation_method,
        REGEXP_EXTRACT(discount_application_code, r'\[\'([^\']+)\'\]') AS discount_application_code,
        REGEXP_EXTRACT(discount_application_target_selection, r'\[\'([^\']+)\'\]') AS discount_application_target_selection,
        REGEXP_EXTRACT(discount_application_type, r'\[\'([^\']+)\'\]') AS discount_application_type,
        CAST(REPLACE(REPLACE(discount_application_value, '[', ''), ']', '') AS FLOAT64) AS discount_application_value,

        REGEXP_EXTRACT(discount_application_value_type, r'\[\'([^\']+)\'\]') AS discount_application_value_type,
        REGEXP_EXTRACT(discount_application_title, r'\[\'([^\']+)\'\]') AS discount_application_title,
        REGEXP_EXTRACT(discount_application_description, r'\[\'([^\']+)\'\]') AS discount_application_description,
        REGEXP_EXTRACT(discount_code_code, r'\[\'([^\']+)\'\]') AS discount_code_code,
        REGEXP_EXTRACT(discount_code_type, r'\[\'([^\']+)\'\]') AS discount_code_type,
        CAST(REPLACE(REPLACE(discount_code_amount, '[', ''), ']', '') AS FLOAT64) AS discount_code_amount,
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
    -- only handle discounts in this model
    WHERE total_discounts > 0
)

-- there are different types of discounts
-- if discount_application_target_type = shipping_line, then the discount is only subtracted from the shipping!

SELECT * FROM stg_shopify__orders;


[0m12:34:15.277314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:16.129742 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:23c57abd-1126-4d98-8c33-683240107fe8&page=queryresults
[0m12:34:16.351027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '577f7a66-291b-420f-b7a7-0b70166aad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0710d0>]}
[0m12:34:16.352028 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_transformations_new.int_shopify__order_discount  [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m12:34:16.352664 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.int_shopify__order_discount
[0m12:34:16.353099 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.int_shopify__order_refund
[0m12:34:16.353704 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_transformations_new.int_shopify__order_refund .. [RUN]
[0m12:34:16.354276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.int_shopify__order_discount, now model.online_shop_dbt.int_shopify__order_refund)
[0m12:34:16.354667 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.int_shopify__order_refund
[0m12:34:16.358662 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.int_shopify__order_refund"
[0m12:34:16.359712 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.int_shopify__order_refund
[0m12:34:16.363191 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.int_shopify__order_refund"
[0m12:34:16.364734 [debug] [Thread-1 (]: On model.online_shop_dbt.int_shopify__order_refund: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.int_shopify__order_refund"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_refund`
  OPTIONS()
  as WITH
stg_shopify__orders AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
    
        -- order_adjustment_amount,
        -- order_adjustment_id,
        -- order_adjustment_uid,
        -- order_adjustment_kind,
        -- order_adjustment_reason,
        -- order_adjustment_refund_id,
        -- order_adjustment_refund_uid,
        -- order_adjustment_tax_amount,

        -- line item level is ignored for now       
        -- refund_line_item_created_at,
        -- refund_line_item_order_line_item_id,
        -- refund_line_item_processed_at,
        -- refund_line_item_quantity,
        -- refund_line_item_refund_id,
        -- refund_line_item_refund_line_item_id,
        -- refund_line_item_restock,
        -- refund_line_item_restock_type,

        -- refunds
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
),

extract_refunds AS (
    SELECT
        order_id,
        customer_id,
        -- just for debugging
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
        -- refunds
        CAST(REPLACE(REPLACE(refund_transactions_id, '[', ''), ']', '') AS STRING) AS refund_transactions_id,
        CAST(REPLACE(REPLACE(refund_transactions_amount, '[', ''), ']', '') AS STRING) AS refund_transactions_amount,
        CAST(REPLACE(REPLACE(REPLACE(refund_transactions_created_at, '[', ''), ']', ''),  "'", '') AS STRING) AS refund_transactions_created_at,
        CAST(REPLACE(REPLACE(REPLACE(refund_transactions_kind, '[', ''), ']', ''), "'", '') AS STRING) AS refund_transactions_kind,
        CAST(REPLACE(REPLACE(REPLACE(refund_transactions_status, '[', ''), ']', ''), "'", '') AS STRING) AS refund_transactions_status
    FROM stg_shopify__orders
)

SELECT * FROM extract_refunds
-- exclude non refunds
WHERE refund_transactions_id != '';


[0m12:34:16.365608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:17.051715 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:c36ba1dd-cb26-4c91-8d40-cd4cbf06cd86&page=queryresults
[0m12:34:17.349044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '577f7a66-291b-420f-b7a7-0b70166aad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135bdb710>]}
[0m12:34:17.350332 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_transformations_new.int_shopify__order_refund  [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m12:34:17.351163 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.int_shopify__order_refund
[0m12:34:17.351610 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.int_shopify__orders
[0m12:34:17.352159 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_transformations_new.int_shopify__orders ........ [RUN]
[0m12:34:17.352710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.int_shopify__order_refund, now model.online_shop_dbt.int_shopify__orders)
[0m12:34:17.353112 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.int_shopify__orders
[0m12:34:17.357572 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.int_shopify__orders"
[0m12:34:17.358720 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.int_shopify__orders
[0m12:34:17.362219 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.int_shopify__orders"
[0m12:34:17.363863 [debug] [Thread-1 (]: On model.online_shop_dbt.int_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.int_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__orders`
  OPTIONS()
  as WITH staging AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,

        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        landing_site,
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        payment_gateway_names,
        presentment_currency,
        referring_site,
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,


        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
),

extract_columns AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,

        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        landing_site,
        -- Extract the base URL (before the ?)
        REGEXP_EXTRACT(landing_site, r'^([^?]+)') AS base_url,
        -- Extract the utm_source
        REGEXP_EXTRACT(landing_site, r'utm_source=([^&]+)') AS utm_source,
        -- Extract the utm_medium
        REGEXP_EXTRACT(landing_site, r'utm_medium=([^&]+)') AS utm_medium,

        -- Extract the utm_campaign
        REGEXP_EXTRACT(landing_site, r'utm_campaign=([^&]+)') AS utm_campaign,

        -- Extract the utm_content
        REGEXP_EXTRACT(landing_site, r'utm_content=([^&]+)') AS utm_content,

        -- Extract the utm_term
        REGEXP_EXTRACT(landing_site, r'utm_term=([^&]+)') AS utm_term,

        -- Extract the fbclid
        REGEXP_EXTRACT(landing_site, r'fbclid=([^&]+)') AS fbclid,

        -- Extract the campaign_id
        REGEXP_EXTRACT(landing_site, r'campaign_id=([^&]+)') AS campaign_id,
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        payment_gateway_names,
        presentment_currency,
        referring_site,
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,


        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
    FROM staging
)



SELECT * FROM extract_columns;


[0m12:34:17.364733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:18.135340 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:35a38c57-e902-47d3-9892-0689ad217da7&page=queryresults
[0m12:34:18.446462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '577f7a66-291b-420f-b7a7-0b70166aad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135bfd1f0>]}
[0m12:34:18.447302 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_transformations_new.int_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m12:34:18.448145 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.int_shopify__orders
[0m12:34:18.449122 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.mrt_shopify__orders
[0m12:34:18.449907 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_transformations_new.mrt_shopify__orders ........ [RUN]
[0m12:34:18.450510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.int_shopify__orders, now model.online_shop_dbt.mrt_shopify__orders)
[0m12:34:18.451004 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.mrt_shopify__orders
[0m12:34:18.457393 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.mrt_shopify__orders"
[0m12:34:18.458901 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.mrt_shopify__orders
[0m12:34:18.462508 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.mrt_shopify__orders"
[0m12:34:18.464107 [debug] [Thread-1 (]: On model.online_shop_dbt.mrt_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.mrt_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`mrt_shopify__orders`
  OPTIONS()
  as WITH int_shopify__orders AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,

        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        landing_site,
        base_url,
        utm_source,
        utm_medium,
        utm_campaign,
        utm_content,
        utm_term,
        fbclid,
        campaign_id,
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        payment_gateway_names,
        presentment_currency,
        referring_site,
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,
        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__orders`
),

-- if discount_application_target_type = shipping_line, then the discount is only subtracted from the shipping!
discounts AS (
    SELECT
        order_id,
        discount_application_target_type,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_type,
        discount_application_value,

        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_code,
        discount_code_type,
        discount_code_amount,
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_discount`
),

-- should a refunded shipping be subtracted from our net revenue? Does net rev include shipping? 
refunds AS (
    SELECT
        order_id,
        -- refunds
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_refund`
)

-- total_subtotal_price = total_line_items_price - total_discounts

-- Klar Net Revenue = Gross Revenue - Taxes - Refund Value
-- calculating net_revenue:
--                  total_line_items_price
--                  - total_discounts (careful! This is only valid for discount_application_target_type != shipping_line. See order_id = 6064341483866 for an example.)
--                  ----------------
--                  = total_subtotal_price 
--                      + total_shipping_price
                        -----------------                    
--                          - returns/refunds
--                          -----------------
--                          = net_revenue

-- total_price is what the customer pays
-- total_price = total_line_items_price - total_discounts + total_shipping_price + total_tax
SELECT * FROM int_shopify__orders;


[0m12:34:18.464780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:19.201915 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:256abbf1-e161-4ea9-bea6-7dedad2486c8&page=queryresults
[0m12:34:19.388926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '577f7a66-291b-420f-b7a7-0b70166aad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135b33440>]}
[0m12:34:19.390324 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt_transformations_new.mrt_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m12:34:19.391524 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.mrt_shopify__orders
[0m12:34:19.392697 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:34:19.394440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:19.394747 [debug] [MainThread]: Connection 'model.online_shop_dbt.mrt_shopify__orders' was properly closed.
[0m12:34:19.395094 [info ] [MainThread]: 
[0m12:34:19.395390 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.71 seconds (5.71s).
[0m12:34:19.397267 [debug] [MainThread]: Command end result
[0m12:34:19.425043 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m12:34:19.426596 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m12:34:19.432204 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m12:34:19.432502 [info ] [MainThread]: 
[0m12:34:19.432809 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:34:19.433042 [info ] [MainThread]: 
[0m12:34:19.433284 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:34:19.435793 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.7180986, "process_in_blocks": "0", "process_kernel_time": 0.278062, "process_mem_max_rss": "210190336", "process_out_blocks": "0", "process_user_time": 2.027681}
[0m12:34:19.436087 [debug] [MainThread]: Command `dbt run` succeeded at 12:34:19.436024 after 6.72 seconds
[0m12:34:19.436341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f8a10>]}
[0m12:34:19.436588 [debug] [MainThread]: Flushing usage events
[0m12:34:19.988611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:43.690441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce7740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f8a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f87d0>]}


============================== 12:52:43.693850 | fedbe860-f42e-41f3-9487-18ab2b11b84b ==============================
[0m12:52:43.693850 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:52:43.694181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'version_check': 'True', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:52:44.357312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fedbe860-f42e-41f3-9487-18ab2b11b84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12113faa0>]}
[0m12:52:44.391125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fedbe860-f42e-41f3-9487-18ab2b11b84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbf740>]}
[0m12:52:44.391451 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:52:44.477648 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:52:44.541319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:44.541567 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:44.559610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fedbe860-f42e-41f3-9487-18ab2b11b84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12144faa0>]}
[0m12:52:44.637264 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m12:52:44.639409 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m12:52:44.652148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fedbe860-f42e-41f3-9487-18ab2b11b84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627b560>]}
[0m12:52:44.652406 [info ] [MainThread]: Found 5 models, 5 data tests, 489 macros
[0m12:52:44.652575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fedbe860-f42e-41f3-9487-18ab2b11b84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ba4830>]}
[0m12:52:44.653457 [info ] [MainThread]: 
[0m12:52:44.653623 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:52:44.653754 [info ] [MainThread]: 
[0m12:52:44.653983 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:52:44.655847 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m12:52:44.656044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:45.036282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now list_opensource-marketing-dwh_dbt_transformations_new)
[0m12:52:45.037079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:45.384817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fedbe860-f42e-41f3-9487-18ab2b11b84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121497200>]}
[0m12:52:45.385444 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:45.387980 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.stg_shopify__orders
[0m12:52:45.388608 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_transformations_new.stg_shopify__orders ........ [RUN]
[0m12:52:45.389109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now model.online_shop_dbt.stg_shopify__orders)
[0m12:52:45.389509 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.stg_shopify__orders
[0m12:52:45.400029 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.stg_shopify__orders"
[0m12:52:45.401769 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.stg_shopify__orders
[0m12:52:45.430829 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.stg_shopify__orders"
[0m12:52:45.431775 [debug] [Thread-1 (]: On model.online_shop_dbt.stg_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.stg_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  OPTIONS()
  as WITH shopify AS (
    SELECT * FROM opensource-marketing-dwh.shopify.shopify_orders
),

-- removes columns that are not needed at the moment
filter_source AS (
    SELECT
        id AS order_id,
        customer_id,
        -- app_id,
        -- cancel_reason,
        -- totals
        total_discounts,
        total_line_items_price,
        total_price,
        -- total_price_usd,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
        -- total_tip_received,

        -- cart_token,
        -- checkout_id,
        -- checkout_token,
        -- timestamps
        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        -- client details
        -- client_details_accept_language,
        -- client_details_browser_height,
        -- client_details_browser_ip,
        -- client_details_browser_width,
        -- client_details_session_hash,
        -- client_details_user_agent,
        -- confirmed,
        -- currency,
        -- customer_accepts_marketing,
        -- customer_accepts_marketing_updated_at,
        -- customer_created_at,
        -- customer_uid,
        -- customer_locale,
        -- customer_multipass_identifier,
        -- customer_note,
        -- customer_state,
        -- customer_tags,
        -- customer_tax_exempt,
        -- customer_total_spent,
        -- customer_updated_at,
        -- device_id,
        -- discount application
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        -- financial_status,
        -- fulfillment_status,
        -- gateway,
        -- uid,
        landing_site,
        -- landing_site_ref,
        -- fulfillments_location_id,
        -- fulfillments_line_item_id,
        -- line items
        -- line_item_discount_allocations_amount,
        -- line_item_discount_allocations_application_index,
        -- line_item_fulfillable_quantity,
        -- line_item_fulfillment_service,
        -- line_item_fulfillment_status,
        -- line_item_gift_card,
        -- line_item_grams,
        -- line_item_id,
        -- line_item_uid,
        -- line_item_name,
        -- line_item_price,
        -- line_item_product_exists,
        -- line_item_product_id,
        -- line_item_product_uid,
        -- line_item_properties,
        -- line_item_quantity,
        -- line_item_requires_shipping,
        -- line_item_sku,
        -- line_item_tax_lines_price,
        -- line_item_tax_lines_rate,
        -- line_item_tax_lines_title,
        -- line_item_taxable,
        -- line_item_title,
        -- line_item_variant_id,
        -- line_item_variant_uid,
        -- line_item_vendor,
        -- line_item_variant_inventory_management,
        -- line_item_variant_title,
        -- location_id,
        -- name,
        -- note,
        -- number,
        -- order adjustment
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        -- order_number,
        -- order_status_url,
        -- payment_details_avs_result_code,
        -- payment_details_credit_card_company,
        payment_gateway_names,
        presentment_currency,
        -- processing_method,
        -- reference,
        referring_site,
        -- refunds
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        -- shipping address
        -- shipping_address_city,
        -- shipping_address_country,
        -- shipping_address_country_code,
        -- shipping_address_province,
        -- shipping_address_province_code,
        -- shipping_address_zip,
        -- shipping_line_code,
        -- billing_address_city,
        -- billing_address_zip,
        billing_address_country_code, -- billing address is relevant to see where the money goes to
        -- shipping
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,

        -- source_identifier,
        -- source_name,
        -- source_url,
        -- tags,

        -- tax
        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
        -- token,
        -- total_weight,
        -- user_id,
        -- record_timestamp
    FROM shopify
    -- we want to remove test orders
    WHERE test IS false
)

SELECT * FROM filter_source;


[0m12:52:45.432280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:45.954739 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:1809b15b-e749-48a4-a030-1d6fc6b7088c&page=queryresults
[0m12:52:46.229763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedbe860-f42e-41f3-9487-18ab2b11b84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121496c00>]}
[0m12:52:46.230159 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_transformations_new.stg_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m12:52:46.230466 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.stg_shopify__orders
[0m12:52:46.230897 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.int_shopify__order_discount
[0m12:52:46.231177 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_transformations_new.int_shopify__order_discount  [RUN]
[0m12:52:46.231401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.stg_shopify__orders, now model.online_shop_dbt.int_shopify__order_discount)
[0m12:52:46.231577 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.int_shopify__order_discount
[0m12:52:46.233375 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.int_shopify__order_discount"
[0m12:52:46.233827 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.int_shopify__order_discount
[0m12:52:46.235242 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.int_shopify__order_discount"
[0m12:52:46.235643 [debug] [Thread-1 (]: On model.online_shop_dbt.int_shopify__order_discount: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.int_shopify__order_discount"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_discount`
  OPTIONS()
  as WITH
stg_shopify__orders AS (
    SELECT
        order_id,
        customer_id,
        -- the following metrics are just for checks. They do not really belong here
        total_line_items_price,
        total_discounts,
        total_subtotal_price,
        total_shipping_price,
        total_tax,
        total_price,

        -- discounts -- 
        -- This method only works because there are no columns with more than one element in the list (one discount per order).
        -- To handle multiple list elements the array would have to be unnested.
        -- Since this is just a test, i will take the easy route and use regex.
        REGEXP_EXTRACT(discount_application_target_type, r'\[\'([^\']+)\'\]') AS discount_application_target_type,
        REGEXP_EXTRACT(discount_application_allocation_method, r'\[\'([^\']+)\'\]') AS discount_application_allocation_method,
        REGEXP_EXTRACT(discount_application_code, r'\[\'([^\']+)\'\]') AS discount_application_code,
        REGEXP_EXTRACT(discount_application_target_selection, r'\[\'([^\']+)\'\]') AS discount_application_target_selection,
        REGEXP_EXTRACT(discount_application_type, r'\[\'([^\']+)\'\]') AS discount_application_type,
        CAST(REPLACE(REPLACE(discount_application_value, '[', ''), ']', '') AS FLOAT64) AS discount_application_value,

        REGEXP_EXTRACT(discount_application_value_type, r'\[\'([^\']+)\'\]') AS discount_application_value_type,
        REGEXP_EXTRACT(discount_application_title, r'\[\'([^\']+)\'\]') AS discount_application_title,
        REGEXP_EXTRACT(discount_application_description, r'\[\'([^\']+)\'\]') AS discount_application_description,
        REGEXP_EXTRACT(discount_code_code, r'\[\'([^\']+)\'\]') AS discount_code_code,
        REGEXP_EXTRACT(discount_code_type, r'\[\'([^\']+)\'\]') AS discount_code_type,
        CAST(REPLACE(REPLACE(discount_code_amount, '[', ''), ']', '') AS FLOAT64) AS discount_code_amount,
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
    -- only handle discounts in this model
    WHERE total_discounts > 0
)

-- there are different types of discounts
-- if discount_application_target_type = shipping_line, then the discount is only subtracted from the shipping!

SELECT * FROM stg_shopify__orders;


[0m12:52:46.235902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:46.977607 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:38b05ecc-822e-43d4-afc0-81fcbaab2b56&page=queryresults
[0m12:52:47.240803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedbe860-f42e-41f3-9487-18ab2b11b84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224193a0>]}
[0m12:52:47.242316 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_transformations_new.int_shopify__order_discount  [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m12:52:47.243192 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.int_shopify__order_discount
[0m12:52:47.243640 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.int_shopify__order_refund
[0m12:52:47.244141 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_transformations_new.int_shopify__order_refund .. [RUN]
[0m12:52:47.244619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.int_shopify__order_discount, now model.online_shop_dbt.int_shopify__order_refund)
[0m12:52:47.245120 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.int_shopify__order_refund
[0m12:52:47.249421 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.int_shopify__order_refund"
[0m12:52:47.250902 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.int_shopify__order_refund
[0m12:52:47.256093 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.int_shopify__order_refund"
[0m12:52:47.257719 [debug] [Thread-1 (]: On model.online_shop_dbt.int_shopify__order_refund: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.int_shopify__order_refund"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_refund`
  OPTIONS()
  as WITH
stg_shopify__orders AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
    
        -- order_adjustment_amount,
        -- order_adjustment_id,
        -- order_adjustment_uid,
        -- order_adjustment_kind,
        -- order_adjustment_reason,
        -- order_adjustment_refund_id,
        -- order_adjustment_refund_uid,
        -- order_adjustment_tax_amount,

        -- line item level is ignored for now       
        -- refund_line_item_created_at,
        -- refund_line_item_order_line_item_id,
        -- refund_line_item_processed_at,
        -- refund_line_item_quantity,
        -- refund_line_item_refund_id,
        -- refund_line_item_refund_line_item_id,
        -- refund_line_item_restock,
        -- refund_line_item_restock_type,

        -- refunds
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
),

extract_refunds AS (
    SELECT
        order_id,
        customer_id,
        -- just for debugging
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
        -- refunds
        CAST(REPLACE(REPLACE(refund_transactions_id, '[', ''), ']', '') AS STRING) AS refund_transactions_id,
        CAST(REPLACE(REPLACE(refund_transactions_amount, '[', ''), ']', '') AS STRING) AS refund_transactions_amount,
        CAST(REPLACE(REPLACE(REPLACE(refund_transactions_created_at, '[', ''), ']', ''),  "'", '') AS STRING) AS refund_transactions_created_at,
        CAST(REPLACE(REPLACE(REPLACE(refund_transactions_kind, '[', ''), ']', ''), "'", '') AS STRING) AS refund_transactions_kind,
        CAST(REPLACE(REPLACE(REPLACE(refund_transactions_status, '[', ''), ']', ''), "'", '') AS STRING) AS refund_transactions_status
    FROM stg_shopify__orders
)

SELECT * FROM extract_refunds
-- exclude non refunds
WHERE refund_transactions_id != '';


[0m12:52:47.258429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:48.000662 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:1ebd9dd3-5a98-468c-ab39-fb569dbe0429&page=queryresults
[0m12:52:48.238199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedbe860-f42e-41f3-9487-18ab2b11b84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224e86b0>]}
[0m12:52:48.239381 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_transformations_new.int_shopify__order_refund  [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m12:52:48.240226 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.int_shopify__order_refund
[0m12:52:48.240761 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.int_shopify__orders
[0m12:52:48.241270 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_transformations_new.int_shopify__orders ........ [RUN]
[0m12:52:48.241808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.int_shopify__order_refund, now model.online_shop_dbt.int_shopify__orders)
[0m12:52:48.242436 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.int_shopify__orders
[0m12:52:48.247746 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.int_shopify__orders"
[0m12:52:48.248904 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.int_shopify__orders
[0m12:52:48.251989 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.int_shopify__orders"
[0m12:52:48.253098 [debug] [Thread-1 (]: On model.online_shop_dbt.int_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.int_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__orders`
  OPTIONS()
  as WITH staging AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,

        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        landing_site,
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        payment_gateway_names,
        presentment_currency,
        referring_site,
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,


        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
),

extract_columns AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,

        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        landing_site,
        -- Extract the base URL (before the ?)
        REGEXP_EXTRACT(landing_site, r'^([^?]+)') AS base_url,
        -- Extract the utm_source
        REGEXP_EXTRACT(landing_site, r'utm_source=([^&]+)') AS utm_source,
        -- Extract the utm_medium
        REGEXP_EXTRACT(landing_site, r'utm_medium=([^&]+)') AS utm_medium,

        -- Extract the utm_campaign
        REGEXP_EXTRACT(landing_site, r'utm_campaign=([^&]+)') AS utm_campaign,

        -- Extract the utm_content
        REGEXP_EXTRACT(landing_site, r'utm_content=([^&]+)') AS utm_content,

        -- Extract the utm_term
        REGEXP_EXTRACT(landing_site, r'utm_term=([^&]+)') AS utm_term,

        -- Extract the fbclid
        REGEXP_EXTRACT(landing_site, r'fbclid=([^&]+)') AS fbclid,

        -- Extract the campaign_id
        REGEXP_EXTRACT(landing_site, r'campaign_id=([^&]+)') AS campaign_id,
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        payment_gateway_names,
        presentment_currency,
        referring_site,
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,


        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
    FROM staging
)



SELECT * FROM extract_columns;


[0m12:52:48.254431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:49.027670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:6b34a480-f002-4547-89f6-d16b69d6d490&page=queryresults
[0m12:52:49.277918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedbe860-f42e-41f3-9487-18ab2b11b84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224de960>]}
[0m12:52:49.279264 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_transformations_new.int_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m12:52:49.280620 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.int_shopify__orders
[0m12:52:49.281326 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.mrt_shopify__orders
[0m12:52:49.281997 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_transformations_new.mrt_shopify__orders ........ [RUN]
[0m12:52:49.282560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.int_shopify__orders, now model.online_shop_dbt.mrt_shopify__orders)
[0m12:52:49.282949 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.mrt_shopify__orders
[0m12:52:49.288422 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.mrt_shopify__orders"
[0m12:52:49.289607 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.mrt_shopify__orders
[0m12:52:49.293093 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.mrt_shopify__orders"
[0m12:52:49.294229 [debug] [Thread-1 (]: On model.online_shop_dbt.mrt_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.mrt_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`mrt_shopify__orders`
  OPTIONS()
  as WITH int_shopify__orders AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,

        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        landing_site,
        base_url,
        utm_source,
        utm_medium,
        utm_campaign,
        utm_content,
        utm_term,
        fbclid,
        campaign_id,
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        payment_gateway_names,
        presentment_currency,
        referring_site,
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,
        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__orders`
),

-- if discount_application_target_type = shipping_line, then the discount is only subtracted from the shipping!
discounts AS (
    SELECT
        order_id,
        discount_application_target_type,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_type,
        discount_application_value,

        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_code,
        discount_code_type,
        discount_code_amount,
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_discount`
),

-- should a refunded shipping be subtracted from our net revenue? Does net rev include shipping? 
-- should refunds be added to the (day of the) order or later to the day of the refund?
refunds AS (
    SELECT
        order_id,
        -- refunds
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_refund`
)

-- total_subtotal_price = total_line_items_price - total_discounts
-- Klar Definition: Net Revenue = Gross Revenue - Taxes - Refund Value

-- calculating net_revenue:
--                  total_line_items_price
--                  - total_discounts (careful! This is only valid for discount_application_target_type != shipping_line. See order_id = 6064341483866 for an example.)
--                  ----------------
--                  = total_subtotal_price 
--                      + total_shipping_price
                        -----------------                    
--                          - returns/refunds
--                          -----------------
--                          = net_revenue

-- total_price is what the customer pays
-- total_price = total_line_items_price - total_discounts + total_shipping_price + total_tax
SELECT * FROM int_shopify__orders;


[0m12:52:49.294913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:50.051233 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:1dec78e9-447e-4552-96d1-efdee5dfd010&page=queryresults
[0m12:52:50.344258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fedbe860-f42e-41f3-9487-18ab2b11b84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224dede0>]}
[0m12:52:50.345621 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt_transformations_new.mrt_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m12:52:50.346642 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.mrt_shopify__orders
[0m12:52:50.348076 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:50.349949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:50.350338 [debug] [MainThread]: Connection 'model.online_shop_dbt.mrt_shopify__orders' was properly closed.
[0m12:52:50.350789 [info ] [MainThread]: 
[0m12:52:50.351203 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m12:52:50.352923 [debug] [MainThread]: Command end result
[0m12:52:50.382748 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m12:52:50.384295 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m12:52:50.389366 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m12:52:50.389619 [info ] [MainThread]: 
[0m12:52:50.389891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:50.390105 [info ] [MainThread]: 
[0m12:52:50.390331 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:52:50.393033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.744491, "process_in_blocks": "0", "process_kernel_time": 0.269216, "process_mem_max_rss": "210485248", "process_out_blocks": "0", "process_user_time": 1.942167}
[0m12:52:50.393496 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:50.393397 after 6.75 seconds
[0m12:52:50.393809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f8a40>]}
[0m12:52:50.394099 [debug] [MainThread]: Flushing usage events
[0m12:52:50.993218 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:47.231815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066612e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf8a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf8740>]}


============================== 13:16:47.235297 | 13748ffb-8117-419c-81a0-a69535f71f0e ==============================
[0m13:16:47.235297 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:16:47.235644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:16:47.901491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13748ffb-8117-419c-81a0-a69535f71f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131317080>]}
[0m13:16:47.935635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13748ffb-8117-419c-81a0-a69535f71f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eaf830>]}
[0m13:16:47.935959 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:16:48.023866 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m13:16:48.094398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:16:48.094708 [debug] [MainThread]: Partial parsing: added file: online_shop_dbt://online_shop_dbt/tests/test_total_price.sql
[0m13:16:48.232326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13748ffb-8117-419c-81a0-a69535f71f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9b920>]}
[0m13:16:48.273168 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m13:16:48.275596 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m13:16:48.289256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13748ffb-8117-419c-81a0-a69535f71f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13192d400>]}
[0m13:16:48.289526 [info ] [MainThread]: Found 5 models, 8 data tests, 489 macros
[0m13:16:48.289693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13748ffb-8117-419c-81a0-a69535f71f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1318fede0>]}
[0m13:16:48.290602 [info ] [MainThread]: 
[0m13:16:48.290781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:48.290921 [info ] [MainThread]: 
[0m13:16:48.291151 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:16:48.293024 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m13:16:48.293219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:48.773825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now list_opensource-marketing-dwh_dbt_transformations_new)
[0m13:16:48.775046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:49.102991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13748ffb-8117-419c-81a0-a69535f71f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131cafe30>]}
[0m13:16:49.104124 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:16:49.107819 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.stg_shopify__orders
[0m13:16:49.108401 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_transformations_new.stg_shopify__orders ........ [RUN]
[0m13:16:49.108933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now model.online_shop_dbt.stg_shopify__orders)
[0m13:16:49.109429 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.stg_shopify__orders
[0m13:16:49.119088 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.stg_shopify__orders"
[0m13:16:49.120796 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.stg_shopify__orders
[0m13:16:49.151187 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.stg_shopify__orders"
[0m13:16:49.152215 [debug] [Thread-1 (]: On model.online_shop_dbt.stg_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.stg_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  OPTIONS()
  as WITH shopify AS (
    SELECT * FROM opensource-marketing-dwh.shopify.shopify_orders
),

-- removes columns that are not needed at the moment
filter_source AS (
    SELECT
        id AS order_id,
        customer_id,
        -- app_id,
        -- cancel_reason,
        -- totals
        total_discounts,
        total_line_items_price,
        total_price,
        -- total_price_usd,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
        -- total_tip_received,

        -- cart_token,
        -- checkout_id,
        -- checkout_token,
        -- timestamps
        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        -- client details
        -- client_details_accept_language,
        -- client_details_browser_height,
        -- client_details_browser_ip,
        -- client_details_browser_width,
        -- client_details_session_hash,
        -- client_details_user_agent,
        -- confirmed,
        -- currency,
        -- customer_accepts_marketing,
        -- customer_accepts_marketing_updated_at,
        -- customer_created_at,
        -- customer_uid,
        -- customer_locale,
        -- customer_multipass_identifier,
        -- customer_note,
        -- customer_state,
        -- customer_tags,
        -- customer_tax_exempt,
        -- customer_total_spent,
        -- customer_updated_at,
        -- device_id,
        -- discount application
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        -- financial_status,
        -- fulfillment_status,
        -- gateway,
        -- uid,
        landing_site,
        -- landing_site_ref,
        -- fulfillments_location_id,
        -- fulfillments_line_item_id,
        -- line items
        -- line_item_discount_allocations_amount,
        -- line_item_discount_allocations_application_index,
        -- line_item_fulfillable_quantity,
        -- line_item_fulfillment_service,
        -- line_item_fulfillment_status,
        -- line_item_gift_card,
        -- line_item_grams,
        -- line_item_id,
        -- line_item_uid,
        -- line_item_name,
        -- line_item_price,
        -- line_item_product_exists,
        -- line_item_product_id,
        -- line_item_product_uid,
        -- line_item_properties,
        -- line_item_quantity,
        -- line_item_requires_shipping,
        -- line_item_sku,
        -- line_item_tax_lines_price,
        -- line_item_tax_lines_rate,
        -- line_item_tax_lines_title,
        -- line_item_taxable,
        -- line_item_title,
        -- line_item_variant_id,
        -- line_item_variant_uid,
        -- line_item_vendor,
        -- line_item_variant_inventory_management,
        -- line_item_variant_title,
        -- location_id,
        -- name,
        -- note,
        -- number,
        -- order adjustment
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        -- order_number,
        -- order_status_url,
        -- payment_details_avs_result_code,
        -- payment_details_credit_card_company,
        payment_gateway_names,
        presentment_currency,
        -- processing_method,
        -- reference,
        referring_site,
        -- refunds
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        -- shipping address
        -- shipping_address_city,
        -- shipping_address_country,
        -- shipping_address_country_code,
        -- shipping_address_province,
        -- shipping_address_province_code,
        -- shipping_address_zip,
        -- shipping_line_code,
        -- billing_address_city,
        -- billing_address_zip,
        billing_address_country_code, -- billing address is relevant to see where the money goes to
        -- shipping
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,

        -- source_identifier,
        -- source_name,
        -- source_url,
        -- tags,

        -- tax
        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
        -- token,
        -- total_weight,
        -- user_id,
        -- record_timestamp
    FROM shopify
    -- we want to remove test orders
    WHERE test IS false
)

SELECT * FROM filter_source;


[0m13:16:49.152764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:49.710196 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:2e59da08-23bb-46b5-b9bd-938db39a16ab&page=queryresults
[0m13:16:50.092505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13748ffb-8117-419c-81a0-a69535f71f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662c860>]}
[0m13:16:50.092991 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_transformations_new.stg_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m13:16:50.093432 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.stg_shopify__orders
[0m13:16:50.093944 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.int_shopify__order_discount
[0m13:16:50.094279 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_transformations_new.int_shopify__order_discount  [RUN]
[0m13:16:50.094559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.stg_shopify__orders, now model.online_shop_dbt.int_shopify__order_discount)
[0m13:16:50.094774 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.int_shopify__order_discount
[0m13:16:50.096843 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.int_shopify__order_discount"
[0m13:16:50.097604 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.int_shopify__order_discount
[0m13:16:50.099429 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.int_shopify__order_discount"
[0m13:16:50.099927 [debug] [Thread-1 (]: On model.online_shop_dbt.int_shopify__order_discount: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.int_shopify__order_discount"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_discount`
  OPTIONS()
  as WITH
stg_shopify__orders AS (
    SELECT
        order_id,
        customer_id,
        -- the following metrics are just for checks. They do not really belong here
        total_line_items_price,
        total_discounts,
        total_subtotal_price,
        total_shipping_price,
        total_tax,
        total_price,

        -- discounts -- 
        -- This method only works because there are no columns with more than one element in the list (one discount per order).
        -- To handle multiple list elements the array would have to be unnested.
        -- Since this is just a test, i will take the easy route and use regex.
        REGEXP_EXTRACT(discount_application_target_type, r'\[\'([^\']+)\'\]') AS discount_application_target_type,
        REGEXP_EXTRACT(discount_application_allocation_method, r'\[\'([^\']+)\'\]') AS discount_application_allocation_method,
        REGEXP_EXTRACT(discount_application_code, r'\[\'([^\']+)\'\]') AS discount_application_code,
        REGEXP_EXTRACT(discount_application_target_selection, r'\[\'([^\']+)\'\]') AS discount_application_target_selection,
        REGEXP_EXTRACT(discount_application_type, r'\[\'([^\']+)\'\]') AS discount_application_type,
        CAST(REPLACE(REPLACE(discount_application_value, '[', ''), ']', '') AS FLOAT64) AS discount_application_value,

        REGEXP_EXTRACT(discount_application_value_type, r'\[\'([^\']+)\'\]') AS discount_application_value_type,
        REGEXP_EXTRACT(discount_application_title, r'\[\'([^\']+)\'\]') AS discount_application_title,
        REGEXP_EXTRACT(discount_application_description, r'\[\'([^\']+)\'\]') AS discount_application_description,
        REGEXP_EXTRACT(discount_code_code, r'\[\'([^\']+)\'\]') AS discount_code_code,
        REGEXP_EXTRACT(discount_code_type, r'\[\'([^\']+)\'\]') AS discount_code_type,
        CAST(REPLACE(REPLACE(discount_code_amount, '[', ''), ']', '') AS FLOAT64) AS discount_code_amount,
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
    -- only handle discounts in this model
    WHERE total_discounts > 0
)

-- there are different types of discounts
-- if discount_application_target_type = shipping_line, then the discount is only subtracted from the shipping!

SELECT * FROM stg_shopify__orders;


[0m13:16:50.100316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:50.834409 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:04fe4835-804c-4cf8-9d3d-9a5f64270e9e&page=queryresults
[0m13:16:51.121945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13748ffb-8117-419c-81a0-a69535f71f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1319b92b0>]}
[0m13:16:51.123283 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_transformations_new.int_shopify__order_discount  [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m13:16:51.124056 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.int_shopify__order_discount
[0m13:16:51.124486 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.int_shopify__order_refund
[0m13:16:51.125055 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_transformations_new.int_shopify__order_refund .. [RUN]
[0m13:16:51.125615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.int_shopify__order_discount, now model.online_shop_dbt.int_shopify__order_refund)
[0m13:16:51.126011 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.int_shopify__order_refund
[0m13:16:51.130169 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.int_shopify__order_refund"
[0m13:16:51.132116 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.int_shopify__order_refund
[0m13:16:51.134447 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.int_shopify__order_refund"
[0m13:16:51.135447 [debug] [Thread-1 (]: On model.online_shop_dbt.int_shopify__order_refund: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.int_shopify__order_refund"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_refund`
  OPTIONS()
  as WITH
stg_shopify__orders AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
    
        -- order_adjustment_amount,
        -- order_adjustment_id,
        -- order_adjustment_uid,
        -- order_adjustment_kind,
        -- order_adjustment_reason,
        -- order_adjustment_refund_id,
        -- order_adjustment_refund_uid,
        -- order_adjustment_tax_amount,

        -- line item level is ignored for now       
        -- refund_line_item_created_at,
        -- refund_line_item_order_line_item_id,
        -- refund_line_item_processed_at,
        -- refund_line_item_quantity,
        -- refund_line_item_refund_id,
        -- refund_line_item_refund_line_item_id,
        -- refund_line_item_restock,
        -- refund_line_item_restock_type,

        -- refunds
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
),

extract_refunds AS (
    SELECT
        order_id,
        customer_id,
        -- just for debugging
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,
        -- refunds
        CAST(REPLACE(REPLACE(refund_transactions_id, '[', ''), ']', '') AS STRING) AS refund_transactions_id,
        CAST(REPLACE(REPLACE(refund_transactions_amount, '[', ''), ']', '') AS STRING) AS refund_transactions_amount,
        CAST(REPLACE(REPLACE(REPLACE(refund_transactions_created_at, '[', ''), ']', ''),  "'", '') AS STRING) AS refund_transactions_created_at,
        CAST(REPLACE(REPLACE(REPLACE(refund_transactions_kind, '[', ''), ']', ''), "'", '') AS STRING) AS refund_transactions_kind,
        CAST(REPLACE(REPLACE(REPLACE(refund_transactions_status, '[', ''), ']', ''), "'", '') AS STRING) AS refund_transactions_status
    FROM stg_shopify__orders
)

SELECT * FROM extract_refunds
-- exclude non refunds
WHERE refund_transactions_id != '';


[0m13:16:51.136238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:51.860491 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:c54c8749-5797-4b60-8f22-5b91c394d0a6&page=queryresults
[0m13:16:52.164315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13748ffb-8117-419c-81a0-a69535f71f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1366b44a0>]}
[0m13:16:52.165646 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_transformations_new.int_shopify__order_refund  [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m13:16:52.166421 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.int_shopify__order_refund
[0m13:16:52.166843 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.int_shopify__orders
[0m13:16:52.167332 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_transformations_new.int_shopify__orders ........ [RUN]
[0m13:16:52.167810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.int_shopify__order_refund, now model.online_shop_dbt.int_shopify__orders)
[0m13:16:52.168174 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.int_shopify__orders
[0m13:16:52.173228 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.int_shopify__orders"
[0m13:16:52.175377 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.int_shopify__orders
[0m13:16:52.178918 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.int_shopify__orders"
[0m13:16:52.180724 [debug] [Thread-1 (]: On model.online_shop_dbt.int_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.int_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__orders`
  OPTIONS()
  as WITH staging AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,

        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        landing_site,
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        payment_gateway_names,
        presentment_currency,
        referring_site,
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,


        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
),

extract_columns AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,

        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        landing_site,
        -- Extract the base URL (before the ?)
        REGEXP_EXTRACT(landing_site, r'^([^?]+)') AS base_url,
        -- Extract the utm_source
        REGEXP_EXTRACT(landing_site, r'utm_source=([^&]+)') AS utm_source,
        -- Extract the utm_medium
        REGEXP_EXTRACT(landing_site, r'utm_medium=([^&]+)') AS utm_medium,

        -- Extract the utm_campaign
        REGEXP_EXTRACT(landing_site, r'utm_campaign=([^&]+)') AS utm_campaign,

        -- Extract the utm_content
        REGEXP_EXTRACT(landing_site, r'utm_content=([^&]+)') AS utm_content,

        -- Extract the utm_term
        REGEXP_EXTRACT(landing_site, r'utm_term=([^&]+)') AS utm_term,

        -- Extract the fbclid
        REGEXP_EXTRACT(landing_site, r'fbclid=([^&]+)') AS fbclid,

        -- Extract the campaign_id
        REGEXP_EXTRACT(landing_site, r'campaign_id=([^&]+)') AS campaign_id,
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        payment_gateway_names,
        presentment_currency,
        referring_site,
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,


        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test,
    FROM staging
)



SELECT * FROM extract_columns;


[0m13:16:52.181664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:52.987016 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:e27c88e8-ae8d-4c01-91e6-138798adcbbf&page=queryresults
[0m13:16:53.303815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13748ffb-8117-419c-81a0-a69535f71f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1366b6b40>]}
[0m13:16:53.304385 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_transformations_new.int_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m13:16:53.304785 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.int_shopify__orders
[0m13:16:53.305274 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.mrt_shopify__orders
[0m13:16:53.305785 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_transformations_new.mrt_shopify__orders ........ [RUN]
[0m13:16:53.306476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.online_shop_dbt.int_shopify__orders, now model.online_shop_dbt.mrt_shopify__orders)
[0m13:16:53.307008 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.mrt_shopify__orders
[0m13:16:53.313169 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.mrt_shopify__orders"
[0m13:16:53.315349 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.mrt_shopify__orders
[0m13:16:53.321449 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.mrt_shopify__orders"
[0m13:16:53.322776 [debug] [Thread-1 (]: On model.online_shop_dbt.mrt_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.mrt_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`mrt_shopify__orders`
  OPTIONS()
  as WITH orders AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,

        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        landing_site,
        base_url,
        utm_source,
        utm_medium,
        utm_campaign,
        utm_content,
        utm_term,
        fbclid,
        campaign_id,
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        payment_gateway_names,
        presentment_currency,
        referring_site,
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,
        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__orders`
),

-- if discount_application_target_type = shipping_line, then the discount is only subtracted from the shipping!
discounts AS (
    SELECT
        order_id,
        discount_application_target_type,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_type,
        discount_application_value,

        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_code,
        discount_code_type,
        discount_code_amount,
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_discount`
),

-- should a refunded shipping be subtracted from our net revenue? Does net rev include shipping? 
-- should refunds be added to the (day of the) order or later to the day of the refund?
refunds AS (
    SELECT
        order_id,
        -- refunds
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_refund`
),

joined AS (
    SELECT
        -- orders
        orders.order_id,
        orders.customer_id,
        orders.total_discounts,
        orders.total_line_items_price,
        orders.total_price,
        orders.total_shipping_price,
        orders.total_subtotal_price,
        orders.total_tax,
        orders.created_at,
        orders.cancelled_at,
        orders.closed_at,
        orders.processed_at,
        orders.updated_at,
        -- discounts
        discounts.discount_code_code,
        -- there are different kinds of discounts. Shipping discounts are only subtracted from shipping!
        CASE WHEN discounts.discount_application_target_type = 'shipping_line' THEN discounts.discount_code_amount ELSE 0 END AS shipping_discount,
        CASE WHEN discounts.discount_application_target_type = 'line_item' THEN discounts.discount_code_amount ELSE 0 END AS line_item_discount
    FROM orders
    LEFT JOIN discounts
    ON orders.order_id = discounts.order_id
)


-- coalesce joined columns
-- create cte for business logic

-- Klar Definition: Net Revenue = Gross Revenue - Taxes - Refund Value

-- calculating net_revenue:
--                  total_line_items_price
--                  - total_discounts (careful! This is only valid for discount_application_target_type != shipping_line. See order_id = 6064341483866 for an example.)
--                  ----------------
--                  = total_subtotal_price 
--                      + total_shipping_price
                        -----------------                    
--                          - returns/refunds
--                          -----------------
--                          = net_revenue

-- total_price is what the customer pays
-- total_price = total_line_items_price - total_discounts + total_shipping_price + total_tax
SELECT * FROM joined;


[0m13:16:53.323556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:54.113640 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:71eeca1b-9473-482a-9ed4-5d7a327748c9&page=queryresults
[0m13:16:54.329264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13748ffb-8117-419c-81a0-a69535f71f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13675eff0>]}
[0m13:16:54.330184 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt_transformations_new.mrt_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m13:16:54.330809 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.mrt_shopify__orders
[0m13:16:54.332003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:16:54.334094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:54.334510 [debug] [MainThread]: Connection 'model.online_shop_dbt.mrt_shopify__orders' was properly closed.
[0m13:16:54.335009 [info ] [MainThread]: 
[0m13:16:54.335426 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.04 seconds (6.04s).
[0m13:16:54.337042 [debug] [MainThread]: Command end result
[0m13:16:54.365572 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m13:16:54.367164 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m13:16:54.372412 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m13:16:54.372671 [info ] [MainThread]: 
[0m13:16:54.372942 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:16:54.373153 [info ] [MainThread]: 
[0m13:16:54.373374 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:16:54.375870 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.1864204, "process_in_blocks": "0", "process_kernel_time": 0.290307, "process_mem_max_rss": "214155264", "process_out_blocks": "0", "process_user_time": 2.079125}
[0m13:16:54.376232 [debug] [MainThread]: Command `dbt run` succeeded at 13:16:54.376159 after 7.19 seconds
[0m13:16:54.376506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf8980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120cf71a0>]}
[0m13:16:54.376781 [debug] [MainThread]: Flushing usage events
[0m13:16:54.973050 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:01.592493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e771a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f4bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f4950>]}


============================== 13:17:01.594730 | f02e6d04-1e2f-4fa1-b65f-3fda366f2a6c ==============================
[0m13:17:01.594730 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:17:01.595050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:17:02.185773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f02e6d04-1e2f-4fa1-b65f-3fda366f2a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031bb4d0>]}
[0m13:17:02.219807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f02e6d04-1e2f-4fa1-b65f-3fda366f2a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130978170>]}
[0m13:17:02.220531 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:17:02.314482 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m13:17:02.382258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:17:02.382536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:17:02.403199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f02e6d04-1e2f-4fa1-b65f-3fda366f2a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13099a090>]}
[0m13:17:02.486369 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m13:17:02.488179 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m13:17:02.507795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f02e6d04-1e2f-4fa1-b65f-3fda366f2a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105672c90>]}
[0m13:17:02.508073 [info ] [MainThread]: Found 5 models, 8 data tests, 489 macros
[0m13:17:02.508240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f02e6d04-1e2f-4fa1-b65f-3fda366f2a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13092f4d0>]}
[0m13:17:02.509209 [info ] [MainThread]: 
[0m13:17:02.509385 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:17:02.509519 [info ] [MainThread]: 
[0m13:17:02.509746 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:17:02.511651 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh_dbt_transformations_new'
[0m13:17:02.511830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:02.825695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f02e6d04-1e2f-4fa1-b65f-3fda366f2a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10335c650>]}
[0m13:17:02.826439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:17:02.829238 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7
[0m13:17:02.829694 [info ] [Thread-1 (]: 1 of 8 START test not_null_int_shopify__order_discount__order_id_ .............. [RUN]
[0m13:17:02.830138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7)
[0m13:17:02.830490 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7
[0m13:17:02.853127 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7"
[0m13:17:02.854172 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7
[0m13:17:02.872137 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7"
[0m13:17:02.872872 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select `order_id`
from `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_discount`
where `order_id` is null



      
    ) dbt_internal_test
[0m13:17:02.873207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:03.796149 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:a767a4df-4033-4786-a126-2debfb6a9cb4&page=queryresults
[0m13:17:04.317816 [info ] [Thread-1 (]: 1 of 8 PASS not_null_int_shopify__order_discount__order_id_ .................... [[32mPASS[0m in 1.49s]
[0m13:17:04.318567 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7
[0m13:17:04.319153 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b
[0m13:17:04.319815 [info ] [Thread-1 (]: 2 of 8 START test not_null_int_shopify__order_refund__order_id_ ................ [RUN]
[0m13:17:04.320543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7, now test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b)
[0m13:17:04.321083 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b
[0m13:17:04.328632 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b"
[0m13:17:04.329544 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b
[0m13:17:04.332211 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b"
[0m13:17:04.333105 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select `order_id`
from `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_refund`
where `order_id` is null



      
    ) dbt_internal_test
[0m13:17:04.333518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:05.183909 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:609aba2f-7277-4498-8209-141b1e6daa6f&page=queryresults
[0m13:17:05.637336 [info ] [Thread-1 (]: 2 of 8 PASS not_null_int_shopify__order_refund__order_id_ ...................... [[32mPASS[0m in 1.32s]
[0m13:17:05.639162 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b
[0m13:17:05.639801 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837
[0m13:17:05.640276 [info ] [Thread-1 (]: 3 of 8 START test not_null_stg_shopify__orders_customer_id ..................... [RUN]
[0m13:17:05.640828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b, now test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837)
[0m13:17:05.641241 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837
[0m13:17:05.646983 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837"
[0m13:17:05.649679 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837
[0m13:17:05.652687 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837"
[0m13:17:05.653519 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where customer_id is null



      
    ) dbt_internal_test
[0m13:17:05.653922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:06.241644 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:23f11707-f3e1-4dfd-b477-3d0e4662c2a8&page=queryresults
[0m13:17:06.650240 [info ] [Thread-1 (]: 3 of 8 PASS not_null_stg_shopify__orders_customer_id ........................... [[32mPASS[0m in 1.01s]
[0m13:17:06.651887 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837
[0m13:17:06.652604 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab
[0m13:17:06.653437 [info ] [Thread-1 (]: 4 of 8 START test not_null_stg_shopify__orders_order_id ........................ [RUN]
[0m13:17:06.654789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837, now test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab)
[0m13:17:06.655185 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab
[0m13:17:06.659772 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab"
[0m13:17:06.662120 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab
[0m13:17:06.665715 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab"
[0m13:17:06.667075 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where order_id is null



      
    ) dbt_internal_test
[0m13:17:06.667620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:07.528710 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:9f4ff761-a196-498e-b3ce-8fc996a13168&page=queryresults
[0m13:17:07.909898 [info ] [Thread-1 (]: 4 of 8 PASS not_null_stg_shopify__orders_order_id .............................. [[32mPASS[0m in 1.25s]
[0m13:17:07.911506 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab
[0m13:17:07.912223 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.test_total_discounts_parts
[0m13:17:07.912951 [info ] [Thread-1 (]: 5 of 8 START test test_total_discounts_parts ................................... [RUN]
[0m13:17:07.913648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab, now test.online_shop_dbt.test_total_discounts_parts)
[0m13:17:07.914049 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.test_total_discounts_parts
[0m13:17:07.918934 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.test_total_discounts_parts"
[0m13:17:07.920389 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.test_total_discounts_parts
[0m13:17:07.923079 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.test_total_discounts_parts"
[0m13:17:07.924490 [debug] [Thread-1 (]: On test.online_shop_dbt.test_total_discounts_parts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.test_total_discounts_parts"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    order_id,
    total_discounts,
    shipping_discount,
    line_item_discount
FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`mrt_shopify__orders`
WHERE shipping_discount + line_item_discount != total_discounts
OR total_discounts IS NULL
OR shipping_discount IS NULL
OR line_item_discount IS NULL
      
    ) dbt_internal_test
[0m13:17:07.925498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:08.961642 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:a4442723-57c3-41bf-983c-56ca7822607a&page=queryresults
[0m13:17:09.560935 [info ] [Thread-1 (]: 5 of 8 PASS test_total_discounts_parts ......................................... [[32mPASS[0m in 1.65s]
[0m13:17:09.562537 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.test_total_discounts_parts
[0m13:17:09.563320 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.test_total_line_items_price_subtracting_discounts
[0m13:17:09.563859 [info ] [Thread-1 (]: 6 of 8 START test test_total_line_items_price_subtracting_discounts ............ [RUN]
[0m13:17:09.564296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.test_total_discounts_parts, now test.online_shop_dbt.test_total_line_items_price_subtracting_discounts)
[0m13:17:09.564574 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.test_total_line_items_price_subtracting_discounts
[0m13:17:09.566788 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.test_total_line_items_price_subtracting_discounts"
[0m13:17:09.567613 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.test_total_line_items_price_subtracting_discounts
[0m13:17:09.570639 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.test_total_line_items_price_subtracting_discounts"
[0m13:17:09.571696 [debug] [Thread-1 (]: On test.online_shop_dbt.test_total_line_items_price_subtracting_discounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.test_total_line_items_price_subtracting_discounts"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
    order_id,
    total_line_items_price,
    total_subtotal_price,
    line_item_discount
FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`mrt_shopify__orders`
WHERE total_line_items_price - line_item_discount != total_subtotal_price
      
    ) dbt_internal_test
[0m13:17:09.572305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:10.599883 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:412ac8be-e0c5-409e-9458-1a1f8e66da03&page=queryresults
[0m13:17:11.053401 [error] [Thread-1 (]: 6 of 8 FAIL 4 test_total_line_items_price_subtracting_discounts ................ [[31mFAIL 4[0m in 1.49s]
[0m13:17:11.055174 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.test_total_line_items_price_subtracting_discounts
[0m13:17:11.056065 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.test_total_price
[0m13:17:11.056679 [info ] [Thread-1 (]: 7 of 8 START test test_total_price ............................................. [RUN]
[0m13:17:11.057226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.test_total_line_items_price_subtracting_discounts, now test.online_shop_dbt.test_total_price)
[0m13:17:11.057611 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.test_total_price
[0m13:17:11.064977 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.test_total_price"
[0m13:17:11.066141 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.test_total_price
[0m13:17:11.068968 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.test_total_price"
[0m13:17:11.069709 [debug] [Thread-1 (]: On test.online_shop_dbt.test_total_price: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.test_total_price"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    order_id,
    total_price,
    total_line_items_price,
    total_discounts,
    total_shipping_price,
    total_tax
FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`mrt_shopify__orders`
WHERE (total_line_items_price - total_discounts + total_shipping_price + total_tax) != total_price
      
    ) dbt_internal_test
[0m13:17:11.070092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:12.030929 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:7154e355-20f2-444e-a670-b5e13cfa8456&page=queryresults
[0m13:17:12.406691 [error] [Thread-1 (]: 7 of 8 FAIL 110 test_total_price ............................................... [[31mFAIL 110[0m in 1.35s]
[0m13:17:12.407968 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.test_total_price
[0m13:17:12.408521 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4
[0m13:17:12.409046 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_shopify__orders_order_id .......................... [RUN]
[0m13:17:12.409615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.test_total_price, now test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4)
[0m13:17:12.410064 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4
[0m13:17:12.418614 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4"
[0m13:17:12.419813 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4
[0m13:17:12.422898 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4"
[0m13:17:12.423953 [debug] [Thread-1 (]: On test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:17:12.424534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:13.275715 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:d9787b50-1ab7-4a5a-beb9-61094bd9de2f&page=queryresults
[0m13:17:13.683451 [info ] [Thread-1 (]: 8 of 8 PASS unique_stg_shopify__orders_order_id ................................ [[32mPASS[0m in 1.27s]
[0m13:17:13.684856 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4
[0m13:17:13.686344 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:17:13.689084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:13.689566 [debug] [MainThread]: Connection 'test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4' was properly closed.
[0m13:17:13.690007 [info ] [MainThread]: 
[0m13:17:13.690488 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 11.18 seconds (11.18s).
[0m13:17:13.692268 [debug] [MainThread]: Command end result
[0m13:17:13.723577 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m13:17:13.725162 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m13:17:13.731331 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m13:17:13.731596 [info ] [MainThread]: 
[0m13:17:13.731950 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:17:13.732202 [info ] [MainThread]: 
[0m13:17:13.732494 [error] [MainThread]: [31mFailure in test test_total_line_items_price_subtracting_discounts (online_shop_dbt/tests/test_total_line_items_price_subtracting_discounts.sql)[0m
[0m13:17:13.732828 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m13:17:13.733037 [info ] [MainThread]: 
[0m13:17:13.733283 [info ] [MainThread]:   compiled code at target/compiled/online_shop_dbt/online_shop_dbt/tests/test_total_line_items_price_subtracting_discounts.sql
[0m13:17:13.733491 [info ] [MainThread]: 
[0m13:17:13.733730 [error] [MainThread]: [31mFailure in test test_total_price (online_shop_dbt/tests/test_total_price.sql)[0m
[0m13:17:13.733958 [error] [MainThread]:   Got 110 results, configured to fail if != 0
[0m13:17:13.734138 [info ] [MainThread]: 
[0m13:17:13.734362 [info ] [MainThread]:   compiled code at target/compiled/online_shop_dbt/online_shop_dbt/tests/test_total_price.sql
[0m13:17:13.734556 [info ] [MainThread]: 
[0m13:17:13.734772 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
[0m13:17:13.737324 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 12.181829, "process_in_blocks": "0", "process_kernel_time": 0.274685, "process_mem_max_rss": "213319680", "process_out_blocks": "0", "process_user_time": 2.260244}
[0m13:17:13.737703 [debug] [MainThread]: Command `dbt test` failed at 13:17:13.737636 after 12.18 seconds
[0m13:17:13.737990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f4c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f4bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f4950>]}
[0m13:17:13.738256 [debug] [MainThread]: Flushing usage events
[0m13:17:14.185508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:12.119988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108334c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108334950>]}


============================== 13:20:12.123029 | 09b98ead-449a-4be8-9147-1c2ab7467c89 ==============================
[0m13:20:12.123029 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:20:12.123354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:20:12.771234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09b98ead-449a-4be8-9147-1c2ab7467c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd1e600>]}
[0m13:20:12.806070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09b98ead-449a-4be8-9147-1c2ab7467c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd96870>]}
[0m13:20:12.806416 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:20:12.894953 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m13:20:12.961751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:20:12.962100 [debug] [MainThread]: Partial parsing: updated file: online_shop_dbt://online_shop_dbt/tests/test_total_line_items_price_subtracting_discounts.sql
[0m13:20:12.962290 [debug] [MainThread]: Partial parsing: updated file: online_shop_dbt://online_shop_dbt/tests/test_total_price.sql
[0m13:20:13.104520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09b98ead-449a-4be8-9147-1c2ab7467c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8ed8e0>]}
[0m13:20:13.145243 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m13:20:13.147152 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m13:20:13.166560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09b98ead-449a-4be8-9147-1c2ab7467c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b6480>]}
[0m13:20:13.166840 [info ] [MainThread]: Found 5 models, 8 data tests, 489 macros
[0m13:20:13.167016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09b98ead-449a-4be8-9147-1c2ab7467c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9739b0>]}
[0m13:20:13.167998 [info ] [MainThread]: 
[0m13:20:13.168170 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:20:13.168307 [info ] [MainThread]: 
[0m13:20:13.168534 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:20:13.170447 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh_dbt_transformations_new'
[0m13:20:13.170630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:13.464208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09b98ead-449a-4be8-9147-1c2ab7467c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e315bb0>]}
[0m13:20:13.465557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:13.469747 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7
[0m13:20:13.470186 [info ] [Thread-1 (]: 1 of 8 START test not_null_int_shopify__order_discount__order_id_ .............. [RUN]
[0m13:20:13.470627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7)
[0m13:20:13.470996 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7
[0m13:20:13.491208 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7"
[0m13:20:13.494103 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7
[0m13:20:13.511236 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7"
[0m13:20:13.512103 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select `order_id`
from `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_discount`
where `order_id` is null



      
    ) dbt_internal_test
[0m13:20:13.512443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:14.288819 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:fd911529-fb3f-42eb-ba69-8b258674e51d&page=queryresults
[0m13:20:14.765717 [info ] [Thread-1 (]: 1 of 8 PASS not_null_int_shopify__order_discount__order_id_ .................... [[32mPASS[0m in 1.29s]
[0m13:20:14.766434 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7
[0m13:20:14.766843 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b
[0m13:20:14.767283 [info ] [Thread-1 (]: 2 of 8 START test not_null_int_shopify__order_refund__order_id_ ................ [RUN]
[0m13:20:14.767791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7, now test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b)
[0m13:20:14.768161 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b
[0m13:20:14.772106 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b"
[0m13:20:14.773514 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b
[0m13:20:14.775734 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b"
[0m13:20:14.776490 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select `order_id`
from `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_refund`
where `order_id` is null



      
    ) dbt_internal_test
[0m13:20:14.776877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:15.471336 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:129f1948-7c46-44c6-8d13-2bbf20b370cc&page=queryresults
[0m13:20:16.050769 [info ] [Thread-1 (]: 2 of 8 PASS not_null_int_shopify__order_refund__order_id_ ...................... [[32mPASS[0m in 1.28s]
[0m13:20:16.052113 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b
[0m13:20:16.052749 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837
[0m13:20:16.053202 [info ] [Thread-1 (]: 3 of 8 START test not_null_stg_shopify__orders_customer_id ..................... [RUN]
[0m13:20:16.053739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b, now test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837)
[0m13:20:16.054253 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837
[0m13:20:16.060387 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837"
[0m13:20:16.062136 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837
[0m13:20:16.065136 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837"
[0m13:20:16.065973 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where customer_id is null



      
    ) dbt_internal_test
[0m13:20:16.066375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:16.765146 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:6be5ebc3-57ff-4503-b336-e033a5c92b01&page=queryresults
[0m13:20:17.176953 [info ] [Thread-1 (]: 3 of 8 PASS not_null_stg_shopify__orders_customer_id ........................... [[32mPASS[0m in 1.12s]
[0m13:20:17.178335 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837
[0m13:20:17.179172 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab
[0m13:20:17.180335 [info ] [Thread-1 (]: 4 of 8 START test not_null_stg_shopify__orders_order_id ........................ [RUN]
[0m13:20:17.181306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837, now test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab)
[0m13:20:17.181995 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab
[0m13:20:17.187702 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab"
[0m13:20:17.190333 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab
[0m13:20:17.193667 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab"
[0m13:20:17.194907 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where order_id is null



      
    ) dbt_internal_test
[0m13:20:17.195355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:17.891474 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:1b3e5ccf-26f3-445a-8bd0-c780465cc13e&page=queryresults
[0m13:20:18.295520 [info ] [Thread-1 (]: 4 of 8 PASS not_null_stg_shopify__orders_order_id .............................. [[32mPASS[0m in 1.11s]
[0m13:20:18.297043 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab
[0m13:20:18.297860 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.test_total_discounts_parts
[0m13:20:18.298898 [info ] [Thread-1 (]: 5 of 8 START test test_total_discounts_parts ................................... [RUN]
[0m13:20:18.299504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab, now test.online_shop_dbt.test_total_discounts_parts)
[0m13:20:18.299896 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.test_total_discounts_parts
[0m13:20:18.306672 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.test_total_discounts_parts"
[0m13:20:18.307673 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.test_total_discounts_parts
[0m13:20:18.311720 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.test_total_discounts_parts"
[0m13:20:18.312551 [debug] [Thread-1 (]: On test.online_shop_dbt.test_total_discounts_parts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.test_total_discounts_parts"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    order_id,
    total_discounts,
    shipping_discount,
    line_item_discount
FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`mrt_shopify__orders`
WHERE shipping_discount + line_item_discount != total_discounts
OR total_discounts IS NULL
OR shipping_discount IS NULL
OR line_item_discount IS NULL
      
    ) dbt_internal_test
[0m13:20:18.312957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:19.071558 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:9b3c58b9-6976-4829-8fd2-4e188d29e9c7&page=queryresults
[0m13:20:19.508926 [info ] [Thread-1 (]: 5 of 8 PASS test_total_discounts_parts ......................................... [[32mPASS[0m in 1.21s]
[0m13:20:19.510315 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.test_total_discounts_parts
[0m13:20:19.511000 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.test_total_line_items_price_subtracting_discounts
[0m13:20:19.511964 [info ] [Thread-1 (]: 6 of 8 START test test_total_line_items_price_subtracting_discounts ............ [RUN]
[0m13:20:19.512580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.test_total_discounts_parts, now test.online_shop_dbt.test_total_line_items_price_subtracting_discounts)
[0m13:20:19.512962 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.test_total_line_items_price_subtracting_discounts
[0m13:20:19.516608 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.test_total_line_items_price_subtracting_discounts"
[0m13:20:19.517676 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.test_total_line_items_price_subtracting_discounts
[0m13:20:19.520196 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.test_total_line_items_price_subtracting_discounts"
[0m13:20:19.520948 [debug] [Thread-1 (]: On test.online_shop_dbt.test_total_line_items_price_subtracting_discounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.test_total_line_items_price_subtracting_discounts"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
    order_id,
    total_line_items_price,
    total_subtotal_price,
    line_item_discount
FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`mrt_shopify__orders`
WHERE ROUND((total_line_items_price - line_item_discount), 2) != total_subtotal_price
      
    ) dbt_internal_test
[0m13:20:19.521354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:20.556075 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:ddea3b42-5add-41ca-9f99-c9cc99122ffe&page=queryresults
[0m13:20:20.938596 [info ] [Thread-1 (]: 6 of 8 PASS test_total_line_items_price_subtracting_discounts .................. [[32mPASS[0m in 1.43s]
[0m13:20:20.939925 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.test_total_line_items_price_subtracting_discounts
[0m13:20:20.940582 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.test_total_price
[0m13:20:20.941175 [info ] [Thread-1 (]: 7 of 8 START test test_total_price ............................................. [RUN]
[0m13:20:20.941810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.test_total_line_items_price_subtracting_discounts, now test.online_shop_dbt.test_total_price)
[0m13:20:20.942295 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.test_total_price
[0m13:20:20.947061 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.test_total_price"
[0m13:20:20.947886 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.test_total_price
[0m13:20:20.951636 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.test_total_price"
[0m13:20:20.952606 [debug] [Thread-1 (]: On test.online_shop_dbt.test_total_price: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.test_total_price"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    order_id,
    total_price,
    total_line_items_price,
    total_discounts,
    total_shipping_price,
    total_tax
FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`mrt_shopify__orders`
WHERE ROUND((total_line_items_price - total_discounts + total_shipping_price + total_tax), 2) != total_price
      
    ) dbt_internal_test
[0m13:20:20.953507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:21.988181 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:12eb3d2e-696f-4a8b-b293-cf230c8cf070&page=queryresults
[0m13:20:22.460246 [error] [Thread-1 (]: 7 of 8 FAIL 109 test_total_price ............................................... [[31mFAIL 109[0m in 1.52s]
[0m13:20:22.461945 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.test_total_price
[0m13:20:22.463035 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4
[0m13:20:22.463895 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_shopify__orders_order_id .......................... [RUN]
[0m13:20:22.464882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.test_total_price, now test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4)
[0m13:20:22.465561 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4
[0m13:20:22.473262 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4"
[0m13:20:22.474565 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4
[0m13:20:22.477283 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4"
[0m13:20:22.478246 [debug] [Thread-1 (]: On test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:20:22.478690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:23.011581 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:82b925b3-2ebb-4ddc-a3fe-f40b6181d9f3&page=queryresults
[0m13:20:23.431135 [info ] [Thread-1 (]: 8 of 8 PASS unique_stg_shopify__orders_order_id ................................ [[32mPASS[0m in 0.97s]
[0m13:20:23.432628 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4
[0m13:20:23.434623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:20:23.437920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:23.438469 [debug] [MainThread]: Connection 'test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4' was properly closed.
[0m13:20:23.438988 [info ] [MainThread]: 
[0m13:20:23.439448 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 10.27 seconds (10.27s).
[0m13:20:23.441582 [debug] [MainThread]: Command end result
[0m13:20:23.471697 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m13:20:23.473436 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m13:20:23.479394 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m13:20:23.479669 [info ] [MainThread]: 
[0m13:20:23.479941 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:20:23.480166 [info ] [MainThread]: 
[0m13:20:23.480441 [error] [MainThread]: [31mFailure in test test_total_price (online_shop_dbt/tests/test_total_price.sql)[0m
[0m13:20:23.480685 [error] [MainThread]:   Got 109 results, configured to fail if != 0
[0m13:20:23.480877 [info ] [MainThread]: 
[0m13:20:23.481119 [info ] [MainThread]:   compiled code at target/compiled/online_shop_dbt/online_shop_dbt/tests/test_total_price.sql
[0m13:20:23.481317 [info ] [MainThread]: 
[0m13:20:23.481533 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m13:20:23.484126 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 11.406396, "process_in_blocks": "0", "process_kernel_time": 0.301439, "process_mem_max_rss": "216186880", "process_out_blocks": "0", "process_user_time": 2.350878}
[0m13:20:23.484424 [debug] [MainThread]: Command `dbt test` failed at 13:20:23.484363 after 11.41 seconds
[0m13:20:23.484688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083349e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e442060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107777410>]}
[0m13:20:23.484941 [debug] [MainThread]: Flushing usage events
[0m13:20:23.957334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:48.429586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f413d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f8680>]}


============================== 13:25:48.432784 | d5a496fc-1b9a-4080-ba18-41e77c4896ef ==============================
[0m13:25:48.432784 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:25:48.433116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select mrt_shopify__orders', 'send_anonymous_usage_stats': 'True'}
[0m13:25:49.092344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5a496fc-1b9a-4080-ba18-41e77c4896ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5a7a10>]}
[0m13:25:49.126864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5a496fc-1b9a-4080-ba18-41e77c4896ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e65bf20>]}
[0m13:25:49.127194 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:25:49.214517 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m13:25:49.286101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:25:49.286333 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:25:49.307195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5a496fc-1b9a-4080-ba18-41e77c4896ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccee1e0>]}
[0m13:25:49.391405 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m13:25:49.393440 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m13:25:49.406891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5a496fc-1b9a-4080-ba18-41e77c4896ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6a5eb0>]}
[0m13:25:49.407142 [info ] [MainThread]: Found 5 models, 8 data tests, 489 macros
[0m13:25:49.407307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5a496fc-1b9a-4080-ba18-41e77c4896ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1014c0>]}
[0m13:25:49.408071 [info ] [MainThread]: 
[0m13:25:49.408231 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:25:49.408359 [info ] [MainThread]: 
[0m13:25:49.408581 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:25:49.408983 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh'
[0m13:25:49.409163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:49.884901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh, now list_opensource-marketing-dwh_dbt_transformations_new)
[0m13:25:49.885625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:50.238346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5a496fc-1b9a-4080-ba18-41e77c4896ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6a7b90>]}
[0m13:25:50.239517 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:50.242637 [debug] [Thread-1 (]: Began running node model.online_shop_dbt.mrt_shopify__orders
[0m13:25:50.243267 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_transformations_new.mrt_shopify__orders ........ [RUN]
[0m13:25:50.243712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now model.online_shop_dbt.mrt_shopify__orders)
[0m13:25:50.244056 [debug] [Thread-1 (]: Began compiling node model.online_shop_dbt.mrt_shopify__orders
[0m13:25:50.259916 [debug] [Thread-1 (]: Writing injected SQL for node "model.online_shop_dbt.mrt_shopify__orders"
[0m13:25:50.262906 [debug] [Thread-1 (]: Began executing node model.online_shop_dbt.mrt_shopify__orders
[0m13:25:50.327834 [debug] [Thread-1 (]: Writing runtime sql for node "model.online_shop_dbt.mrt_shopify__orders"
[0m13:25:50.328633 [debug] [Thread-1 (]: On model.online_shop_dbt.mrt_shopify__orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "model.online_shop_dbt.mrt_shopify__orders"} */


  create or replace view `opensource-marketing-dwh`.`dbt_transformations_new`.`mrt_shopify__orders`
  OPTIONS()
  as WITH orders AS (
    SELECT
        order_id,
        customer_id,
        total_discounts,
        total_line_items_price,
        total_price,
        total_shipping_price,
        total_subtotal_price,
        total_tax,

        created_at,
        cancelled_at,
        closed_at,
        processed_at,
        updated_at,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_target_type,
        discount_application_type,
        discount_application_value,
        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_amount,
        discount_code_code,
        discount_code_type,
        landing_site,
        base_url,
        utm_source,
        utm_medium,
        utm_campaign,
        utm_content,
        utm_term,
        fbclid,
        campaign_id,
        order_adjustment_amount,
        order_adjustment_id,
        order_adjustment_uid,
        order_adjustment_kind,
        order_adjustment_reason,
        order_adjustment_refund_id,
        order_adjustment_refund_uid,
        order_adjustment_tax_amount,
        payment_gateway_names,
        presentment_currency,
        referring_site,
        refund_line_item_created_at,
        refund_line_item_order_line_item_id,
        refund_line_item_processed_at,
        refund_line_item_quantity,
        refund_line_item_refund_id,
        refund_line_item_refund_line_item_id,
        refund_line_item_restock,
        refund_line_item_restock_type,
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status,
        shipping_line_discount_allocations_index,
        shipping_line_discount_amount,
        shipping_line_discounted_price,
        shipping_line_id,
        shipping_line_uid,
        shipping_line_price,
        shipping_line_source,
        shipping_line_tax_lines_price,
        shipping_line_tax_lines_rate,
        shipping_line_tax_lines_title,
        shipping_line_title,
        tax_line_price,
        tax_line_rate,
        tax_line_title,
        taxes_included,
        test
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__orders`
),

-- if discount_application_target_type = shipping_line, then the discount is only subtracted from the shipping!
discounts AS (
    SELECT
        order_id,
        discount_application_target_type,
        discount_application_allocation_method,
        discount_application_code,
        discount_application_target_selection,
        discount_application_type,
        discount_application_value,

        discount_application_value_type,
        discount_application_title,
        discount_application_description,
        discount_code_code,
        discount_code_type,
        discount_code_amount,
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_discount`
),

-- should a refunded shipping be subtracted from our net revenue? Does net rev include shipping? 
-- should refunds be added to the (day of the) order or later to the day of the refund?
refunds AS (
    SELECT
        order_id,
        -- refunds
        refund_transactions_id,
        refund_transactions_amount,
        refund_transactions_created_at,
        refund_transactions_kind,
        refund_transactions_status
    FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_refund`
),

joined AS (
    SELECT
        -- orders
        orders.order_id,
        orders.customer_id,
        orders.total_discounts,
        orders.total_line_items_price,
        orders.total_price,
        orders.total_shipping_price,
        orders.total_subtotal_price,
        orders.total_tax,
        orders.taxes_included,
        orders.created_at,
        orders.cancelled_at,
        orders.closed_at,
        orders.processed_at,
        orders.updated_at,
        -- discounts
        discounts.discount_code_code,
        -- there are different kinds of discounts. Shipping discounts are only subtracted from shipping!
        CASE WHEN discounts.discount_application_target_type = 'shipping_line' THEN discounts.discount_code_amount ELSE 0 END AS shipping_discount,
        CASE WHEN discounts.discount_application_target_type = 'line_item' THEN discounts.discount_code_amount ELSE 0 END AS line_item_discount
    FROM orders
    LEFT JOIN discounts
    ON orders.order_id = discounts.order_id
)


-- coalesce joined columns
-- create cte for business logic

-- Klar Definition: Net Revenue = Gross Revenue - Taxes - Refund Value

-- calculating net_revenue:
--                  total_line_items_price
--                  - total_discounts (careful! This is only valid for discount_application_target_type != shipping_line. See order_id = 6064341483866 for an example.)
--                  ----------------
--                  = total_subtotal_price 
--                      + total_shipping_price
                        -----------------                    
--                          - returns/refunds
--                          -----------------
--                          = net_revenue

-- total_price is what the customer pays
-- total_price = total_line_items_price - total_discounts + total_shipping_price + total_tax
SELECT * FROM joined;


[0m13:25:50.328997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:51.105712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:6c209328-e7d7-4f56-b42e-b99b7d3f85f0&page=queryresults
[0m13:25:51.390627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5a496fc-1b9a-4080-ba18-41e77c4896ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4d5d90>]}
[0m13:25:51.391139 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_transformations_new.mrt_shopify__orders ... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m13:25:51.391555 [debug] [Thread-1 (]: Finished running node model.online_shop_dbt.mrt_shopify__orders
[0m13:25:51.392307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:51.393549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:51.393772 [debug] [MainThread]: Connection 'model.online_shop_dbt.mrt_shopify__orders' was properly closed.
[0m13:25:51.393966 [info ] [MainThread]: 
[0m13:25:51.394146 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m13:25:51.394521 [debug] [MainThread]: Command end result
[0m13:25:51.411744 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m13:25:51.412731 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m13:25:51.416044 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m13:25:51.416241 [info ] [MainThread]: 
[0m13:25:51.416470 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:51.416625 [info ] [MainThread]: 
[0m13:25:51.416784 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:25:51.418678 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0311863, "process_in_blocks": "0", "process_kernel_time": 0.257858, "process_mem_max_rss": "209797120", "process_out_blocks": "0", "process_user_time": 1.626075}
[0m13:25:51.418939 [debug] [MainThread]: Command `dbt run` succeeded at 13:25:51.418888 after 3.03 seconds
[0m13:25:51.419143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eac3fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2b7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107936870>]}
[0m13:25:51.419343 [debug] [MainThread]: Flushing usage events
[0m13:25:51.893063 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:26.980753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7c8740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaf8a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaf87a0>]}


============================== 13:29:26.983905 | e8032128-118e-4a77-8937-6c47e5fe1b89 ==============================
[0m13:29:26.983905 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:29:26.984234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/friedrichtenhagen/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:29:27.641291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8032128-118e-4a77-8937-6c47e5fe1b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fcb66f0>]}
[0m13:29:27.675543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8032128-118e-4a77-8937-6c47e5fe1b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f3d1df0>]}
[0m13:29:27.675873 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:29:27.762739 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m13:29:27.831400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:29:27.831760 [debug] [MainThread]: Partial parsing: updated file: online_shop_dbt://online_shop_dbt/tests/test_total_price.sql
[0m13:29:27.965297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8032128-118e-4a77-8937-6c47e5fe1b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fafd8e0>]}
[0m13:29:28.006549 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m13:29:28.008694 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m13:29:28.029329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8032128-118e-4a77-8937-6c47e5fe1b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc8a4e0>]}
[0m13:29:28.029609 [info ] [MainThread]: Found 5 models, 8 data tests, 489 macros
[0m13:29:28.029783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8032128-118e-4a77-8937-6c47e5fe1b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe4ef00>]}
[0m13:29:28.030757 [info ] [MainThread]: 
[0m13:29:28.030920 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:29:28.031053 [info ] [MainThread]: 
[0m13:29:28.031280 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:29:28.033184 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_opensource-marketing-dwh_dbt_transformations_new'
[0m13:29:28.033367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:28.322995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8032128-118e-4a77-8937-6c47e5fe1b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe18ad0>]}
[0m13:29:28.323453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:28.325496 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7
[0m13:29:28.325811 [info ] [Thread-1 (]: 1 of 8 START test not_null_int_shopify__order_discount__order_id_ .............. [RUN]
[0m13:29:28.326118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_opensource-marketing-dwh_dbt_transformations_new, now test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7)
[0m13:29:28.326352 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7
[0m13:29:28.338544 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7"
[0m13:29:28.340191 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7
[0m13:29:28.351614 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7"
[0m13:29:28.352137 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select `order_id`
from `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_discount`
where `order_id` is null



      
    ) dbt_internal_test
[0m13:29:28.352383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:29.117559 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:a116a90e-ef2f-44d5-a27d-ecb80bb98032&page=queryresults
[0m13:29:29.557535 [info ] [Thread-1 (]: 1 of 8 PASS not_null_int_shopify__order_discount__order_id_ .................... [[32mPASS[0m in 1.23s]
[0m13:29:29.558076 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7
[0m13:29:29.558388 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b
[0m13:29:29.558752 [info ] [Thread-1 (]: 2 of 8 START test not_null_int_shopify__order_refund__order_id_ ................ [RUN]
[0m13:29:29.559150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_int_shopify__order_discount__order_id_.79a9d2fcc7, now test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b)
[0m13:29:29.559445 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b
[0m13:29:29.563209 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b"
[0m13:29:29.563746 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b
[0m13:29:29.565724 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b"
[0m13:29:29.566421 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select `order_id`
from `opensource-marketing-dwh`.`dbt_transformations_new`.`int_shopify__order_refund`
where `order_id` is null



      
    ) dbt_internal_test
[0m13:29:29.566750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:30.346365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:94269137-75c4-4221-8547-fea52be41dc2&page=queryresults
[0m13:29:30.740024 [info ] [Thread-1 (]: 2 of 8 PASS not_null_int_shopify__order_refund__order_id_ ...................... [[32mPASS[0m in 1.18s]
[0m13:29:30.741809 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b
[0m13:29:30.742541 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837
[0m13:29:30.743355 [info ] [Thread-1 (]: 3 of 8 START test not_null_stg_shopify__orders_customer_id ..................... [RUN]
[0m13:29:30.744185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_int_shopify__order_refund__order_id_.09c5f8044b, now test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837)
[0m13:29:30.744617 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837
[0m13:29:30.751315 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837"
[0m13:29:30.753515 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837
[0m13:29:30.756718 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837"
[0m13:29:30.757530 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where customer_id is null



      
    ) dbt_internal_test
[0m13:29:30.757954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:31.472920 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:207c7661-781a-456c-b786-6c6affcc4486&page=queryresults
[0m13:29:31.882955 [info ] [Thread-1 (]: 3 of 8 PASS not_null_stg_shopify__orders_customer_id ........................... [[32mPASS[0m in 1.14s]
[0m13:29:31.884909 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837
[0m13:29:31.885636 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab
[0m13:29:31.886419 [info ] [Thread-1 (]: 4 of 8 START test not_null_stg_shopify__orders_order_id ........................ [RUN]
[0m13:29:31.887156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_customer_id.672ff7c837, now test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab)
[0m13:29:31.887559 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab
[0m13:29:31.893347 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab"
[0m13:29:31.894076 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab
[0m13:29:31.897527 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab"
[0m13:29:31.898610 [debug] [Thread-1 (]: On test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
where order_id is null



      
    ) dbt_internal_test
[0m13:29:31.899075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:32.701215 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:e58fb601-ac67-4a3b-8872-9482130e363a&page=queryresults
[0m13:29:33.043668 [info ] [Thread-1 (]: 4 of 8 PASS not_null_stg_shopify__orders_order_id .............................. [[32mPASS[0m in 1.16s]
[0m13:29:33.044991 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab
[0m13:29:33.045682 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.test_total_discounts_parts
[0m13:29:33.046229 [info ] [Thread-1 (]: 5 of 8 START test test_total_discounts_parts ................................... [RUN]
[0m13:29:33.046795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.not_null_stg_shopify__orders_order_id.3b0e715aab, now test.online_shop_dbt.test_total_discounts_parts)
[0m13:29:33.047274 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.test_total_discounts_parts
[0m13:29:33.054047 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.test_total_discounts_parts"
[0m13:29:33.054985 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.test_total_discounts_parts
[0m13:29:33.058005 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.test_total_discounts_parts"
[0m13:29:33.058880 [debug] [Thread-1 (]: On test.online_shop_dbt.test_total_discounts_parts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.test_total_discounts_parts"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    order_id,
    total_discounts,
    shipping_discount,
    line_item_discount
FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`mrt_shopify__orders`
WHERE shipping_discount + line_item_discount != total_discounts
OR total_discounts IS NULL
OR shipping_discount IS NULL
OR line_item_discount IS NULL
      
    ) dbt_internal_test
[0m13:29:33.059306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:34.135318 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:ab7c26f5-7fcd-4e05-904d-6cbf8ff6297e&page=queryresults
[0m13:29:34.558315 [info ] [Thread-1 (]: 5 of 8 PASS test_total_discounts_parts ......................................... [[32mPASS[0m in 1.51s]
[0m13:29:34.559463 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.test_total_discounts_parts
[0m13:29:34.560400 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.test_total_line_items_price_subtracting_discounts
[0m13:29:34.561023 [info ] [Thread-1 (]: 6 of 8 START test test_total_line_items_price_subtracting_discounts ............ [RUN]
[0m13:29:34.561727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.test_total_discounts_parts, now test.online_shop_dbt.test_total_line_items_price_subtracting_discounts)
[0m13:29:34.562280 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.test_total_line_items_price_subtracting_discounts
[0m13:29:34.566798 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.test_total_line_items_price_subtracting_discounts"
[0m13:29:34.568387 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.test_total_line_items_price_subtracting_discounts
[0m13:29:34.572962 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.test_total_line_items_price_subtracting_discounts"
[0m13:29:34.574770 [debug] [Thread-1 (]: On test.online_shop_dbt.test_total_line_items_price_subtracting_discounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.test_total_line_items_price_subtracting_discounts"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
    order_id,
    total_line_items_price,
    total_subtotal_price,
    line_item_discount
FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`mrt_shopify__orders`
WHERE ROUND((total_line_items_price - line_item_discount), 2) != total_subtotal_price
      
    ) dbt_internal_test
[0m13:29:34.575184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:35.669223 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:961695ca-49f6-4404-9997-d06c0602bcca&page=queryresults
[0m13:29:36.024275 [info ] [Thread-1 (]: 6 of 8 PASS test_total_line_items_price_subtracting_discounts .................. [[32mPASS[0m in 1.46s]
[0m13:29:36.025701 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.test_total_line_items_price_subtracting_discounts
[0m13:29:36.026451 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.test_total_price
[0m13:29:36.027063 [info ] [Thread-1 (]: 7 of 8 START test test_total_price ............................................. [RUN]
[0m13:29:36.027820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.test_total_line_items_price_subtracting_discounts, now test.online_shop_dbt.test_total_price)
[0m13:29:36.028385 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.test_total_price
[0m13:29:36.031989 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.test_total_price"
[0m13:29:36.032821 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.test_total_price
[0m13:29:36.035972 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.test_total_price"
[0m13:29:36.037004 [debug] [Thread-1 (]: On test.online_shop_dbt.test_total_price: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.test_total_price"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    order_id,
    total_price,
    total_line_items_price,
    total_discounts,
    total_shipping_price,
    total_tax,
    taxes_included
FROM `opensource-marketing-dwh`.`dbt_transformations_new`.`mrt_shopify__orders`
WHERE ROUND(
    (total_line_items_price - total_discounts + total_shipping_price + 
        (CASE WHEN taxes_included IS TRUE THEN 0 ELSE total_tax END) -- exclude the taxes if they are already included
    )
    , 2) 
    != total_price
      
    ) dbt_internal_test
[0m13:29:36.037420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:37.002481 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:d5f23cf8-4f7e-48c5-b929-a0b356dea7bf&page=queryresults
[0m13:29:37.407591 [info ] [Thread-1 (]: 7 of 8 PASS test_total_price ................................................... [[32mPASS[0m in 1.38s]
[0m13:29:37.409224 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.test_total_price
[0m13:29:37.410000 [debug] [Thread-1 (]: Began running node test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4
[0m13:29:37.411183 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_shopify__orders_order_id .......................... [RUN]
[0m13:29:37.412105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.online_shop_dbt.test_total_price, now test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4)
[0m13:29:37.412590 [debug] [Thread-1 (]: Began compiling node test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4
[0m13:29:37.421325 [debug] [Thread-1 (]: Writing injected SQL for node "test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4"
[0m13:29:37.423406 [debug] [Thread-1 (]: Began executing node test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4
[0m13:29:37.426026 [debug] [Thread-1 (]: Writing runtime sql for node "test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4"
[0m13:29:37.427071 [debug] [Thread-1 (]: On test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "online_shop_dbt", "target_name": "dev", "node_id": "test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `opensource-marketing-dwh`.`dbt_transformations_new`.`stg_shopify__orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:29:37.427498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:38.025900 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=opensource-marketing-dwh&j=bq:europe-west1:2fb1e189-dd20-49f9-b0ab-bcef8949661e&page=queryresults
[0m13:29:38.394070 [info ] [Thread-1 (]: 8 of 8 PASS unique_stg_shopify__orders_order_id ................................ [[32mPASS[0m in 0.98s]
[0m13:29:38.394579 [debug] [Thread-1 (]: Finished running node test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4
[0m13:29:38.395353 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:29:38.396956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:38.397401 [debug] [MainThread]: Connection 'test.online_shop_dbt.unique_stg_shopify__orders_order_id.353c2372b4' was properly closed.
[0m13:29:38.397835 [info ] [MainThread]: 
[0m13:29:38.398272 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 10.37 seconds (10.37s).
[0m13:29:38.399979 [debug] [MainThread]: Command end result
[0m13:29:38.429242 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/manifest.json
[0m13:29:38.430877 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/semantic_manifest.json
[0m13:29:38.436357 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/friedrichtenhagen/coding/online_shop_efficiency_analysis/transformation/target/run_results.json
[0m13:29:38.436622 [info ] [MainThread]: 
[0m13:29:38.436895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:38.437107 [info ] [MainThread]: 
[0m13:29:38.437341 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m13:29:38.439573 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.502979, "process_in_blocks": "0", "process_kernel_time": 0.297597, "process_mem_max_rss": "214401024", "process_out_blocks": "0", "process_user_time": 2.271488}
[0m13:29:38.439857 [debug] [MainThread]: Command `dbt test` succeeded at 13:29:38.439802 after 11.50 seconds
[0m13:29:38.440101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaf8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f2e94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fcdbb00>]}
[0m13:29:38.440328 [debug] [MainThread]: Flushing usage events
[0m13:29:38.900642 [debug] [MainThread]: An error was encountered while trying to flush usage events
